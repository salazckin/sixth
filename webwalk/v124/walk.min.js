/*


  Shapespark 3D visualization viewer

  Copyright (C) 2014-2018 Shapespark

  The viewer uses the following open source libraries:

    Three.js: https://github.com/mrdoob/three.js,
    Copyright 2010-2015 three.js authors, MIT License

    PlayCanvas (GLSL shaders code): https://github.com/playcanvas/engine
    Copyright (C) 2011-2015 PlayCanvas Ltd., MIT License

    WebVR Polyfill: https://github.com/googlevr/webvr-polyfill,
    Copyright (C) 2015 Google Inc, Apache 2.0 License

  and the following open fonts:

    Noto Sans: https://fonts.google.com/specimen/Noto+Sans?query=noto+sans
    Copyright (C) Google Inc., Apache 2.0 License
*/
var THREE={REVISION:"71"};"object"===typeof module&&(module.exports=THREE);void 0===Math.sign&&(Math.sign=function(a){return 0>a?-1:0<a?1:+a});THREE.log=function(){console.log.apply(console,arguments)};THREE.warn=function(){console.warn.apply(console,arguments)};THREE.error=function(){console.error.apply(console,arguments)};THREE.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2};THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;
THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;
THREE.MinEquation=103;THREE.MaxEquation=104;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=300;THREE.CubeReflectionMapping=301;THREE.CubeRefractionMapping=302;
THREE.EquirectangularReflectionMapping=303;THREE.EquirectangularRefractionMapping=304;THREE.SphericalReflectionMapping=305;THREE.RepeatWrapping=1E3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;
THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.HalfFloatType=1025;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGBEFormat=THREE.RGBAFormat;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;
THREE.RGBA_S3TC_DXT5_Format=2004;THREE.RGB_PVRTC_4BPPV1_Format=2100;THREE.RGB_PVRTC_2BPPV1_Format=2101;THREE.RGBA_PVRTC_4BPPV1_Format=2102;THREE.RGBA_PVRTC_2BPPV1_Format=2103;THREE.RGB_ETC1_Format=2151;THREE.Color=function(a){return 3===arguments.length?this.setRGB(arguments[0],arguments[1],arguments[2]):this.set(a)};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){a instanceof THREE.Color?this.copy(a):"number"===typeof a?this.setHex(a):"string"===typeof a&&this.setStyle(a);return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(a,b,c){this.r=a;this.g=b;this.b=c;return this},setHSL:function(a,b,c){if(0===b)this.r=this.g=this.b=c;else{var d=function(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:
.5>c?b:c<2/3?a+6*(b-a)*(2/3-c):a};b=.5>=c?c*(1+b):c+b-c*b;c=2*c-b;this.r=d(c,b,a+1/3);this.g=d(c,b,a);this.b=d(c,b,a-1/3)}return this},setStyle:function(a){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(a))return a=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(a),this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,this;if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(a))return a=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(a),this.r=
Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(a))return a=/^\#([0-9a-f]{6})$/i.exec(a),this.setHex(parseInt(a[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a))return a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),this.setHex(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16)),this;if(/^(\w+)$/i.test(a))return this.setHex(THREE.ColorKeywords[a]),this},copy:function(a){this.r=a.r;this.g=
a.g;this.b=a.b;return this},copyGammaToLinear:function(a,b){void 0===b&&(b=2);this.r=Math.pow(a.r,b);this.g=Math.pow(a.g,b);this.b=Math.pow(a.b,b);return this},copyLinearToGamma:function(a,b){void 0===b&&(b=2);var c=0<b?1/b:1;this.r=Math.pow(a.r,c);this.g=Math.pow(a.g,c);this.b=Math.pow(a.b,c);return this},convertGammaToLinear:function(){var a=this.r,b=this.g,c=this.b;this.r=a*a;this.g=b*b;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=
Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(a){a=a||{h:0,s:0,l:0};var b=this.r,c=this.g,d=this.b,e=Math.max(b,c,d),f=Math.min(b,c,d),g,h=(f+e)/2;if(f===e)f=g=0;else{var k=e-f,f=.5>=h?k/(e+f):k/(2-e-f);switch(e){case b:g=(c-d)/k+(c<d?6:0);break;case c:g=(d-b)/k+2;break;case d:g=(b-c)/k+4}g/=6}a.h=g;a.s=f;a.l=h;return a},getStyle:function(){return"rgb("+
(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(a,b,c){var d=this.getHSL();d.h+=a;d.s+=b;d.l+=c;this.setHSL(d.h,d.s,d.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(a,b){this.r=a.r+b.r;this.g=a.g+b.g;this.b=a.b+b.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;
return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},equals:function(a){return a.r===this.r&&a.g===this.g&&a.b===this.b},fromArray:function(a){this.r=a[0];this.g=a[1];this.b=a[2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.r;a[b+1]=this.g;a[b+2]=this.b;return a},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};
THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._w=void 0!==d?d:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get w(){return this._w},set w(a){this._w=a;this.onChangeCallback()},set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._w=d;this.onChangeCallback();return this},copy:function(a){this._x=a.x;this._y=a.y;this._z=a.z;
this._w=a.w;this.onChangeCallback();return this},setFromEuler:function(a,b){if(!1===a instanceof THREE.Euler)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var c=Math.cos(a._x/2),d=Math.cos(a._y/2),e=Math.cos(a._z/2),f=Math.sin(a._x/2),g=Math.sin(a._y/2),h=Math.sin(a._z/2);"XYZ"===a.order?(this._x=f*d*e+c*g*h,this._y=c*g*e-f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e-f*g*h):"YXZ"===a.order?(this._x=f*d*e+c*g*h,this._y=c*g*e-f*d*h,this._z=
c*d*h-f*g*e,this._w=c*d*e+f*g*h):"ZXY"===a.order?(this._x=f*d*e-c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e-f*g*h):"ZYX"===a.order?(this._x=f*d*e-c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h-f*g*e,this._w=c*d*e+f*g*h):"YZX"===a.order?(this._x=f*d*e+c*g*h,this._y=c*g*e+f*d*h,this._z=c*d*h-f*g*e,this._w=c*d*e-f*g*h):"XZY"===a.order&&(this._x=f*d*e-c*g*h,this._y=c*g*e-f*d*h,this._z=c*d*h+f*g*e,this._w=c*d*e+f*g*h);if(!1!==b)this.onChangeCallback();return this},setFromAxisAngle:function(a,
b){var c=b/2,d=Math.sin(c);this._x=a.x*d;this._y=a.y*d;this._z=a.z*d;this._w=Math.cos(c);this.onChangeCallback();return this},setFromRotationMatrix:function(a){var b=a.elements,c=b[0];a=b[4];var d=b[8],e=b[1],f=b[5],g=b[9],h=b[2],k=b[6],b=b[10],m=c+f+b;0<m?(c=.5/Math.sqrt(m+1),this._w=.25/c,this._x=(k-g)*c,this._y=(d-h)*c,this._z=(e-a)*c):c>f&&c>b?(c=2*Math.sqrt(1+c-f-b),this._w=(k-g)/c,this._x=.25*c,this._y=(a+e)/c,this._z=(d+h)/c):f>b?(c=2*Math.sqrt(1+f-c-b),this._w=(d-h)/c,this._x=(a+e)/c,this._y=
.25*c,this._z=(g+k)/c):(c=2*Math.sqrt(1+b-c-f),this._w=(e-a)/c,this._x=(d+h)/c,this._y=(g+k)/c,this._z=.25*c);this.onChangeCallback();return this},setFromUnitVectors:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector3);b=c.dot(d)+1;1E-6>b?(b=0,Math.abs(c.x)>Math.abs(c.z)?a.set(-c.y,c.x,0):a.set(0,-c.z,c.y)):a.crossVectors(c,d);this._x=a.x;this._y=a.y;this._z=a.z;this._w=b;this.normalize();return this}}(),inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=
-1;this._y*=-1;this._z*=-1;this.onChangeCallback();return this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();0===a?(this._z=this._y=this._x=0,this._w=1):(a=1/a,this._x*=a,this._y*=a,this._z*=a,this._w*=a);this.onChangeCallback();return this},
multiply:function(a,b){return void 0!==b?(THREE.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(a,b)):this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,k=b._z,m=b._w;this._x=c*m+f*g+d*k-e*h;this._y=d*m+f*h+e*g-c*k;this._z=e*m+f*k+c*h-d*g;this._w=f*m-c*g-d*h-e*k;this.onChangeCallback();return this},multiplyVector3:function(a){THREE.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");
return a.applyQuaternion(this)},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a);if(1<=g)return this._w=f,this._x=c,this._y=d,this._z=e,this;var h=Math.acos(g),k=Math.sqrt(1-g*g);if(.001>Math.abs(k))return this._w=.5*(f+this._w),this._x=.5*(c+this._x),this._y=.5*(d+this._y),this._z=.5*(e+this._z),this;g=Math.sin((1-b)*h)/k;h=
Math.sin(b*h)/k;this._w=f*g+this._w*h;this._x=c*g+this._x*h;this._y=d*g+this._y*h;this._z=e*g+this._z*h;this.onChangeCallback();return this},equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w},fromArray:function(a,b){void 0===b&&(b=0);this._x=a[b];this._y=a[b+1];this._z=a[b+2];this._w=a[b+3];this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._w;return a},onChange:function(a){this.onChangeCallback=
a;return this},onChangeCallback:function(){},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}};THREE.Quaternion.slerp=function(a,b,c,d){return c.copy(a).slerp(b,d)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,
b){if(void 0!==b)return THREE.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},sub:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;return this},
subScalar:function(a){this.x-=a;this.y-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divide:function(a){this.x/=a.x;this.y/=a.y;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);
this.y<a.y&&(this.y=a.y);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector2,b=new THREE.Vector2);a.set(c,c);b.set(d,d);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this},round:function(){this.x=
Math.round(this.x);this.y=Math.round(this.y);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);return this},negate:function(){this.x=-this.x;this.y=-this.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},
distanceToSquared:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},lerpVectors:function(a,b,c){this.subVectors(b,a).multiplyScalar(c).add(a);return this},equals:function(a){return a.x===this.x&&a.y===this.y},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];return this},toArray:function(a,b){void 0===
a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;return a},fromAttribute:function(a,b,c){void 0===c&&(c=0);b=b*a.itemSize+c;this.x=a.array[b];this.y=a.array[b+1];return this},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(a,b);this.x*=a.x;this.y*=a.y;this.z*=a.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=
a;return this},multiplyVectors:function(a,b){this.x=a.x*b.x;this.y=a.y*b.y;this.z=a.z*b.z;return this},applyEuler:function(){var a;return function(b){!1===b instanceof THREE.Euler&&THREE.error("THREE.Vector3: .applyEuler() now expects a Euler rotation rather than a Vector3 and order.");void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromEuler(b));return this}}(),applyAxisAngle:function(){var a;return function(b,c){void 0===a&&(a=new THREE.Quaternion);this.applyQuaternion(a.setFromAxisAngle(b,
c));return this}}(),applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[3]*c+a[6]*d;this.y=a[1]*b+a[4]*c+a[7]*d;this.z=a[2]*b+a[5]*c+a[8]*d;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12];this.y=a[1]*b+a[5]*c+a[9]*d+a[13];this.z=a[2]*b+a[6]*c+a[10]*d+a[14];return this},applyProjection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;var e=1/(a[3]*b+a[7]*c+a[11]*d+a[15]);this.x=(a[0]*b+a[4]*
c+a[8]*d+a[12])*e;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])*e;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])*e;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z;a=a.w;var h=a*b+f*d-g*c,k=a*c+g*b-e*d,m=a*d+e*c-f*b,b=-e*b-f*c-g*d;this.x=h*a+b*-e+k*-g-m*-f;this.y=k*a+b*-f+m*-e-h*-g;this.z=m*a+b*-g+h*-f-k*-e;return this},project:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.multiplyMatrices(b.projectionMatrix,a.getInverse(b.matrixWorld));return this.applyProjection(a)}}(),
unproject:function(){var a;return function(b){void 0===a&&(a=new THREE.Matrix4);a.multiplyMatrices(b.matrixWorld,a.getInverse(b.projectionMatrix));return this.applyProjection(a)}}(),transformDirection:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d;this.y=a[1]*b+a[5]*c+a[9]*d;this.z=a[2]*b+a[6]*c+a[10]*d;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=
a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector3,
b=new THREE.Vector3);a.set(c,c,c);b.set(d,d,d);return this.clamp(a,b)}}(),floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):
Math.floor(this.y);this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},
setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},lerpVectors:function(a,b,c){this.subVectors(b,a).multiplyScalar(c).add(a);return this},cross:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(a,b);var c=this.x,d=this.y,e=this.z;this.x=d*a.z-e*a.y;this.y=
e*a.x-c*a.z;this.z=c*a.y-d*a.x;return this},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;this.x=d*h-e*g;this.y=e*f-c*h;this.z=c*g-d*f;return this},projectOnVector:function(){var a,b;return function(c){void 0===a&&(a=new THREE.Vector3);a.copy(c).normalize();b=this.dot(a);return this.copy(a).multiplyScalar(b)}}(),projectOnPlane:function(){var a;return function(b){void 0===a&&(a=new THREE.Vector3);a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a;return function(b){void 0===
a&&(a=new THREE.Vector3);return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),angleTo:function(a){a=this.dot(a)/(this.length()*a.length());return Math.acos(THREE.Math.clamp(a,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},setEulerFromRotationMatrix:function(a,b){THREE.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},
setEulerFromQuaternion:function(a,b){THREE.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(a){THREE.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition().");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){THREE.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale().");return this.setFromMatrixScale(a)},getColumnFromMatrix:function(a,
b){THREE.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn().");return this.setFromMatrixColumn(a,b)},setFromMatrixPosition:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setFromMatrixScale:function(a){var b=this.set(a.elements[0],a.elements[1],a.elements[2]).length(),c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();a=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=b;this.y=c;this.z=a;
return this},setFromMatrixColumn:function(a,b){var c=4*a,d=b.elements;this.x=d[c];this.y=d[c+1];this.z=d[c+2];return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;return a},fromAttribute:function(a,b,c){void 0===c&&(c=0);b=b*a.itemSize+c;this.x=a.array[b];this.y=a.array[b+1];this.z=
a.array[b+2];return this},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};THREE.Vector4=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a);}},getComponent:function(a){switch(a){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a);}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=void 0!==a.w?a.w:1;return this},add:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.w+=a.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(a,
b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.w=a.w+b.w;return this},sub:function(a,b){if(void 0!==b)return THREE.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.w-=a.w;return this},subScalar:function(a){this.x-=a;this.y-=a;this.z-=a;this.w-=a;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.w=a.w-b.w;return this},multiplyScalar:function(a){this.x*=
a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12]*e;this.y=a[1]*b+a[5]*c+a[9]*d+a[13]*e;this.z=a[2]*b+a[6]*c+a[10]*d+a[14]*e;this.w=a[3]*b+a[7]*c+a[11]*d+a[15]*e;return this},divideScalar:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);1E-4>
b?(this.x=1,this.z=this.y=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b);return this},setAxisAngleFromRotationMatrix:function(a){var b,c,d;a=a.elements;var e=a[0];d=a[4];var f=a[8],g=a[1],h=a[5],k=a[9];c=a[2];b=a[6];var m=a[10];if(.01>Math.abs(d-g)&&.01>Math.abs(f-c)&&.01>Math.abs(k-b)){if(.1>Math.abs(d+g)&&.1>Math.abs(f+c)&&.1>Math.abs(k+b)&&.1>Math.abs(e+h+m-3))return this.set(1,0,0,0),this;a=Math.PI;e=(e+1)/2;h=(h+1)/2;m=(m+1)/2;d=(d+g)/4;f=(f+c)/4;k=(k+b)/4;e>h&&e>m?.01>e?(b=0,d=c=.707106781):(b=
Math.sqrt(e),c=d/b,d=f/b):h>m?.01>h?(b=.707106781,c=0,d=.707106781):(c=Math.sqrt(h),b=d/c,d=k/c):.01>m?(c=b=.707106781,d=0):(d=Math.sqrt(m),b=f/d,c=k/d);this.set(b,c,d,a);return this}a=Math.sqrt((b-k)*(b-k)+(f-c)*(f-c)+(g-d)*(g-d));.001>Math.abs(a)&&(a=1);this.x=(b-k)/a;this.y=(f-c)/a;this.z=(g-d)/a;this.w=Math.acos((e+h+m-1)/2);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.w>a.w&&(this.w=a.w);return this},max:function(a){this.x<a.x&&
(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);this.w<a.w&&(this.w=a.w);return this},clamp:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.w<a.w?this.w=a.w:this.w>b.w&&(this.w=b.w);return this},clampScalar:function(){var a,b;return function(c,d){void 0===a&&(a=new THREE.Vector4,b=new THREE.Vector4);a.set(c,c,c,c);b.set(d,d,d,d);return this.clamp(a,b)}}(),floor:function(){this.x=
Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.w=Math.floor(this.w);return this},ceil:function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);this.z=Math.ceil(this.z);this.w=Math.ceil(this.w);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.w=Math.round(this.w);return this},roundToZero:function(){this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x);this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y);
this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z);this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w);return this},negate:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.w=-this.w;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+
Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();0!==b&&a!==b&&this.multiplyScalar(a/b);return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},lerpVectors:function(a,b,c){this.subVectors(b,a).multiplyScalar(c).add(a);return this},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},
fromArray:function(a,b){void 0===b&&(b=0);this.x=a[b];this.y=a[b+1];this.z=a[b+2];this.w=a[b+3];return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this.x;a[b+1]=this.y;a[b+2]=this.z;a[b+3]=this.w;return a},fromAttribute:function(a,b,c){void 0===c&&(c=0);b=b*a.itemSize+c;this.x=a.array[b];this.y=a.array[b+1];this.z=a.array[b+2];this.w=a.array[b+3];return this},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};
THREE.Euler=function(a,b,c,d){this._x=a||0;this._y=b||0;this._z=c||0;this._order=d||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" ");THREE.Euler.DefaultOrder="XYZ";
THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,get x(){return this._x},set x(a){this._x=a;this.onChangeCallback()},get y(){return this._y},set y(a){this._y=a;this.onChangeCallback()},get z(){return this._z},set z(a){this._z=a;this.onChangeCallback()},get order(){return this._order},set order(a){this._order=a;this.onChangeCallback()},set:function(a,b,c,d){this._x=a;this._y=b;this._z=c;this._order=d||this._order;this.onChangeCallback();return this},copy:function(a){this._x=
a._x;this._y=a._y;this._z=a._z;this._order=a._order;this.onChangeCallback();return this},setFromRotationMatrix:function(a,b,c){var d=THREE.Math.clamp,e=a.elements;a=e[0];var f=e[4],g=e[8],h=e[1],k=e[5],m=e[9],l=e[2],n=e[6],e=e[10];b=b||this._order;"XYZ"===b?(this._y=Math.asin(d(g,-1,1)),.99999>Math.abs(g)?(this._x=Math.atan2(-m,e),this._z=Math.atan2(-f,a)):(this._x=Math.atan2(n,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-d(m,-1,1)),.99999>Math.abs(m)?(this._y=Math.atan2(g,e),this._z=Math.atan2(h,
k)):(this._y=Math.atan2(-l,a),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(n,-1,1)),.99999>Math.abs(n)?(this._y=Math.atan2(-l,e),this._z=Math.atan2(-f,k)):(this._y=0,this._z=Math.atan2(h,a))):"ZYX"===b?(this._y=Math.asin(-d(l,-1,1)),.99999>Math.abs(l)?(this._x=Math.atan2(n,e),this._z=Math.atan2(h,a)):(this._x=0,this._z=Math.atan2(-f,k))):"YZX"===b?(this._z=Math.asin(d(h,-1,1)),.99999>Math.abs(h)?(this._x=Math.atan2(-m,k),this._y=Math.atan2(-l,a)):(this._x=0,this._y=Math.atan2(g,e))):"XZY"===b?(this._z=
Math.asin(-d(f,-1,1)),.99999>Math.abs(f)?(this._x=Math.atan2(n,k),this._y=Math.atan2(g,a)):(this._x=Math.atan2(-m,e),this._y=0)):THREE.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this._order=b;if(!1!==c)this.onChangeCallback();return this},setFromQuaternion:function(){var a;return function(b,c,d){void 0===a&&(a=new THREE.Matrix4);a.makeRotationFromQuaternion(b);this.setFromRotationMatrix(a,c,d);return this}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,
b||this._order)},reorder:function(){var a=new THREE.Quaternion;return function(b){a.setFromEuler(this);this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];void 0!==a[3]&&(this._order=a[3]);this.onChangeCallback();return this},toArray:function(a,b){void 0===a&&(a=[]);void 0===b&&(b=0);a[b]=this._x;a[b+1]=this._y;a[b+2]=this._z;a[b+3]=this._order;return a},toVector3:function(a){return a?
a.set(this._x,this._y,this._z):new THREE.Vector3(this._x,this._y,this._z)},onChange:function(a){this.onChangeCallback=a;return this},onChangeCallback:function(){},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}};THREE.Line3=function(a,b){this.start=void 0!==a?a:new THREE.Vector3;this.end=void 0!==b?b:new THREE.Vector3};
THREE.Line3.prototype={constructor:THREE.Line3,set:function(a,b){this.start.copy(a);this.end.copy(b);return this},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},center:function(a){return(a||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(a){return(a||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(a,
b){var c=b||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},closestPointToPointParameter:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d){a.subVectors(c,this.start);b.subVectors(this.end,this.start);var e=b.dot(b),e=b.dot(a)/e;d&&(e=THREE.Math.clamp(e,0,1));return e}}(),closestPointToPoint:function(a,b,c){a=this.closestPointToPointParameter(a,b);c=c||new THREE.Vector3;return this.delta(c).multiplyScalar(a).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);
this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}};THREE.Box2=function(a,b){this.min=void 0!==a?a:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(a){return(a||new THREE.Vector2).addVectors(this.min,
this.max).multiplyScalar(.5)},size:function(a){return(a||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&
this.min.y<=a.min.y&&a.max.y<=this.max.y?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector2).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector2).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2;return function(b){return a.copy(b).clamp(this.min,
this.max).sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};
THREE.Box3=function(a,b){this.min=void 0!==a?a:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(a,b){this.min.copy(a);this.max.copy(b);return this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this},copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},
center:function(a){return(a||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(.5)},size:function(a){return(a||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<
this.min.z||a.z>this.max.z?!1:!0},containsBox:function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z?!0:!1},getParameter:function(a,b){return(b||new THREE.Vector3).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<
this.min.z||a.min.z>this.max.z?!1:!0},clampPoint:function(a,b){return(b||new THREE.Vector3).copy(a).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){return a.copy(b).clamp(this.min,this.max).sub(b).length()}}(),getBoundingSphere:function(){var a=new THREE.Vector3;return function(b){b=b||new THREE.Sphere;b.center=this.center();b.radius=.5*this.size(a).length();return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);
this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(b){a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);
a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};
THREE.Matrix3=function(){this.elements=new Float32Array([1,0,0,0,1,0,0,0,1]);0<arguments.length&&THREE.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(a,b,c,d,e,f,g,h,k){var m=this.elements;m[0]=a;m[3]=b;m[6]=c;m[1]=d;m[4]=e;m[7]=f;m[2]=g;m[5]=h;m[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},multiplyVector3:function(a){THREE.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},
multiplyVector3Array:function(a){THREE.warn("THREE.Matrix3: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");return this.applyToVector3Array(a)},applyToVector3Array:function(){var a=new THREE.Vector3;return function(b,c,d){void 0===c&&(c=0);void 0===d&&(d=b.length);for(var e=0;e<d;e+=3,c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix3(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=
a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7],a=a[8];return b*f*a-b*g*k-c*e*a+c*g*h+d*e*k-d*f*h},getInverse:function(a,b){var c=a.elements,d=this.elements;d[0]=c[10]*c[5]-c[6]*c[9];d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];
c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");THREE.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];
a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];return a},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(a){var b=this.elements;a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]]},clone:function(){return(new THREE.Matrix3).fromArray(this.elements)}};
THREE.Matrix4=function(){this.elements=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);0<arguments.length&&THREE.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(a,b,c,d,e,f,g,h,k,m,l,n,p,q,u,r){var t=this.elements;t[0]=a;t[4]=b;t[8]=c;t[12]=d;t[1]=e;t[5]=f;t[9]=g;t[13]=h;t[2]=k;t[6]=m;t[10]=l;t[14]=n;t[3]=p;t[7]=q;t[11]=u;t[15]=r;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.elements.set(a.elements);return this},extractPosition:function(a){THREE.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(a)},
copyPosition:function(a){var b=this.elements;a=a.elements;b[12]=a[12];b[13]=a[13];b[14]=a[14];return this},extractBasis:function(a,b,c){var d=this.elements;a.set(d[0],d[1],d[2]);b.set(d[4],d[5],d[6]);c.set(d[8],d[9],d[10]);return this},makeBasis:function(a,b,c){this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1);return this},extractRotation:function(){var a=new THREE.Vector3;return function(b){var c=this.elements;b=b.elements;var d=1/a.set(b[0],b[1],b[2]).length(),e=1/a.set(b[4],b[5],b[6]).length(),
f=1/a.set(b[8],b[9],b[10]).length();c[0]=b[0]*d;c[1]=b[1]*d;c[2]=b[2]*d;c[4]=b[4]*e;c[5]=b[5]*e;c[6]=b[6]*e;c[8]=b[8]*f;c[9]=b[9]*f;c[10]=b[10]*f;return this}}(),makeRotationFromEuler:function(a){!1===a instanceof THREE.Euler&&THREE.error("THREE.Matrix: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c),c=Math.sin(c),g=Math.cos(d),d=Math.sin(d),h=Math.cos(e),e=Math.sin(e);if("XYZ"===a.order){a=f*h;var k=f*e,
m=c*h,l=c*e;b[0]=g*h;b[4]=-g*e;b[8]=d;b[1]=k+m*d;b[5]=a-l*d;b[9]=-c*g;b[2]=l-a*d;b[6]=m+k*d;b[10]=f*g}else"YXZ"===a.order?(a=g*h,k=g*e,m=d*h,l=d*e,b[0]=a+l*c,b[4]=m*c-k,b[8]=f*d,b[1]=f*e,b[5]=f*h,b[9]=-c,b[2]=k*c-m,b[6]=l+a*c,b[10]=f*g):"ZXY"===a.order?(a=g*h,k=g*e,m=d*h,l=d*e,b[0]=a-l*c,b[4]=-f*e,b[8]=m+k*c,b[1]=k+m*c,b[5]=f*h,b[9]=l-a*c,b[2]=-f*d,b[6]=c,b[10]=f*g):"ZYX"===a.order?(a=f*h,k=f*e,m=c*h,l=c*e,b[0]=g*h,b[4]=m*d-k,b[8]=a*d+l,b[1]=g*e,b[5]=l*d+a,b[9]=k*d-m,b[2]=-d,b[6]=c*g,b[10]=f*g):"YZX"===
a.order?(a=f*g,k=f*d,m=c*g,l=c*d,b[0]=g*h,b[4]=l-a*e,b[8]=m*e+k,b[1]=e,b[5]=f*h,b[9]=-c*h,b[2]=-d*h,b[6]=k*e+m,b[10]=a-l*e):"XZY"===a.order&&(a=f*g,k=f*d,m=c*g,l=c*d,b[0]=g*h,b[4]=-e,b[8]=d*h,b[1]=a*e+l,b[5]=f*h,b[9]=k*e-m,b[2]=m*e-k,b[6]=c*h,b[10]=l*e+a);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},setRotationFromQuaternion:function(a){THREE.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion().");return this.makeRotationFromQuaternion(a)},
makeRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,e=a.z,f=a.w,g=c+c,h=d+d,k=e+e;a=c*g;var m=c*h,c=c*k,l=d*h,d=d*k,e=e*k,g=f*g,h=f*h,f=f*k;b[0]=1-(l+e);b[4]=m-f;b[8]=c+h;b[1]=m+f;b[5]=1-(a+e);b[9]=d-g;b[2]=c-h;b[6]=d+g;b[10]=1-(a+l);b[3]=0;b[7]=0;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return this},lookAt:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f){var g=this.elements;c.subVectors(d,e).normalize();0===c.length()&&(c.z=1);a.crossVectors(f,
c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(f,c).normalize());b.crossVectors(c,a);g[0]=a.x;g[4]=b.x;g[8]=c.x;g[1]=a.y;g[5]=b.y;g[9]=c.y;g[2]=a.z;g[6]=b.z;g[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(THREE.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(a,b)):this.multiplyMatrices(this,a)},multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],
k=c[12],m=c[1],l=c[5],n=c[9],p=c[13],q=c[2],u=c[6],r=c[10],t=c[14],v=c[3],x=c[7],w=c[11],c=c[15],E=d[0],C=d[4],y=d[8],G=d[12],L=d[1],M=d[5],N=d[9],D=d[13],J=d[2],z=d[6],B=d[10],O=d[14],P=d[3],F=d[7],H=d[11],d=d[15];e[0]=f*E+g*L+h*J+k*P;e[4]=f*C+g*M+h*z+k*F;e[8]=f*y+g*N+h*B+k*H;e[12]=f*G+g*D+h*O+k*d;e[1]=m*E+l*L+n*J+p*P;e[5]=m*C+l*M+n*z+p*F;e[9]=m*y+l*N+n*B+p*H;e[13]=m*G+l*D+n*O+p*d;e[2]=q*E+u*L+r*J+t*P;e[6]=q*C+u*M+r*z+t*F;e[10]=q*y+u*N+r*B+t*H;e[14]=q*G+u*D+r*O+t*d;e[3]=v*E+x*L+w*J+c*P;e[7]=v*C+
x*M+w*z+c*F;e[11]=v*y+x*N+w*B+c*H;e[15]=v*G+x*D+w*O+c*d;return this},multiplyToArray:function(a,b,c){var d=this.elements;this.multiplyMatrices(a,b);c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=d[3];c[4]=d[4];c[5]=d[5];c[6]=d[6];c[7]=d[7];c[8]=d[8];c[9]=d[9];c[10]=d[10];c[11]=d[11];c[12]=d[12];c[13]=d[13];c[14]=d[14];c[15]=d[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=
a;b[15]*=a;return this},multiplyVector3:function(a){THREE.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return a.applyProjection(this)},multiplyVector4:function(a){THREE.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(a){THREE.warn("THREE.Matrix4: .multiplyVector3Array() has been renamed. Use matrix.applyToVector3Array( array ) instead.");
return this.applyToVector3Array(a)},applyToVector3Array:function(){var a=new THREE.Vector3;return function(b,c,d){void 0===c&&(c=0);void 0===d&&(d=b.length);for(var e=0;e<d;e+=3,c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.applyMatrix4(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),rotateAxis:function(a){THREE.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){THREE.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");
return a.applyMatrix4(this)},determinant:function(){var a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],k=a[13],m=a[2],l=a[6],n=a[10],p=a[14];return a[3]*(+e*h*l-d*k*l-e*g*n+c*k*n+d*g*p-c*h*p)+a[7]*(+b*h*p-b*k*n+e*f*n-d*f*p+d*k*m-e*h*m)+a[11]*(+b*k*l-b*g*p-e*f*l+c*f*p+e*g*m-c*k*m)+a[15]*(-d*g*m-b*h*l+b*g*n+d*f*l-c*f*n+c*h*m)},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];
a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},flattenToArrayOffset:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},getPosition:function(){var a=new THREE.Vector3;return function(){THREE.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=
this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,e=d[0],f=d[4],g=d[8],h=d[12],k=d[1],m=d[5],l=d[9],n=d[13],p=d[2],q=d[6],u=d[10],r=d[14],t=d[3],v=d[7],x=d[11],d=d[15];c[0]=l*r*v-n*u*v+n*q*x-m*r*x-l*q*d+m*u*d;c[4]=h*u*v-g*r*v-h*q*x+f*r*x+g*q*d-f*u*d;c[8]=g*n*v-h*l*v+h*m*x-f*n*x-g*m*d+f*l*d;c[12]=h*l*q-g*n*q-h*m*u+f*n*u+g*m*r-f*l*r;c[1]=n*u*t-l*r*t-n*p*x+
k*r*x+l*p*d-k*u*d;c[5]=g*r*t-h*u*t+h*p*x-e*r*x-g*p*d+e*u*d;c[9]=h*l*t-g*n*t-h*k*x+e*n*x+g*k*d-e*l*d;c[13]=g*n*p-h*l*p+h*k*u-e*n*u-g*k*r+e*l*r;c[2]=m*r*t-n*q*t+n*p*v-k*r*v-m*p*d+k*q*d;c[6]=h*q*t-f*r*t-h*p*v+e*r*v+f*p*d-e*q*d;c[10]=f*n*t-h*m*t+h*k*v-e*n*v-f*k*d+e*m*d;c[14]=h*m*p-f*n*p-h*k*q+e*n*q+f*k*r-e*m*r;c[3]=l*q*t-m*u*t-l*p*v+k*u*v+m*p*x-k*q*x;c[7]=f*u*t-g*q*t+g*p*v-e*u*v-f*p*x+e*q*x;c[11]=g*m*t-f*l*t-g*k*v+e*l*v+f*k*x-e*m*x;c[15]=f*l*p-g*m*p+g*k*q-e*l*q-f*k*u+e*m*u;c=e*c[0]+k*c[4]+p*c[8]+t*c[12];
if(0==c){if(b)throw Error("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");THREE.warn("THREE.Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},translate:function(a){THREE.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(a){THREE.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(a){THREE.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(a){THREE.error("THREE.Matrix4: .rotateZ() has been removed.")},
rotateByAxis:function(a,b){THREE.error("THREE.Matrix4: .rotateByAxis() has been removed.")},scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeTranslation:function(a,b,c){this.set(1,0,0,a,0,1,0,b,0,0,1,
c,0,0,0,1);return this},makeRotationX:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(1,0,0,0,0,b,-a,0,0,a,b,0,0,0,0,1);return this},makeRotationY:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,0,a,0,0,1,0,0,-a,0,b,0,0,0,0,1);return this},makeRotationZ:function(a){var b=Math.cos(a);a=Math.sin(a);this.set(b,-a,0,0,a,b,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,k=e*f,m=e*g;this.set(k*f+c,k*g-d*h,k*h+d*g,0,k*g+
d*h,m*g+c,m*h-d*f,0,k*h-d*g,m*h+d*f,e*h*h+c,0,0,0,0,1);return this},makeScale:function(a,b,c){this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a=new THREE.Vector3,b=new THREE.Matrix4;return function(c,d,e){var f=this.elements,g=a.set(f[0],f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),k=a.set(f[8],f[9],f[10]).length();0>this.determinant()&&(g=-g);c.x=f[12];
c.y=f[13];c.z=f[14];b.elements.set(this.elements);c=1/g;var f=1/h,m=1/k;b.elements[0]*=c;b.elements[1]*=c;b.elements[2]*=c;b.elements[4]*=f;b.elements[5]*=f;b.elements[6]*=f;b.elements[8]*=m;b.elements[9]*=m;b.elements[10]*=m;d.setFromRotationMatrix(b);e.x=g;e.y=h;e.z=k;return this}}(),makeFrustum:function(a,b,c,d,e,f){var g=this.elements;g[0]=2*e/(b-a);g[4]=0;g[8]=(b+a)/(b-a);g[12]=0;g[1]=0;g[5]=2*e/(d-c);g[9]=(d+c)/(d-c);g[13]=0;g[2]=0;g[6]=0;g[10]=-(f+e)/(f-e);g[14]=-2*f*e/(f-e);g[3]=0;g[7]=0;
g[11]=-1;g[15]=0;return this},makePerspective:function(a,b,c,d){a=c*Math.tan(THREE.Math.degToRad(.5*a));var e=-a;return this.makeFrustum(e*b,a*b,e,a,c,d)},makeOrthographic:function(a,b,c,d,e,f){var g=this.elements,h=b-a,k=c-d,m=f-e;g[0]=2/h;g[4]=0;g[8]=0;g[12]=-((b+a)/h);g[1]=0;g[5]=2/k;g[9]=0;g[13]=-((c+d)/k);g[2]=0;g[6]=0;g[10]=-2/m;g[14]=-((f+e)/m);g[3]=0;g[7]=0;g[11]=0;g[15]=1;return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],
a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){return(new THREE.Matrix4).fromArray(this.elements)}};THREE.Triangle=function(a,b,c){this.a=void 0!==a?a:new THREE.Vector3;this.b=void 0!==b?b:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};
THREE.Triangle.normal=function(){var a=new THREE.Vector3;return function(b,c,d,e){e=e||new THREE.Vector3;e.subVectors(d,c);a.subVectors(b,c);e.cross(a);b=e.lengthSq();return 0<b?e.multiplyScalar(1/Math.sqrt(b)):e.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f,g,h){a.subVectors(g,e);b.subVectors(f,e);c.subVectors(d,e);d=a.dot(a);e=a.dot(b);f=a.dot(c);var k=b.dot(b);g=b.dot(c);var m=d*k-e*e;h=h||new THREE.Vector3;if(0==m)return h.set(-2,-1,-1);m=1/m;k=(k*f-e*g)*m;d=(d*g-e*f)*m;return h.set(1-k-d,d,k)}}();
THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3;return function(b,c,d,e){b=THREE.Triangle.barycoordFromPoint(b,c,d,e,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(a,b,c){this.a.copy(a);this.b.copy(b);this.c.copy(c);return this},setFromPointsAndIndices:function(a,b,c,d){this.a.copy(a[b]);this.b.copy(a[c]);this.c.copy(a[d]);return this},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return.5*a.cross(b).length()}}(),midpoint:function(a){return(a||
new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(a){return(a||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},
clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Ray=function(a,b){this.origin=void 0!==a?a:new THREE.Vector3;this.direction=void 0!==b?b:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new THREE.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new THREE.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new THREE.Vector3;c.subVectors(a,this.origin);
var d=c.dot(this.direction);return 0>d?c.copy(this.origin):c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(){var a=new THREE.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(0>c)return this.origin.distanceTo(b);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),distanceSqToSegment:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3;return function(d,e,f,g){a.copy(d).add(e).multiplyScalar(.5);
b.copy(e).sub(d).normalize();c.copy(this.origin).sub(a);var h=.5*d.distanceTo(e),k=-this.direction.dot(b),m=c.dot(this.direction),l=-c.dot(b),n=c.lengthSq(),p=Math.abs(1-k*k),q;0<p?(d=k*l-m,e=k*m-l,q=h*p,0<=d?e>=-q?e<=q?(h=1/p,d*=h,e*=h,k=d*(d+k*e+2*m)+e*(k*d+e+2*l)+n):(e=h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n):(e=-h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n):e<=-q?(d=Math.max(0,-(-k*h+m)),e=0<d?-h:Math.min(Math.max(-h,-l),h),k=-d*d+e*(e+2*l)+n):e<=q?(d=0,e=Math.min(Math.max(-h,-l),h),k=e*(e+
2*l)+n):(d=Math.max(0,-(k*h+m)),e=0<d?h:Math.min(Math.max(-h,-l),h),k=-d*d+e*(e+2*l)+n)):(e=0<k?-h:h,d=Math.max(0,-(k*e+m)),k=-d*d+e*(e+2*l)+n);f&&f.copy(this.direction).multiplyScalar(d).add(this.origin);g&&g.copy(b).multiplyScalar(e).add(a);return k}}(),isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},intersectSphere:function(){var a=new THREE.Vector3;return function(b,c){a.subVectors(b.center,this.origin);var d=a.dot(this.direction),e=a.dot(a)-d*d,f=b.radius*b.radius;
if(e>f)return null;f=Math.sqrt(f-e);e=d-f;d+=f;return 0>e&&0>d?null:0>e?this.at(d,c):this.at(e,c)}}(),isIntersectionPlane:function(a){var b=a.distanceToPoint(this.origin);return 0===b||0>a.normal.dot(this.direction)*b?!0:!1},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0==b)return 0==a.distanceToPoint(this.origin)?0:null;a=-(this.origin.dot(a.normal)+a.constant)/b;return 0<=a?a:null},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return null===c?null:this.at(c,b)},
isIntersectionBox:function(){var a=new THREE.Vector3;return function(b){return null!==this.intersectBox(b,a)}}(),intersectBox:function(a,b){var c,d,e,f,g;d=1/this.direction.x;f=1/this.direction.y;g=1/this.direction.z;var h=this.origin;0<=d?(c=(a.min.x-h.x)*d,d*=a.max.x-h.x):(c=(a.max.x-h.x)*d,d*=a.min.x-h.x);0<=f?(e=(a.min.y-h.y)*f,f*=a.max.y-h.y):(e=(a.max.y-h.y)*f,f*=a.min.y-h.y);if(c>f||e>d)return null;if(e>c||c!==c)c=e;if(f<d||d!==d)d=f;0<=g?(e=(a.min.z-h.z)*g,g*=a.max.z-h.z):(e=(a.max.z-h.z)*
g,g*=a.min.z-h.z);if(c>g||e>d)return null;if(e>c||c!==c)c=e;if(g<d||d!==d)d=g;return 0>d?null:this.at(0<=c?c:d,b)},intersectTriangle:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3;return function(e,f,g,h,k){b.subVectors(f,e);c.subVectors(g,e);d.crossVectors(b,c);f=this.direction.dot(d);if(0<f){if(h)return null;h=1}else if(0>f)h=-1,f=-f;else return null;a.subVectors(this.origin,e);e=h*this.direction.dot(c.crossVectors(a,c));if(0>e)return null;g=h*this.direction.dot(b.cross(a));
if(0>g||e+g>f)return null;e=-h*a.dot(d);return 0>e?null:this.at(e/f,k)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}};THREE.Sphere=function(a,b){this.center=void 0!==a?a:new THREE.Vector3;this.radius=void 0!==b?b:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},setFromPoints:function(){var a=new THREE.Box3;return function(b,c){var d=this.center;void 0!==c?d.copy(c):a.setFromPoints(b).center(d);for(var e=0,f=0,g=b.length;f<g;f++)e=Math.max(e,d.distanceToSquared(b[f]));this.radius=Math.sqrt(e);return this}}(),copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(a){return a.distanceToSquared(this.center)<=
this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},clampPoint:function(a,b){var c=this.center.distanceToSquared(a),d=b||new THREE.Vector3;d.copy(a);c>this.radius*this.radius&&(d.sub(this.center).normalize(),d.multiplyScalar(this.radius).add(this.center));return d},getBoundingBox:function(a){a=a||new THREE.Box3;a.set(this.center,this.center);a.expandByScalar(this.radius);
return a},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};
THREE.Frustum=function(a,b,c,d,e,f){this.planes=[void 0!==a?a:new THREE.Plane,void 0!==b?b:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==f?f:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(a,b,c,d,e,f){var g=this.planes;g[0].copy(a);g[1].copy(b);g[2].copy(c);g[3].copy(d);g[4].copy(e);g[5].copy(f);return this},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.elements;a=c[0];var d=c[1],e=c[2],f=c[3],g=c[4],h=c[5],k=c[6],m=c[7],l=c[8],n=c[9],p=c[10],q=c[11],u=c[12],r=c[13],t=c[14],c=c[15];b[0].setComponents(f-a,m-g,q-l,c-u).normalize();b[1].setComponents(f+
a,m+g,q+l,c+u).normalize();b[2].setComponents(f+d,m+h,q+n,c+r).normalize();b[3].setComponents(f-d,m-h,q-n,c-r).normalize();b[4].setComponents(f-e,m-k,q-p,c-t).normalize();b[5].setComponents(f+e,m+k,q+p,c+t).normalize();return this},intersectsObject:function(){var a=new THREE.Sphere;return function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();a.copy(c.boundingSphere);a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(a){var b=this.planes,
c=a.center;a=-a.radius;for(var d=0;6>d;d++)if(b[d].distanceToPoint(c)<a)return!1;return!0},intersectsBox:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c){for(var d=this.planes,e=0;6>e;e++){var f=d[e];a.x=0<f.normal.x?c.min.x:c.max.x;b.x=0<f.normal.x?c.max.x:c.min.x;a.y=0<f.normal.y?c.min.y:c.max.y;b.y=0<f.normal.y?c.max.y:c.min.y;a.z=0<f.normal.z?c.min.z:c.max.z;b.z=0<f.normal.z?c.max.z:c.min.z;var g=f.distanceToPoint(a),f=f.distanceToPoint(b);if(0>g&&0>f)return!1}return!0}}(),
containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(0>b[c].distanceToPoint(a))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Plane=function(a,b){this.normal=void 0!==a?a:new THREE.Vector3(1,0,0);this.constant=void 0!==b?b:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(a,b){this.normal.copy(a);this.constant=b;return this},setComponents:function(a,b,c,d){this.normal.set(a,b,c);this.constant=d;return this},setFromNormalAndCoplanarPoint:function(a,b){this.normal.copy(a);this.constant=-b.dot(this.normal);return this},setFromCoplanarPoints:function(){var a=new THREE.Vector3,b=new THREE.Vector3;return function(c,d,e){d=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();this.setFromNormalAndCoplanarPoint(d,
c);return this}}(),copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(a,
b){var c=this.distanceToPoint(a);return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var b=this.distanceToPoint(a.start);a=this.distanceToPoint(a.end);return 0>b&&0<a||0>a&&0<b},intersectLine:function(){var a=new THREE.Vector3;return function(b,c){var d=c||new THREE.Vector3,e=b.delta(a),f=this.normal.dot(e);if(0==f){if(0==this.distanceToPoint(b.start))return d.copy(b.start)}else if(f=-(b.start.dot(this.normal)+this.constant)/f,!(0>f||1<f))return d.copy(e).multiplyScalar(f).add(b.start)}}(),
coplanarPoint:function(a){return(a||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Matrix3;return function(d,e){var f=e||c.getNormalMatrix(d),f=a.copy(this.normal).applyMatrix3(f),g=this.coplanarPoint(b);g.applyMatrix4(d);this.setFromNormalAndCoplanarPoint(f,g);return this}}(),translate:function(a){this.constant-=a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&
a.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};
THREE.Math={generateUUID:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,d;return function(){for(var e=0;36>e;e++)8==e||13==e||18==e||23==e?b[e]="-":14==e?b[e]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),d=c&15,c>>=4,b[e]=a[19==e?d&3|8:d]);return b.join("")}}(),clamp:function(a,b,c){return a<b?b:a>c?c:a},clampBottom:function(a,b){return a<b?b:a},mapLinear:function(a,b,c,d,e){return d+(a-b)*(e-d)/(c-b)},smoothstep:function(a,b,c){if(a<=
b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*(3-2*a)},smootherstep:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return Math.floor(this.randFloat(a,b))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(.5-Math.random())},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}(),radToDeg:function(){var a=
180/Math.PI;return function(b){return b*a}}(),isPowerOfTwo:function(a){return 0===(a&a-1)&&0!==a},nextPowerOfTwo:function(a){a--;a|=a>>1;a|=a>>2;a|=a>>4;a|=a>>8;a|=a>>16;a++;return a}};THREE.Clock=function(a){this.autoStart=void 0!==a?a:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};
THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var a=0;this.autoStart&&!this.running&&this.start();if(this.running){var b=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),
a=.001*(b-this.oldTime);this.oldTime=b;this.elapsedTime+=a}return a}};THREE.EventDispatcher=function(){};
THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(a){a.addEventListener=THREE.EventDispatcher.prototype.addEventListener;a.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;a.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&
c[a].push(b)},hasEventListener:function(a,b){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==this._listeners){var c=this._listeners[a];if(void 0!==c){var d=c.indexOf(b);-1!==d&&c.splice(d,1)}}},dispatchEvent:function(a){if(void 0!==this._listeners){var b=this._listeners[a.type];if(void 0!==b){a.target=this;for(var c=[],d=b.length,e=0;e<d;e++)c[e]=b[e];for(e=0;e<d;e++)c[e].call(this,a)}}}};
THREE.Object3D=function(){Object.defineProperty(this,"id",{value:THREE.Object3DIdCount++});this.name="";this.parent=void 0;this.children=[];this.up=THREE.Object3D.DefaultUp.clone();var a=new THREE.Vector3,b=new THREE.Euler,c=new THREE.Quaternion,d=new THREE.Vector3(1,1,1);b.onChange(function(){c.setFromEuler(b,!1)});c.onChange(function(){b.setFromQuaternion(c,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,value:a},rotation:{enumerable:!0,value:b},quaternion:{enumerable:!0,value:c},
scale:{enumerable:!0,value:d}});this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixAutoUpdate=!0;this.matrixWorldNeedsUpdate=!1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={}};THREE.Object3D.DefaultUp=new THREE.Vector3(0,1,0);
THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(a){this.matrix.multiplyMatrices(a,this.matrix);this.matrix.decompose(this.position,this.quaternion,this.scale)},setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,!0)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=
new THREE.Quaternion;return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new THREE.Vector3;return function(b,c){a.copy(b).applyQuaternion(this.quaternion);
this.position.add(a.multiplyScalar(c));return this}}(),translate:function(a,b){THREE.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");return this.translateOnAxis(b,a)},translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,
b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4;return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new THREE.Matrix4;return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return THREE.error("THREE.Object3D.add: object can't be added as a child of itself.",
a),this;a instanceof THREE.Object3D?(void 0!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"}),this.children.push(a)):THREE.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a);return this},remove:function(a){if(1<arguments.length)for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);b=this.children.indexOf(a);-1!==b&&(a.parent=void 0,a.dispatchEvent({type:"removed"}),this.children.splice(b,1))},getChildByName:function(a){THREE.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName().");
return this.getObjectByName(a)},getObjectById:function(a){return this.getObjectByProperty("id",a)},getObjectByName:function(a){return this.getObjectByProperty("name",a)},getObjectByProperty:function(a,b){if(this[a]===b)return this;for(var c=0,d=this.children.length;c<d;c++){var e=this.children[c].getObjectByProperty(a,b);if(void 0!==e)return e}},getWorldPosition:function(a){a=a||new THREE.Vector3;this.updateMatrixWorld(!0);return a.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var a=
new THREE.Vector3,b=new THREE.Vector3;return function(c){c=c||new THREE.Quaternion;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,c,b);return c}}(),getWorldRotation:function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Euler;this.getWorldQuaternion(a);return b.setFromQuaternion(a,this.rotation.order,!1)}}(),getWorldScale:function(){var a=new THREE.Vector3,b=new THREE.Quaternion;return function(c){c=c||new THREE.Vector3;this.updateMatrixWorld(!0);this.matrixWorld.decompose(a,
b,c);return c}}(),getWorldDirection:function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Vector3;this.getWorldQuaternion(a);return b.set(0,0,1).applyQuaternion(a)}}(),raycast:function(){},traverse:function(a){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverse(a)},traverseVisible:function(a){if(!1!==this.visible){a(this);for(var b=0,c=this.children.length;b<c;b++)this.children[b].traverseVisible(a)}},traverseAncestors:function(a){this.parent&&(a(this.parent),
this.parent.traverseAncestors(a))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].updateMatrixWorld(a)},
clone:function(a,b){void 0===a&&(a=new THREE.Object3D);void 0===b&&(b=!0);a.name=this.name;a.up.copy(this.up);a.position.copy(this.position);a.quaternion.copy(this.quaternion);a.scale.copy(this.scale);a.rotationAutoUpdate=this.rotationAutoUpdate;a.matrix.copy(this.matrix);a.matrixWorld.copy(this.matrixWorld);a.matrixAutoUpdate=this.matrixAutoUpdate;a.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;a.visible=this.visible;a.castShadow=this.castShadow;a.receiveShadow=this.receiveShadow;a.frustumCulled=
this.frustumCulled;a.userData=JSON.parse(JSON.stringify(this.userData));if(!0===b)for(var c=0;c<this.children.length;c++)a.add(this.children[c].clone());return a}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;
THREE.Face3=function(a,b,c,d,e,f){this.a=a;this.b=b;this.c=c;this.normal=d instanceof THREE.Vector3?d:new THREE.Vector3;this.vertexNormals=d instanceof Array?d:[];this.color=e instanceof THREE.Color?e:new THREE.Color;this.vertexColors=e instanceof Array?e:[];this.vertexTangents=[];this.materialIndex=void 0!==f?f:0};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var a=new THREE.Face3(this.a,this.b,this.c);a.normal.copy(this.normal);a.color.copy(this.color);a.materialIndex=this.materialIndex;for(var b=0,c=this.vertexNormals.length;b<c;b++)a.vertexNormals[b]=this.vertexNormals[b].clone();b=0;for(c=this.vertexColors.length;b<c;b++)a.vertexColors[b]=this.vertexColors[b].clone();b=0;for(c=this.vertexTangents.length;b<c;b++)a.vertexTangents[b]=this.vertexTangents[b].clone();return a}};
THREE.BufferAttribute=function(a,b){this.array=a;this.itemSize=b;this.needsUpdate=!1};
THREE.BufferAttribute.prototype={constructor:THREE.BufferAttribute,get length(){return this.array.length},copyAt:function(a,b,c){a*=this.itemSize;c*=b.itemSize;for(var d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this},set:function(a,b){void 0===b&&(b=0);this.array.set(a,b);return this},setX:function(a,b){this.array[a*this.itemSize]=b;return this},setY:function(a,b){this.array[a*this.itemSize+1]=b;return this},setZ:function(a,b){this.array[a*this.itemSize+2]=b;return this},setXY:function(a,
b,c){a*=this.itemSize;this.array[a]=b;this.array[a+1]=c;return this},setXYZ:function(a,b,c,d){a*=this.itemSize;this.array[a]=b;this.array[a+1]=c;this.array[a+2]=d;return this},setXYZW:function(a,b,c,d,e){a*=this.itemSize;this.array[a]=b;this.array[a+1]=c;this.array[a+2]=d;this.array[a+3]=e;return this},clone:function(){return new THREE.BufferAttribute(new this.array.constructor(this.array),this.itemSize)}};
THREE.BufferGeometry=function(){Object.defineProperty(this,"id",{value:THREE.GeometryIdCount++});this.name="";this.attributes={};this.attributesKeys=[];this.offsets=this.drawcalls=[];this.boundingSphere=this.boundingBox=null};
THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(a,b){this.attributes[a]=b;this.attributesKeys=Object.keys(this.attributes)},getAttribute:function(a){return this.attributes[a]},addDrawCall:function(a,b,c){this.drawcalls.push({start:a,count:b,index:void 0!==c?c:0})},applyMatrix:function(a){var b=this.attributes.position;void 0!==b&&(a.applyToVector3Array(b.array),b.needsUpdate=!0);b=this.attributes.normal;void 0!==b&&((new THREE.Matrix3).getNormalMatrix(a).applyToVector3Array(b.array),
b.needsUpdate=!0);null!==this.boundingBox&&this.computeBoundingBox();null!==this.boundingSphere&&this.computeBoundingSphere()},center:function(){this.computeBoundingBox();var a=this.boundingBox.center().negate();this.applyMatrix((new THREE.Matrix4).setPosition(a));return a},computeBoundingBox:function(){var a=new THREE.Vector3;return function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var b=this.attributes.position.array;if(b){var c=this.boundingBox;c.makeEmpty();for(var d=0,e=b.length;d<
e;d+=3)a.set(b[d],b[d+1],b[d+2]),c.expandByPoint(a)}if(void 0===b||0===b.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0);(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&THREE.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')}}(),computeBoundingSphere:function(){var a=new THREE.Box3,b=new THREE.Vector3;return function(){null===this.boundingSphere&&
(this.boundingSphere=new THREE.Sphere);var c=this.attributes.position.array;if(c){a.makeEmpty();for(var d=this.boundingSphere.center,e=0,f=c.length;e<f;e+=3)b.set(c[e],c[e+1],c[e+2]),a.expandByPoint(b);a.center(d);for(var g=0,e=0,f=c.length;e<f;e+=3)b.set(c[e],c[e+1],c[e+2]),g=Math.max(g,d.distanceToSquared(b));this.boundingSphere.radius=Math.sqrt(g);isNaN(this.boundingSphere.radius)&&THREE.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),
computeVertexNormals:function(){var a=this.attributes;if(a.position){var b=a.position.array;if(void 0===a.normal)this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(b.length),3));else for(var c=a.normal.array,d=0,e=c.length;d<e;d++)c[d]=0;var c=a.normal.array,f,g,h,k=new THREE.Vector3,m=new THREE.Vector3,l=new THREE.Vector3,n=new THREE.Vector3,p=new THREE.Vector3;if(a.index)for(var q=a.index.array,u=0<this.offsets.length?this.offsets:[{start:0,count:q.length,index:0}],r=0,t=u.length;r<
t;++r){e=u[r].start;f=u[r].count;for(var v=u[r].index,d=e,e=e+f;d<e;d+=3)f=3*(v+q[d]),g=3*(v+q[d+1]),h=3*(v+q[d+2]),k.fromArray(b,f),m.fromArray(b,g),l.fromArray(b,h),n.subVectors(l,m),p.subVectors(k,m),n.cross(p),c[f]+=n.x,c[f+1]+=n.y,c[f+2]+=n.z,c[g]+=n.x,c[g+1]+=n.y,c[g+2]+=n.z,c[h]+=n.x,c[h+1]+=n.y,c[h+2]+=n.z}else for(d=0,e=b.length;d<e;d+=9)k.fromArray(b,d),m.fromArray(b,d+3),l.fromArray(b,d+6),n.subVectors(l,m),p.subVectors(k,m),n.cross(p),c[d]=n.x,c[d+1]=n.y,c[d+2]=n.z,c[d+3]=n.x,c[d+4]=n.y,
c[d+5]=n.z,c[d+6]=n.x,c[d+7]=n.y,c[d+8]=n.z;this.normalizeNormals();a.normal.needsUpdate=!0}},computeTangents:function(){function a(a,b,c){n.fromArray(d,3*a);p.fromArray(d,3*b);q.fromArray(d,3*c);u.fromArray(f,2*a);r.fromArray(f,2*b);t.fromArray(f,2*c);v=p.x-n.x;x=q.x-n.x;w=p.y-n.y;E=q.y-n.y;C=p.z-n.z;y=q.z-n.z;G=r.x-u.x;L=t.x-u.x;M=r.y-u.y;N=t.y-u.y;D=1/(G*N-L*M);J.set((N*v-M*x)*D,(N*w-M*E)*D,(N*C-M*y)*D);z.set((G*x-L*v)*D,(G*E-L*w)*D,(G*y-L*C)*D);k[a].add(J);k[b].add(J);k[c].add(J);m[a].add(z);
m[b].add(z);m[c].add(z)}function b(a){Q.fromArray(e,3*a);S.copy(Q);Y=k[a];K.copy(Y);K.sub(Q.multiplyScalar(Q.dot(Y))).normalize();X.crossVectors(S,Y);V=X.dot(m[a]);Z=0>V?-1:1;h[4*a]=K.x;h[4*a+1]=K.y;h[4*a+2]=K.z;h[4*a+3]=Z}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)THREE.warn("THREE.BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var c=this.attributes.index.array,
d=this.attributes.position.array,e=this.attributes.normal.array,f=this.attributes.uv.array,g=d.length/3;void 0===this.attributes.tangent&&this.addAttribute("tangent",new THREE.BufferAttribute(new Float32Array(4*g),4));for(var h=this.attributes.tangent.array,k=[],m=[],l=0;l<g;l++)k[l]=new THREE.Vector3,m[l]=new THREE.Vector3;var n=new THREE.Vector3,p=new THREE.Vector3,q=new THREE.Vector3,u=new THREE.Vector2,r=new THREE.Vector2,t=new THREE.Vector2,v,x,w,E,C,y,G,L,M,N,D,J=new THREE.Vector3,z=new THREE.Vector3,
B,O,P,F,H;0===this.drawcalls.length&&this.addDrawCall(0,c.length,0);var I=this.drawcalls,l=0;for(O=I.length;l<O;++l){B=I[l].start;P=I[l].count;var A=I[l].index,g=B;for(B+=P;g<B;g+=3)P=A+c[g],F=A+c[g+1],H=A+c[g+2],a(P,F,H)}var K=new THREE.Vector3,X=new THREE.Vector3,Q=new THREE.Vector3,S=new THREE.Vector3,Z,Y,V,l=0;for(O=I.length;l<O;++l)for(B=I[l].start,P=I[l].count,A=I[l].index,g=B,B+=P;g<B;g+=3)P=A+c[g],F=A+c[g+1],H=A+c[g+2],b(P),b(F),b(H)}},normalizeNormals:function(){for(var a=this.attributes.normal.array,
b,c,d,e=0,f=a.length;e<f;e+=3)b=a[e],c=a[e+1],d=a[e+2],b=1/Math.sqrt(b*b+c*c+d*d),a[e]*=b,a[e+1]*=b,a[e+2]*=b},clone:function(){var a=new THREE.BufferGeometry,b;for(b in this.attributes)a.addAttribute(b,this.attributes[b].clone());b=0;for(var c=this.offsets.length;b<c;b++){var d=this.offsets[b];a.offsets.push({start:d.start,index:d.index,count:d.count})}return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);
THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.constructor=THREE.Camera;THREE.Camera.prototype.getWorldDirection=function(){var a=new THREE.Quaternion;return function(b){b=b||new THREE.Vector3;this.getWorldQuaternion(a);return b.set(0,0,-1).applyQuaternion(a)}}();
THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4;return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();THREE.Camera.prototype.clone=function(a){void 0===a&&(a=new THREE.Camera);THREE.Object3D.prototype.clone.call(this,a);a.matrixWorldInverse.copy(this.matrixWorldInverse);a.projectionMatrix.copy(this.projectionMatrix);return a};
THREE.PerspectiveCamera=function(a,b,c,d){THREE.Camera.call(this);this.zoom=1;this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:.1;this.far=void 0!==d?d:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.constructor=THREE.PerspectiveCamera;THREE.PerspectiveCamera.prototype.setLens=function(a,b){void 0===b&&(b=24);this.fov=2*THREE.Math.radToDeg(Math.atan(b/(2*a)));this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.setViewOffset=function(a,b,c,d,e,f){this.fullWidth=a;this.fullHeight=b;this.x=c;this.y=d;this.width=e;this.height=f;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){var a=THREE.Math.radToDeg(2*Math.atan(Math.tan(.5*THREE.Math.degToRad(this.fov))/this.zoom));if(this.fullWidth){var b=this.fullWidth/this.fullHeight,a=Math.tan(THREE.Math.degToRad(.5*a))*this.near,c=-a,d=b*c,b=Math.abs(b*a-d),c=Math.abs(a-c);this.projectionMatrix.makeFrustum(d+this.x*b/this.fullWidth,d+(this.x+this.width)*b/this.fullWidth,a-(this.y+this.height)*c/this.fullHeight,a-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(a,
this.aspect,this.near,this.far)};THREE.PerspectiveCamera.prototype.clone=function(){var a=new THREE.PerspectiveCamera;THREE.Camera.prototype.clone.call(this,a);a.zoom=this.zoom;a.fov=this.fov;a.aspect=this.aspect;a.near=this.near;a.far=this.far;a.projectionMatrix.copy(this.projectionMatrix);return a};THREE.OrthographicCamera=function(a,b,c,d,e,f){THREE.Camera.call(this);this.zoom=1;this.left=a;this.right=b;this.top=c;this.bottom=d;this.near=void 0!==e?e:.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()};
THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.constructor=THREE.OrthographicCamera;THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){var a=(this.right-this.left)/(2*this.zoom),b=(this.top-this.bottom)/(2*this.zoom),c=(this.right+this.left)/2,d=(this.top+this.bottom)/2;this.projectionMatrix.makeOrthographic(c-a,c+a,d+b,d-b,this.near,this.far)};
THREE.OrthographicCamera.prototype.clone=function(){var a=new THREE.OrthographicCamera;THREE.Camera.prototype.clone.call(this,a);a.zoom=this.zoom;a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.near=this.near;a.far=this.far;a.projectionMatrix.copy(this.projectionMatrix);return a};THREE.Mesh=function(a,b){THREE.Object3D.call(this);this.geometry=void 0!==a?a:new THREE.Geometry;this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random()});this.updateMorphTargets()};
THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);THREE.Mesh.prototype.constructor=THREE.Mesh;
THREE.Mesh.prototype.updateMorphTargets=function(){if(void 0!==this.geometry.morphTargets&&0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(void 0!==this.morphTargetDictionary[a])return this.morphTargetDictionary[a];THREE.warn("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(a,b){void 0===a&&(a=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,a,b);return a};THREE.Scene=function(){THREE.Object3D.call(this);this.overrideMaterial=null;this.autoUpdate=!0};
THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);THREE.Scene.prototype.constructor=THREE.Scene;THREE.Scene.prototype.clone=function(a){void 0===a&&(a=new THREE.Scene);THREE.Object3D.prototype.clone.call(this,a);null!==this.overrideMaterial&&(a.overrideMaterial=this.overrideMaterial.clone());a.autoUpdate=this.autoUpdate;a.matrixAutoUpdate=this.matrixAutoUpdate;return a};
THREE.UniformsUtils={merge:function(a){for(var b={},c=0;c<a.length;c++){var d=this.clone(a[c]),e;for(e in d)b[e]=d[e]}return b},clone:function(a){var b={},c;for(c in a){b[c]={};for(var d in a[c]){var e=a[c][d];b[c][d]=e&&void 0!==e.clone?e.clone():e instanceof Array?e.slice():e}}return b}};
THREE.WebGLRenderTarget=function(a,b,c){this.width=a;this.height=b;c=c||{};this.wrapS=void 0!==c.wrapS?c.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==c.wrapT?c.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==c.magFilter?c.magFilter:THREE.LinearFilter;this.minFilter=void 0!==c.minFilter?c.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==c.anisotropy?c.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==c.format?c.format:
THREE.RGBAFormat;this.type=void 0!==c.type?c.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=void 0!==c.shareDepthFrom?c.shareDepthFrom:null};
THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,setSize:function(a,b){this.width=a;this.height=b},clone:function(){var a=new THREE.WebGLRenderTarget(this.width,this.height);a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.format=this.format;a.type=this.type;a.depthBuffer=this.depthBuffer;a.stencilBuffer=this.stencilBuffer;a.generateMipmaps=this.generateMipmaps;
a.shareDepthFrom=this.shareDepthFrom;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube=function(a,b,c){THREE.WebGLRenderTarget.call(this,a,b,c);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube.prototype.constructor=THREE.WebGLRenderTargetCube;
THREE.BoxBufferGeometry=function(a,b,c,d,e,f){function g(a,b,c,d,e,f,g,w,E,C){var p=f/E,q=g/C,u=f/2,r=g/2,t=w/2;g=E+1;var v=C+1;f=0;var x,z,B=new THREE.Vector3;for(z=0;z<v;z++){var O=z*q-r;for(x=0;x<g;x++)B[a]=(x*p-u)*d,B[b]=O*e,B[c]=t,k.push(B.x,B.y,B.z),B[a]=0,B[b]=0,B[c]=0<w?1:-1,m.push(B.x,B.y,B.z),l.push(x/E),l.push(1-z/C),f+=1}for(z=0;z<C;z++)for(x=0;x<E;x++)a=n+x+g*(z+1),b=n+(x+1)+g*(z+1),c=n+(x+1)+g*z,h.push(n+x+g*z,a,c),h.push(a,b,c);n+=f}THREE.BufferGeometry.call(this);this.parameters={width:a,
height:b,depth:c,widthSegments:d,heightSegments:e,depthSegments:f};d=Math.floor(d)||1;e=Math.floor(e)||1;f=Math.floor(f)||1;var h=[],k=[],m=[],l=[],n=0;g("z","y","x",-1,-1,c,b,a,f,e);g("z","y","x",1,-1,c,b,-a,f,e);g("x","z","y",1,1,a,c,b,d,f);g("x","z","y",1,-1,a,c,-b,d,f);g("x","y","z",1,-1,a,b,c,d,e);g("x","y","z",-1,-1,a,b,-c,d,e);console.assert(65536>=k.length);this.addAttribute("index",new THREE.BufferAttribute(new Uint16Array(h),1));this.addAttribute("position",new THREE.BufferAttribute(new Float32Array(k),
3));this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(m),3));this.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(l),2))};THREE.BoxBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.BoxBufferGeometry.prototype.constructor=THREE.BoxBufferGeometry;
THREE.SphereBufferGeometry=function(a,b,c,d,e,f,g){THREE.BufferGeometry.call(this);this.parameters={radius:a,widthSegments:b,heightSegments:c,phiStart:d,phiLength:e,thetaStart:f,thetaLength:g};a=a||50;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);d=void 0!==d?d:0;e=void 0!==e?e:2*Math.PI;f=void 0!==f?f:0;g=void 0!==g?g:Math.PI;var h=f+g,k,m,l=0,n=[],p=new THREE.Vector3,q=new THREE.Vector3,u=[],r=[],t=[],v=[];for(m=0;m<=c;m++){var x=[],w=m/c;for(k=0;k<=b;k++){var E=k/b;p.x=-a*Math.cos(d+
E*e)*Math.sin(f+w*g);p.y=a*Math.cos(f+w*g);p.z=a*Math.sin(d+E*e)*Math.sin(f+w*g);r.push(p.x,p.y,p.z);q.set(p.x,p.y,p.z).normalize();t.push(q.x,q.y,q.z);v.push(E,1-w);x.push(l++)}n.push(x)}for(m=0;m<c;m++)for(k=0;k<b;k++)a=n[m][k+1],d=n[m][k],e=n[m+1][k],g=n[m+1][k+1],(0!==m||0<f)&&u.push(a,d,g),(m!==c-1||h<Math.PI)&&u.push(d,e,g);console.assert(65536>=r.length);this.addAttribute("index",new THREE.BufferAttribute(new Uint16Array(u),1));this.addAttribute("position",new THREE.BufferAttribute(new Float32Array(r),
3));this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(t),3));this.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(v),2))};THREE.SphereBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.SphereBufferGeometry.prototype.constructor=THREE.SphereBufferGeometry;
THREE.PlaneBufferGeometry=function(a,b,c,d){THREE.BufferGeometry.call(this);this.type="PlaneBufferGeometry";this.parameters={width:a,height:b,widthSegments:c,heightSegments:d};var e=a/2,f=b/2;c=c||1;d=d||1;var g=c+1,h=d+1,k=a/c,m=b/d;b=new Float32Array(g*h*3);a=new Float32Array(g*h*3);for(var l=new Float32Array(g*h*2),n=0,p=0,q=0;q<h;q++)for(var u=q*m-f,r=0;r<g;r++)b[n]=r*k-e,b[n+1]=-u,a[n+2]=1,l[p]=r/c,l[p+1]=1-q/d,n+=3,p+=2;n=0;e=new (65535<b.length/3?Uint32Array:Uint16Array)(c*d*6);for(q=0;q<d;q++)for(r=
0;r<c;r++)f=r+g*(q+1),h=r+1+g*(q+1),k=r+1+g*q,e[n]=r+g*q,e[n+1]=f,e[n+2]=k,e[n+3]=f,e[n+4]=h,e[n+5]=k,n+=6;this.addAttribute("index",new THREE.BufferAttribute(e,1));this.addAttribute("position",new THREE.BufferAttribute(b,3));this.addAttribute("normal",new THREE.BufferAttribute(a,3));this.addAttribute("uv",new THREE.BufferAttribute(l,2))};THREE.PlaneBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.PlaneBufferGeometry.prototype.constructor=THREE.PlaneBufferGeometry;
THREE.CylinderBufferGeometry=function(a,b,c,d,e,f,g,h){function k(c){var e,f,k,u=new THREE.Vector2,t=new THREE.Vector3,y=!0===c?a:b,G=!0===c?1:-1;f=q;for(e=1;e<=d;e++)l.push(0,r*G,0),n.push(0,G,0),p.push(.5,.5),q++;k=q;for(e=0;e<=d;e++){var L=e/d*h+g,M=Math.cos(L),L=Math.sin(L);t.x=y*L;t.y=r*G;t.z=y*M;l.push(t.x,t.y,t.z);n.push(0,G,0);u.x=.5*M+.5;u.y=.5*L*G+.5;p.push(u.x,u.y);q++}for(e=0;e<d;e++)u=f+e,t=k+e,!0===c?m.push(t,t+1,u):m.push(t+1,t,u)}THREE.BufferGeometry.call(this);this.parameters={radiusTop:a,
radiusBottom:b,height:c,radialSegments:d,heightSegments:e,openEnded:f,thetaStart:g,thetaLength:h};a=void 0!==a?a:20;b=void 0!==b?b:20;c=void 0!==c?c:100;d=Math.floor(d)||8;e=Math.floor(e)||1;f=void 0!==f?f:!1;g=void 0!==g?g:0;h=void 0!==h?h:2*Math.PI;var m=[],l=[],n=[],p=[],q=0,u=[],r=c/2;(function(){var f,k,x=new THREE.Vector3,w=new THREE.Vector3,E=(b-a)/c;for(k=0;k<=e;k++){var C=[],y=k/e,G=y*(b-a)+a;for(f=0;f<=d;f++){var L=f/d,M=L*h+g,N=Math.sin(M),M=Math.cos(M);w.x=G*N;w.y=-y*c+r;w.z=G*M;l.push(w.x,
w.y,w.z);x.set(N,E,M).normalize();n.push(x.x,x.y,x.z);p.push(L,1-y);C.push(q++)}u.push(C)}for(f=0;f<d;f++)for(k=0;k<e;k++)x=u[k+1][f],w=u[k+1][f+1],E=u[k][f+1],m.push(u[k][f],x,E),m.push(x,w,E)})();!1===f&&(0<a&&k(!0),0<b&&k(!1));console.assert(65536>=l.length);this.addAttribute("index",new THREE.BufferAttribute(new Uint16Array(m),1));this.addAttribute("position",new THREE.BufferAttribute(new Float32Array(l),3));this.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(n),3));this.addAttribute("uv",
new THREE.BufferAttribute(new Float32Array(p),2))};THREE.CylinderBufferGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);THREE.CylinderBufferGeometry.prototype.constructor=THREE.CylinderBufferGeometry;(function(){window.WALK={DEBUG:!1,DEBUG_SHARED_BUFFERS:!1,LOG_INFO:!1,LOG_TO_SERVER:!1,LOG_TIME:!1,PROGRESSIVE_LOADER_AFTER_SEC:30,DYNAMIC_LIGHTS:!1,HEAD_LIGHT:!1,RETRIES_ON_LOAD_ERROR:3,DEFAULT_ANISOTROPY:4,NO_ANISOTROPY:1,FORCE_FXAA:!1,GAMMA_IN:2.2,GAMMA_OUT:1/2.2,CAMERA_NEAR:.01,CAMERA_MIN_FAR:100,SKY_DISTANCE_TO_SCENE:100,CAMERA_DEFAULT_FOV:70,CAMERA_DEFAULT_MOVE_MAX_SPEED:1.11,CAMERA_FULL_ACCELERATION_TIME:.5,CAMERA_FULL_DECELERATION_TIME:.166,AUTO_TOUR_IN_VIEW_STILL_TIME_MS:3E3,CLICK_MOVE_MIN_DISTANCE_TO_OBSTACLE:.7,
LIGHT_PROBE_MIRROR_SIZE:512,LIGHT_PROBE_MAX_MIP_SIZE:128,LIGHT_PROBE_MIN_MIP_SIZE:4,LIGHT_VISIBILITY_MAP_DOWNSAMPLE:2,LIGHT_DISTANCE_PROBE_SIZE:512,DEBUG_LIGHT_PROBE_MIPS:!1,EDITOR_SCREENSHOT_WIDTH:1920,EDITOR_SCREENSHOT_HEIGHT:1080,OBJECT_VISIBILITY_PROBE_SIZE:128,DEFAULT_SKY_NAME:"default",EDITOR_CONTROLLED_SKY_NAME:"sky0",EDITOR_SELECTION_COLOR:(new THREE.Color(5021401)).convertGammaToLinear(),LOAD_PRIORITY:{CORE_RESOURCE:0,COLORMAP:1,UV0:1,DIFFUSE:2,LIGHTMAP:3,SKY:4,SPECULARITY:5}};window.WebVRConfig=
{CARDBOARD_UI_DISABLED:!1,FORCE_ENABLE_VR:!1,K_FILTER:.98,ROTATE_INSTRUCTIONS_DISABLED:!1,PREDICTION_TIME_S:.04,TOUCH_PANNER_DISABLED:!0,YAW_ONLY:!1,MOUSE_KEYBOARD_CONTROLS_DISABLED:!0,DEFER_INITIALIZATION:!0,ENABLE_DEPRECATED_API:!1,BUFFER_SCALE:1,DIRTY_SUBMIT_FRAME_BINDINGS:!1,ALWAYS_APPEND_POLYFILL_DISPLAY:!1,GET_VR_DISPLAYS_TIMEOUT:1E3};window.$=function(a){return document.getElementById(a)}})();(function(){function a(b,d,e){return function(){b!==d.length&&(e(d[b]),WALK.defer(a(b+1,d,e)))}}var b=2*Math.PI;WALK.defer=function(a){setTimeout(a,0)};WALK.iterateAsync=function(b,d){WALK.defer(a(0,b,d))};WALK.iterate=function(a,b){var c;for(c=0;c<a.length;c+=1)b(a[c])};WALK.find=function(a,b){var c,d;for(c=0;c<a.length;c+=1)if(d=a[c],b(d))return d};WALK.filter=function(a,b){var c,d=a.length,g=[];for(c=0;c<d;c+=1)b(a[c])&&g.push(a[c]);return g};WALK.normalizeRotation=function(a){a%=b;return a>Math.PI?
-b+a:a<-Math.PI?b+a:a};WALK.setTextContent=function(a,b){void 0!==a.textContent?a.textContent=b:void 0!==a.innerText?a.innerText=b:console.warn("textContent and innerText properties are missing")};WALK.urlHashContains=function(a){var b=window.location.hash,c;if(b)for(b=b.substring(1),b=b.split("&"),c=0;c<b.length;c+=1)if(b[c]===a)return!0;return!1};WALK.getOriginFromUrl=function(a){var b=document.createElement("a");b.href=a;return b.protocol+"//"+b.host};WALK.log2=function(a){return Math.log(a)/Math.log(2)};
WALK.mipsCount=function(a,b){return WALK.log2(b)-WALK.log2(a)+1};WALK.isModifierPressed=function(a){return a.ctrlKey||a.altKey||a.metaKey}})();(function(){function a(a,b){return function(c){f.finished(a);b(c)}}function b(a){this.method=a;this.binaryResult=!1;this.dataContentType=this.data=null;"GET"===a?(this.retriesLeft=WALK.RETRIES_ON_LOAD_ERROR,this.retryDelay=.5+Math.random()):this.retryDelay=this.retriesLeft=0}function c(a,b,c,d,f){setTimeout(function(){e(a,b,c,d,f)},b.retryDelay);b.retryScheduled()}function d(a,b,c,e){var h=new Image;h.onload=function(){c(h);h=null};h.onerror=function(){var f=0<b.retriesLeft;console.warn("Failed to get image: "+
a+(f?", retrying in "+b.retryDelay+"s":""));f?(setTimeout(function(){d(a,b,c,e)},b.retryDelay),b.retryScheduled()):e();h=null};h.crossOrigin="anonymous";h.src=a}var e,f;f=new function(){var a=[],b=[],c=Infinity;(function(){var c,d=0;for(c in WALK.LOAD_PRIORITY)WALK.LOAD_PRIORITY.hasOwnProperty(c)&&(d=Math.max(d,WALK.LOAD_PRIORITY[c]));for(c=0;c<=d;c+=1)a[c]=[],b[c]=0})();this.add=function(d,e){d<=c?(b[d]+=1,c=d,WALK.defer(e)):a[d].push(e)};this.finished=function(d){var e;--b[d];e=b[d];console.assert(0<=
e);console.assert(d>=c);if(d===c&&0===e)for(c+=1;c<a.length;c+=1)if(e=a[c],0<e.length){for(d=0;d<e.length;d+=1)b[c]+=1,WALK.defer(e[d]);e.length=0;break}}};b.prototype={constructor:b,retryScheduled:function(){console.assert(0<this.retriesLeft);--this.retriesLeft;this.retryDelay*=2}};e=function(a,b,d,e,f){function h(){var h;h=g.status||0;h=500<=h||0===h?0!==b.retriesLeft:!1;console.warn("Failed to "+b.method+": "+a+" ("+g.status+")"+(h?", retrying in "+b.retryDelay+"s":""));h?c(a,b,d,e,f):void 0!==
e&&e(g.status);g=null}var g=new XMLHttpRequest;void 0!==f&&g.addEventListener("progress",f,!1);g.addEventListener("load",function(){200<=g.status&&300>g.status||0===g.status?(void 0!==d&&(b.binaryResult?d(g.response):d(JSON.parse(g.responseText))),g=null):h()},!1);g.addEventListener("error",h,!1);g.addEventListener("abort",h,!1);g.open(b.method,a,!0);b.binaryResult&&(g.responseType="arraybuffer");b.dataContentType&&g.setRequestHeader("Content-Type",b.dataContentType);"POST"===b.method&&g.setRequestHeader("X-Requested-By",
"Shapespark");g.send(b.data)};WALK.ajaxGet=function(a,c,d,f,l){var h=new b("GET");h.binaryResult=c;e(a,h,d,f,l)};WALK.queueAjaxGet=function(b,c,d,e,l,n){f.add(b,function(){WALK.ajaxGet(c,d,a(b,e),a(b,l),n)})};WALK.ajaxPost=function(a,c,d,f,l,n){var h=new b("POST");h.data=d;h.dataContentType=c;e(a,h,f,l,n)};WALK.queueImageGet=function(c,e,k,m){f.add(c,function(){var h=new b("GET");d(e,h,a(c,k),a(c,m))})}})();(function(){function a(a,b){for(var c=a.toString();c.length<b;)c="0"+c;return c}function b(b){var c=console[b].bind(console);console[b]=function(){var d="",f,g="";for(f=0;f<arguments.length;++f)g+=(0==f?"":" ")+arguments[f];WALK.LOG_TIME&&(d=new Date,d=a(d.getHours(),2)+":"+a(d.getMinutes(),2)+":"+a(d.getSeconds(),2)+","+a(d.getMilliseconds(),3)+" ");f=d+b.toUpperCase()+" "+g;WALK.LOG_TO_SERVER&&WALK.ajaxPost("/log","application/json",JSON.stringify({message:f}));c(d+g)}}WALK.urlHashContains("log")||
WALK.LOG_INFO?WALK.log=function(a){console.log(a)}:WALK.log=function(){};if(WALK.LOG_TO_SERVER||WALK.LOG_TIME)b("log"),b("info"),b("warn"),b("error")})();/*

 webvr-polyfill
 Copyright (c) 2015-2017 Google
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at

 http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 wglu-preserve-state.js
 Copyright (c) 2016, Brandon Jones.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
*/
(function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={i:d,l:!1,exports:{}};a[d].call(e.exports,e,e.exports,b);e.l=!0;return e.exports}var c={};b.m=a;b.c=c;b.i=function(a){return a};b.d=function(a,c,f){b.o(a,c)||Object.defineProperty(a,c,{configurable:!1,enumerable:!0,get:f})};b.n=function(a){var c=a&&a.__esModule?function(){return a["default"]}:function(){return a};b.d(c,"a",c);return c};b.o=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};b.p="";return b(b.s=14)})([function(a,
b){var c=window.Util||{};c.MIN_TIMESTEP=.001;c.MAX_TIMESTEP=1;c.base64=function(a,b){return"data:"+a+";base64,"+b};c.clamp=function(a,b,c){return Math.min(Math.max(b,a),c)};c.lerp=function(a,b,c){return a+(b-a)*c};c.race=function(a){return Promise.race?Promise.race(a):new Promise(function(b,c){for(var d=0;d<a.length;d++)a[d].then(b,c)})};c.isIOS=function(){var a=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return a}}();c.isWebViewAndroid=function(){var a=-1!==navigator.userAgent.indexOf("Version")&&
-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome");return function(){return a}}();c.isSafari=function(){var a=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return a}}();c.isFirefoxAndroid=function(){var a=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android");return function(){return a}}();c.isLandscapeMode=function(){return 90==window.orientation||-90==window.orientation};c.isTimestampDeltaValid=
function(a){return isNaN(a)||a<=c.MIN_TIMESTEP||a>c.MAX_TIMESTEP?!1:!0};c.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio};c.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio};c.requestFullscreen=function(a){if(c.isWebViewAndroid())return!1;if(a.requestFullscreen)a.requestFullscreen();else if(a.webkitRequestFullscreen)a.webkitRequestFullscreen();else if(a.mozRequestFullScreen)a.mozRequestFullScreen();
else if(a.msRequestFullscreen)a.msRequestFullscreen();else return!1;return!0};c.exitFullscreen=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0};c.getFullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||
document.msFullscreenElement};c.linkProgram=function(a,b,c,g){var d=a.createShader(a.VERTEX_SHADER);a.shaderSource(d,b);a.compileShader(d);b=a.createShader(a.FRAGMENT_SHADER);a.shaderSource(b,c);a.compileShader(b);c=a.createProgram();a.attachShader(c,d);a.attachShader(c,b);for(var e in g)a.bindAttribLocation(c,g[e],e);a.linkProgram(c);a.deleteShader(d);a.deleteShader(b);return c};c.getProgramUniforms=function(a,b){for(var c={},d=a.getProgramParameter(b,a.ACTIVE_UNIFORMS),e,k=0;k<d;k++)e=a.getActiveUniform(b,
k).name.replace("[0]",""),c[e]=a.getUniformLocation(b,e);return c};c.orthoMatrix=function(a,b,c,g,h,k,m){var d=1/(b-c),e=1/(g-h),f=1/(k-m);a[0]=-2*d;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=-2*e;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=2*f;a[11]=0;a[12]=(b+c)*d;a[13]=(h+g)*e;a[14]=(m+k)*f;a[15]=1;return a};c.copyArray=function(a,b){for(var c=0,d=a.length;c<d;c++)b[c]=a[c]};c.isMobile=function(){var a=!1,b=navigator.userAgent||navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||
/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,
4)))a=!0;return a};c.extend=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a};c.safariCssSizeWorkaround=function(a){if(c.isIOS()){var b=a.style.width,d=a.style.height;a.style.width=parseInt(b)+1+"px";a.style.height=parseInt(d)+"px";setTimeout(function(){a.style.width=b;a.style.height=d},100)}window.Util=c;window.canvas=a};c.isDebug=function(){return c.getQueryParameter("debug")};c.getQueryParameter=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?&]"+
a+"=([^&#]*)")).exec(location.search);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))};c.frameDataFromPose=function(){function a(a,d,e,f,p){var k=f?f.fieldOfView:null,m=p.depthNear;p=p.depthFar;var l=Math.tan(k?k.upDegrees*b:c),n=Math.tan(k?k.downDegrees*b:c),v=Math.tan(k?k.leftDegrees*b:c),k=Math.tan(k?k.rightDegrees*b:c),x=2/(v+k),w=2/(l+n);a[0]=x;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=w;a[6]=0;a[7]=0;a[8]=-((v-k)*x*.5);a[9]=(l-n)*w*.5;a[10]=p/(m-p);a[11]=-1;a[12]=0;a[13]=0;a[14]=p*m/(m-
p);a[15]=0;a=e.orientation||g;e=e.position||h;n=a[0];x=a[1];w=a[2];p=a[3];var E=n+n,k=x+x,l=w+w;a=n*E;m=n*k;n*=l;v=x*k;x*=l;w*=l;E*=p;k*=p;p*=l;d[0]=1-(v+w);d[1]=m+p;d[2]=n-k;d[3]=0;d[4]=m-p;d[5]=1-(a+w);d[6]=x+E;d[7]=0;d[8]=n+k;d[9]=x-E;d[10]=1-(a+v);d[11]=0;d[12]=e[0];d[13]=e[1];d[14]=e[2];d[15]=1;if(f){a=f.offset;f=a[0];e=a[1];a=a[2];var C,y,G;d===d?(d[12]=d[0]*f+d[4]*e+d[8]*a+d[12],d[13]=d[1]*f+d[5]*e+d[9]*a+d[13],d[14]=d[2]*f+d[6]*e+d[10]*a+d[14],d[15]=d[3]*f+d[7]*e+d[11]*a+d[15]):(m=d[0],p=
d[1],l=d[2],n=d[3],v=d[4],k=d[5],x=d[6],w=d[7],E=d[8],C=d[9],y=d[10],G=d[11],d[0]=m,d[1]=p,d[2]=l,d[3]=n,d[4]=v,d[5]=k,d[6]=x,d[7]=w,d[8]=E,d[9]=C,d[10]=y,d[11]=G,d[12]=m*f+v*e+E*a+d[12],d[13]=p*f+k*e+C*a+d[13],d[14]=l*f+x*e+y*a+d[14],d[15]=n*f+w*e+G*a+d[15])}f=d[0];e=d[1];a=d[2];m=d[3];p=d[4];l=d[5];n=d[6];v=d[7];k=d[8];x=d[9];w=d[10];E=d[11];C=d[12];y=d[13];G=d[14];var L=d[15],M=f*l-e*p,N=f*n-a*p,D=f*v-m*p,J=e*n-a*l,z=e*v-m*l,B=a*v-m*n,O=k*y-x*C,P=k*G-w*C,F=k*L-E*C,H=x*G-w*y,I=x*L-E*y,A=w*L-E*G,
K=M*A-N*I+D*H+J*F-z*P+B*O;K&&(K=1/K,d[0]=(l*A-n*I+v*H)*K,d[1]=(a*I-e*A-m*H)*K,d[2]=(y*B-G*z+L*J)*K,d[3]=(w*z-x*B-E*J)*K,d[4]=(n*F-p*A-v*P)*K,d[5]=(f*A-a*F+m*P)*K,d[6]=(G*D-C*B-L*N)*K,d[7]=(k*B-w*D+E*N)*K,d[8]=(p*I-l*F+v*O)*K,d[9]=(e*F-f*I-m*O)*K,d[10]=(C*z-y*D+L*M)*K,d[11]=(x*D-k*z-E*M)*K,d[12]=(l*P-p*H-n*O)*K,d[13]=(f*H-e*P+a*O)*K,d[14]=(y*N-C*J-G*M)*K,d[15]=(k*J-x*N+w*M)*K)}var b=Math.PI/180,c=.25*Math.PI,g=new Float32Array([0,0,0,1]),h=new Float32Array([0,0,0]);return function(b,c,d){if(!b||!c)return!1;
b.pose=c;b.timestamp=c.timestamp;a(b.leftProjectionMatrix,b.leftViewMatrix,c,d.getEyeParameters("left"),d);a(b.rightProjectionMatrix,b.rightViewMatrix,c,d.getEyeParameters("right"),d);return!0}}();c.isInsideCrossDomainIFrame=function(){var a=window.self!==window.top,b=c.getDomainFromUrl(document.referrer),f=c.getDomainFromUrl(window.location.href);return a&&b!==f};c.getDomainFromUrl=function(a){a=-1<a.indexOf("://")?a.split("/")[2]:a.split("/")[0];return a=a.split(":")[0]};a.exports=c},function(a,
b,c){function d(){this.isPolyfilled=!0;this.displayId=m++;this.displayName="webvr-polyfill displayName";this.depthNear=.01;this.depthFar=1E4;this.isConnected=!0;this.isPresenting=!1;this.capabilities={hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1};this.stageParameters=null;this.waitingForPresent_=!1;this.fullscreenErrorHandler_=this.fullscreenChangeHandler_=this.fullscreenEventTarget_=this.fullscreenElementCachedStyle_=this.fullscreenWrapper_=this.fullscreenElement_=
this.layer_=null;this.wakelock_=new k}function e(){this.isPolyfilled=!0;this.hardwareUnitId="webvr-polyfill hardwareUnitId";this.deviceId="webvr-polyfill deviceId";this.deviceName="webvr-polyfill deviceName"}function f(){}function g(){}var h=c(0),k=c(23),m=1E3,l=!1,n=[0,0,.5,1],p=[.5,0,.5,1];d.prototype.getFrameData=function(a){return h.frameDataFromPose(a,this.getPose(),this)};d.prototype.getPose=function(){return this.getImmediatePose()};d.prototype.requestAnimationFrame=function(a){return window.requestAnimationFrame(a)};
d.prototype.cancelAnimationFrame=function(a){return window.cancelAnimationFrame(a)};d.prototype.wrapForFullscreen=function(a){if(h.isIOS())return a;this.fullscreenWrapper_||(this.fullscreenWrapper_=document.createElement("div"),this.fullscreenWrapper_.setAttribute("style",["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important; left: 0 !important; right: 0 !important; border: 0; margin: 0; padding: 0; z-index: 999999 !important; position: fixed"].join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper"));
if(this.fullscreenElement_==a)return this.fullscreenWrapper_;this.removeFullscreenWrapper();this.fullscreenElement_=a;a=this.fullscreenElement_.parentElement;a.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_);a.removeChild(this.fullscreenElement_);this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild);this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");this.fullscreenElement_&&this.fullscreenElement_.setAttribute("style",
["position: absolute; top: 0; left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0; margin: 0; padding: 0"].join("; ")+";");return this.fullscreenWrapper_};d.prototype.removeFullscreenWrapper=function(){if(this.fullscreenElement_){var a=this.fullscreenElement_;this.fullscreenElementCachedStyle_?a.setAttribute("style",this.fullscreenElementCachedStyle_):a.removeAttribute("style");this.fullscreenElementCachedStyle_=this.fullscreenElement_=
null;var b=this.fullscreenWrapper_.parentElement;this.fullscreenWrapper_.removeChild(a);b.insertBefore(a,this.fullscreenWrapper_);b.removeChild(this.fullscreenWrapper_);return a}};d.prototype.requestPresent=function(a){var b=this.isPresenting,c=this;a instanceof Array||(l||(console.warn("Using a deprecated form of requestPresent. Should pass in an array of VRLayers."),l=!0),a=[a]);return new Promise(function(d,e){if(c.capabilities.canPresent)if(0==a.length||a.length>c.capabilities.maxLayers)e(Error("Invalid number of layers."));
else{var f=a[0];if(f.source){var g=f.leftBounds||n,k=f.rightBounds||p;if(b){var m=c.layer_;m.source!==f.source&&(m.source=f.source);for(f=0;4>f;f++)m.leftBounds[f]=g[f],m.rightBounds[f]=k[f];d()}else{c.layer_={predistorted:f.predistorted,source:f.source,leftBounds:g.slice(0),rightBounds:k.slice(0)};c.waitingForPresent_=!1;if(c.layer_&&c.layer_.source){var l=c.wrapForFullscreen(c.layer_.source);c.addFullscreenListeners_(l,function(){var a=h.getFullscreenElement();c.isPresenting=l===a;c.isPresenting?
(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary")["catch"](function(a){console.error("screen.orientation.lock() failed due to",a.message)}),c.waitingForPresent_=!1,c.beginPresent_(),d()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),c.removeFullscreenWrapper(),c.wakelock_.release(),c.endPresent_(),c.removeFullscreenListeners_());c.fireVRDisplayPresentChange_()},function(){c.waitingForPresent_&&(c.removeFullscreenWrapper(),c.removeFullscreenListeners_(),
c.wakelock_.release(),c.waitingForPresent_=!1,c.isPresenting=!1,e(Error("Unable to present.")))});if(h.requestFullscreen(l))c.wakelock_.request(),c.waitingForPresent_=!0;else if(h.isIOS()||h.isWebViewAndroid())c.wakelock_.request(),c.isPresenting=!0,c.beginPresent_(),c.fireVRDisplayPresentChange_(),d()}c.waitingForPresent_||h.isIOS()||(h.exitFullscreen(),e(Error("Unable to present.")))}}else d()}else e(Error("VRDisplay is not capable of presenting."))})};d.prototype.exitPresent=function(){var a=this.isPresenting,
b=this;this.isPresenting=!1;this.layer_=null;this.wakelock_.release();return new Promise(function(c,d){a?(!h.exitFullscreen()&&h.isIOS()&&(b.endPresent_(),b.fireVRDisplayPresentChange_()),h.isWebViewAndroid()&&(b.removeFullscreenWrapper(),b.removeFullscreenListeners_(),b.endPresent_(),b.fireVRDisplayPresentChange_()),c()):d(Error("Was not presenting to VRDisplay."))})};d.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]};d.prototype.fireVRDisplayPresentChange_=function(){var a=new CustomEvent("vrdisplaypresentchange",
{detail:{display:this}});window.dispatchEvent(a)};d.prototype.fireVRDisplayConnect_=function(){var a=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(a)};d.prototype.addFullscreenListeners_=function(a,b,c){this.removeFullscreenListeners_();this.fullscreenEventTarget_=a;this.fullscreenChangeHandler_=b;this.fullscreenErrorHandler_=c;b&&(document.fullscreenEnabled?a.addEventListener("fullscreenchange",b,!1):document.webkitFullscreenEnabled?a.addEventListener("webkitfullscreenchange",
b,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",b,!1):document.msFullscreenEnabled&&a.addEventListener("msfullscreenchange",b,!1));c&&(document.fullscreenEnabled?a.addEventListener("fullscreenerror",c,!1):document.webkitFullscreenEnabled?a.addEventListener("webkitfullscreenerror",c,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",c,!1):document.msFullscreenEnabled&&a.addEventListener("msfullscreenerror",c,!1))};d.prototype.removeFullscreenListeners_=
function(){if(this.fullscreenEventTarget_){var a=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var b=this.fullscreenChangeHandler_;a.removeEventListener("fullscreenchange",b,!1);a.removeEventListener("webkitfullscreenchange",b,!1);document.removeEventListener("mozfullscreenchange",b,!1);a.removeEventListener("msfullscreenchange",b,!1)}this.fullscreenErrorHandler_&&(b=this.fullscreenErrorHandler_,a.removeEventListener("fullscreenerror",b,!1),a.removeEventListener("webkitfullscreenerror",
b,!1),document.removeEventListener("mozfullscreenerror",b,!1),a.removeEventListener("msfullscreenerror",b,!1));this.fullscreenErrorHandler_=this.fullscreenChangeHandler_=this.fullscreenEventTarget_=null}};d.prototype.beginPresent_=function(){};d.prototype.endPresent_=function(){};d.prototype.submitFrame=function(a){};d.prototype.getEyeParameters=function(a){return null};f.prototype=new e;g.prototype=new e;a.exports.VRFrameData=function(){this.leftProjectionMatrix=new Float32Array(16);this.leftViewMatrix=
new Float32Array(16);this.rightProjectionMatrix=new Float32Array(16);this.rightViewMatrix=new Float32Array(16);this.pose=null};a.exports.VRDisplay=d;a.exports.VRDevice=e;a.exports.HMDVRDevice=f;a.exports.PositionSensorVRDevice=g},function(a,b){var c=window.MathUtil||{};c.degToRad=Math.PI/180;c.radToDeg=180/Math.PI;c.Vector2=function(a,b){this.x=a||0;this.y=b||0};c.Vector2.prototype={constructor:c.Vector2,set:function(a,b){this.x=a;this.y=b;return this},copy:function(a){this.x=a.x;this.y=a.y;return this},
subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this}};c.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};c.Vector3.prototype={constructor:c.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var a=this.length();0!==a?this.multiplyScalar(1/a):this.z=this.y=this.x=0;return this},multiplyScalar:function(a){this.x*=
a;this.y*=a;this.z*=a},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,h=a.x,k=a.y,m=a.z;a=a.w;var l=a*b+k*d-m*c,n=a*c+m*b-h*d,p=a*d+h*c-k*b,b=-h*b-k*c-m*d;this.x=l*a+b*-h+n*-m-p*-k;this.y=n*a+b*-k+p*-h-l*-m;this.z=p*a+b*-m+l*-k-n*-h;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,k=b.x,m=b.y,l=b.z;this.x=d*l-e*m;this.y=e*k-c*l;this.z=c*m-d*k;return this}};c.Quaternion=function(a,b,c,g){this.x=a||0;this.y=b||0;this.z=
c||0;this.w=void 0!==g?g:1};c.Quaternion.prototype={constructor:c.Quaternion,set:function(a,b,c,g){this.x=a;this.y=b;this.z=c;this.w=g;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},setFromEulerXYZ:function(a,b,c){var d=Math.cos(a/2),h=Math.cos(b/2),e=Math.cos(c/2);a=Math.sin(a/2);b=Math.sin(b/2);c=Math.sin(c/2);this.x=a*h*e+d*b*c;this.y=d*b*e-a*h*c;this.z=d*h*c+a*b*e;this.w=d*h*e-a*b*c;return this},setFromEulerYXZ:function(a,b,c){var d=Math.cos(a/2),h=Math.cos(b/
2),e=Math.cos(c/2);a=Math.sin(a/2);b=Math.sin(b/2);c=Math.sin(c/2);this.x=a*h*e+d*b*c;this.y=d*b*e-a*h*c;this.z=d*h*c-a*b*e;this.w=d*h*e+a*b*c;return this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);this.x=a.x*d;this.y=a.y*d;this.z=a.z*d;this.w=Math.cos(c);return this},multiply:function(a){return this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a.x,d=a.y,h=a.z,e=a.w,m=b.x,l=b.y,n=b.z,p=b.w;this.x=c*p+e*m+d*n-h*l;this.y=d*p+e*l+h*m-c*n;this.z=h*p+e*n+c*l-d*m;this.w=
e*p-c*m-d*l-h*n;return this},inverse:function(){this.x*=-1;this.y*=-1;this.z*=-1;this.normalize();return this},normalize:function(){var a=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);0===a?(this.z=this.y=this.x=0,this.w=1):(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a);return this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this.x,d=this.y,h=this.z,e=this.w,m=e*a.w+c*a.x+d*a.y+h*a.z;0>m?(this.w=-a.w,this.x=-a.x,this.y=-a.y,this.z=-a.z,m=-m):
this.copy(a);if(1<=m)return this.w=e,this.x=c,this.y=d,this.z=h,this;var l=Math.acos(m),n=Math.sqrt(1-m*m);if(.001>Math.abs(n))return this.w=.5*(e+this.w),this.x=.5*(c+this.x),this.y=.5*(d+this.y),this.z=.5*(h+this.z),this;m=Math.sin((1-b)*l)/n;l=Math.sin(b*l)/n;this.w=e*m+this.w*l;this.x=c*m+this.x*l;this.y=d*m+this.y*l;this.z=h*m+this.z*l;return this},setFromUnitVectors:function(){var a,b;return function(d,e){void 0===a&&(a=new c.Vector3);b=d.dot(e)+1;1E-6>b?(b=0,Math.abs(d.x)>Math.abs(d.z)?a.set(-d.y,
d.x,0):a.set(0,-d.z,d.y)):a.crossVectors(d,e);this.x=a.x;this.y=a.y;this.z=a.z;this.w=b;this.normalize();return this}}()};a.exports=c},function(a,b,c){function d(a){this.gl=a;this.attribs={position:0};this.program=e.linkProgram(a,"attribute vec2 position;\nuniform mat4 projectionMat;\nvoid main() {\n  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );\n}","precision mediump float;\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}",this.attribs);this.uniforms=e.getProgramUniforms(a,
this.program);this.vertexBuffer=a.createBuffer();this.arrowVertexCount=this.arrowOffset=this.gearVertexCount=this.gearOffset=0;this.projMat=new Float32Array(16);this.listener=null;this.onResize()}var e=c(0),f=c(4),g=Math.PI/180;d.prototype.destroy=function(){var a=this.gl;this.listener&&a.canvas.removeEventListener("click",this.listener,!1);a.deleteProgram(this.program);a.deleteBuffer(this.vertexBuffer)};d.prototype.listen=function(a,b){var c=this.gl.canvas;this.listener=function(d){var e=c.clientWidth/
2,h=d.touches?d.touches[0].clientX:d.clientX,f=d.touches?d.touches[0].clientY:d.clientY;h>e-42&&h<e+42&&f>c.clientHeight-42?a(d):42>h&&42>f&&b(d)};c.addEventListener("click",this.listener,!1);c.addEventListener("touchstart",this.listener,!1)};d.prototype.onResize=function(){var a=this.gl,b=this;f(a,[a.ARRAY_BUFFER_BINDING],function(a){function c(a,b){var c=(90-a)*g,d=Math.cos(c),c=Math.sin(c);e.push(.3125*d*v+h,.3125*c*v+v);e.push(b*d*v+h,b*c*v+v)}function d(b,c){e.push(x+b,a.drawingBufferHeight-
x-c)}var e=[],h=a.drawingBufferWidth/2,f=a.drawingBufferWidth/(Math.max(screen.width,screen.height)*window.devicePixelRatio)*window.devicePixelRatio,k=4*f/2,m=42*f,v=28*f/2,x=14*f;e.push(h-k,m);e.push(h-k,a.drawingBufferHeight);e.push(h+k,m);e.push(h+k,a.drawingBufferHeight);b.gearOffset=e.length/2;for(m=0;6>=m;m++){var w=60*m;c(w,1);c(w+12,1);c(w+20,.75);c(w+40,.75);c(w+48,1)}b.gearVertexCount=e.length/2-b.gearOffset;b.arrowOffset=e.length/2;m=k/Math.sin(45*g);d(0,v);d(v,0);d(v+m,m);d(m,v+m);d(m,
v-m);d(0,v);d(v,2*v);d(v+m,2*v-m);d(m,v-m);d(0,v);d(m,v-k);d(28*f,v-k);d(m,v+k);d(28*f,v+k);b.arrowVertexCount=e.length/2-b.arrowOffset;a.bindBuffer(a.ARRAY_BUFFER,b.vertexBuffer);a.bufferData(a.ARRAY_BUFFER,new Float32Array(e),a.STATIC_DRAW)})};d.prototype.render=function(){var a=this.gl,b=this;f(a,[a.CULL_FACE,a.DEPTH_TEST,a.BLEND,a.SCISSOR_TEST,a.STENCIL_TEST,a.COLOR_WRITEMASK,a.VIEWPORT,a.CURRENT_PROGRAM,a.ARRAY_BUFFER_BINDING],function(a){a.disable(a.CULL_FACE);a.disable(a.DEPTH_TEST);a.disable(a.BLEND);
a.disable(a.SCISSOR_TEST);a.disable(a.STENCIL_TEST);a.colorMask(!0,!0,!0,!0);a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight);b.renderNoState()})};d.prototype.renderNoState=function(){var a=this.gl;a.useProgram(this.program);a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer);a.enableVertexAttribArray(this.attribs.position);a.vertexAttribPointer(this.attribs.position,2,a.FLOAT,!1,8,0);a.uniform4f(this.uniforms.color,1,1,1,1);e.orthoMatrix(this.projMat,0,a.drawingBufferWidth,0,a.drawingBufferHeight,
.1,1024);a.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat);a.drawArrays(a.TRIANGLE_STRIP,0,4);a.drawArrays(a.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount);a.drawArrays(a.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};a.exports=d},function(a,b){a.exports=function(a,b,e){if(b){for(var c=[],d=null,h=0;h<b.length;++h){var k=b[h];switch(k){case a.TEXTURE_BINDING_2D:case a.TEXTURE_BINDING_CUBE_MAP:var m=b[++h];if(m<a.TEXTURE0||m>a.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit");
c.push(null,null);break}d||(d=a.getParameter(a.ACTIVE_TEXTURE));a.activeTexture(m);c.push(a.getParameter(k),null);break;case a.ACTIVE_TEXTURE:d=a.getParameter(a.ACTIVE_TEXTURE);c.push(null);break;default:c.push(a.getParameter(k))}}e(a);for(h=0;h<b.length;++h){k=b[h];e=c[h];switch(k){case a.ACTIVE_TEXTURE:break;case a.ARRAY_BUFFER_BINDING:a.bindBuffer(a.ARRAY_BUFFER,e);break;case a.COLOR_CLEAR_VALUE:a.clearColor(e[0],e[1],e[2],e[3]);break;case a.COLOR_WRITEMASK:a.colorMask(e[0],e[1],e[2],e[3]);break;
case a.CURRENT_PROGRAM:a.useProgram(e);break;case a.ELEMENT_ARRAY_BUFFER_BINDING:a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,e);break;case a.FRAMEBUFFER_BINDING:a.bindFramebuffer(a.FRAMEBUFFER,e);break;case a.RENDERBUFFER_BINDING:a.bindRenderbuffer(a.RENDERBUFFER,e);break;case a.TEXTURE_BINDING_2D:m=b[++h];if(m<a.TEXTURE0||m>a.TEXTURE31)break;a.activeTexture(m);a.bindTexture(a.TEXTURE_2D,e);break;case a.TEXTURE_BINDING_CUBE_MAP:m=b[++h];if(m<a.TEXTURE0||m>a.TEXTURE31)break;a.activeTexture(m);a.bindTexture(a.TEXTURE_CUBE_MAP,
e);break;case a.VIEWPORT:a.viewport(e[0],e[1],e[2],e[3]);break;case a.BLEND:case a.CULL_FACE:case a.DEPTH_TEST:case a.SCISSOR_TEST:case a.STENCIL_TEST:e?a.enable(k):a.disable(k);break;default:console.log("No GL restore behavior for 0x"+k.toString(16))}d&&a.activeTexture(d)}}else e(a)}},function(a,b,c){function d(a){this.width=a.width||k.getScreenWidth();this.height=a.height||k.getScreenHeight();this.widthMeters=a.widthMeters;this.heightMeters=a.heightMeters;this.bevelMeters=a.bevelMeters}function e(a){this.viewer=
n.CardboardV2;this.updateDeviceParams(a);this.distortion=new g(this.viewer.distortionCoefficients)}function f(a){this.id=a.id;this.label=a.label;this.fov=a.fov;this.interLensDistance=a.interLensDistance;this.baselineLensDistance=a.baselineLensDistance;this.screenLensDistance=a.screenLensDistance;this.distortionCoefficients=a.distortionCoefficients;this.inverseCoefficients=a.inverseCoefficients}var g=c(11),h=c(2),k=c(0),m=new d({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),l=new d({widthMeters:.1038,
heightMeters:.0584,bevelMeters:.004}),n={CardboardV1:new f({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new f({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,
distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-9.904169E-4,6.183535E-5,-1.6981803E-6]})};e.prototype.updateDeviceParams=function(a){this.device=this.determineDevice_(a)||this.device};e.prototype.getDevice=function(){return this.device};e.prototype.setViewer=function(a){this.viewer=a;this.distortion=new g(this.viewer.distortionCoefficients)};e.prototype.determineDevice_=function(a){if(!a){if(k.isIOS())return console.warn("Using fallback iOS device measurements."),
l;console.warn("Using fallback Android device measurements.");return m}var b=.0254/a.xdpi,c=.0254/a.ydpi,e=k.getScreenWidth(),h=k.getScreenHeight();return new d({widthMeters:b*e,heightMeters:c*h,bevelMeters:.001*a.bevelMm})};e.prototype.getDistortedFieldOfViewLeftEye=function(){var a=this.viewer,b=this.device,c=this.distortion,d=a.screenLensDistance,e=a.interLensDistance/2,f=a.baselineLensDistance-b.bevelMeters,g=b.heightMeters-f,b=h.radToDeg*Math.atan(c.distort((b.widthMeters-a.interLensDistance)/
2/d)),e=h.radToDeg*Math.atan(c.distort(e/d)),f=h.radToDeg*Math.atan(c.distort(f/d)),c=h.radToDeg*Math.atan(c.distort(g/d));return{leftDegrees:Math.min(b,a.fov),rightDegrees:Math.min(e,a.fov),downDegrees:Math.min(f,a.fov),upDegrees:Math.min(c,a.fov)}};e.prototype.getLeftEyeVisibleTanAngles=function(){var a=this.viewer,b=this.device,c=this.distortion,d=Math.tan(-h.degToRad*a.fov),e=Math.tan(h.degToRad*a.fov),f=Math.tan(h.degToRad*a.fov),g=Math.tan(-h.degToRad*a.fov),k=b.widthMeters/4,m=b.heightMeters/
2,l=a.interLensDistance/2-k,n=-(a.baselineLensDistance-b.bevelMeters-m),G=a.screenLensDistance,a=c.distort((l-k)/G),b=c.distort((n+m)/G),k=c.distort((l+k)/G),c=c.distort((n-m)/G),m=new Float32Array(4);m[0]=Math.max(d,a);m[1]=Math.min(e,b);m[2]=Math.min(f,k);m[3]=Math.max(g,c);return m};e.prototype.getLeftEyeNoLensTanAngles=function(){var a=this.viewer,b=this.device,c=this.distortion,d=new Float32Array(4),e=c.distortInverse(Math.tan(-h.degToRad*a.fov)),f=c.distortInverse(Math.tan(h.degToRad*a.fov)),
g=c.distortInverse(Math.tan(h.degToRad*a.fov)),c=c.distortInverse(Math.tan(-h.degToRad*a.fov)),k=b.widthMeters/4,m=b.heightMeters/2,l=a.interLensDistance/2-k,b=-(a.baselineLensDistance-b.bevelMeters-m),a=a.screenLensDistance;d[0]=Math.max(e,(l-k)/a);d[1]=Math.min(f,(b+m)/a);d[2]=Math.min(g,(l+k)/a);d[3]=Math.max(c,(b-m)/a);return d};e.prototype.getLeftEyeVisibleScreenRect=function(a){var b=this.viewer,c=this.device,d=b.screenLensDistance,e=(c.widthMeters-b.interLensDistance)/2,b=b.baselineLensDistance-
c.bevelMeters,h=(a[0]*d+e)/c.widthMeters,f=(a[3]*d+b)/c.heightMeters;return{x:h,y:f,width:(a[2]*d+e)/c.widthMeters-h,height:(a[1]*d+b)/c.heightMeters-f}};e.prototype.getFieldOfViewLeftEye=function(a){return a?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()};e.prototype.getFieldOfViewRightEye=function(a){a=this.getFieldOfViewLeftEye(a);return{leftDegrees:a.rightDegrees,rightDegrees:a.leftDegrees,upDegrees:a.upDegrees,downDegrees:a.downDegrees}};e.prototype.getUndistortedFieldOfViewLeftEye=
function(){var a=this.getUndistortedParams_();return{leftDegrees:h.radToDeg*Math.atan(a.outerDist),rightDegrees:h.radToDeg*Math.atan(a.innerDist),downDegrees:h.radToDeg*Math.atan(a.bottomDist),upDegrees:h.radToDeg*Math.atan(a.topDist)}};e.prototype.getUndistortedViewportLeftEye=function(){var a=this.getUndistortedParams_(),b=this.device,c=this.viewer.screenLensDistance,d=b.width/(b.widthMeters/c),b=b.height/(b.heightMeters/c),c=Math.round((a.eyePosX-a.outerDist)*d),e=Math.round((a.eyePosY-a.bottomDist)*
b);return{x:c,y:e,width:Math.round((a.eyePosX+a.innerDist)*d)-c,height:Math.round((a.eyePosY+a.topDist)*b)-e}};e.prototype.getUndistortedParams_=function(){var a=this.viewer,b=this.device,c=a.screenLensDistance,d=a.interLensDistance/2/c,e=b.heightMeters/c,f=b.widthMeters/c/2-d,b=(a.baselineLensDistance-b.bevelMeters)/c,a=this.distortion.distortInverse(Math.tan(h.degToRad*a.fov));return{outerDist:Math.min(f,a),innerDist:Math.min(d,a),topDist:Math.min(e-b,a),bottomDist:Math.min(b,a),eyePosX:f,eyePosY:b}};
e.Viewers=n;a.exports=e},function(a,b,c){function d(a){this.display=a;this.hardwareUnitId=a.displayId;this.deviceId="webvr-polyfill:HMD:"+a.displayId;this.deviceName=a.displayName+" (HMD)"}function e(a){this.display=a;this.hardwareUnitId=a.displayId;this.deviceId="webvr-polyfill:PositionSensor: "+a.displayId;this.deviceName=a.displayName+" (PositionSensor)"}c(1);b=c(1).HMDVRDevice;c=c(1).PositionSensorVRDevice;d.prototype=new b;d.prototype.getEyeParameters=function(a){var b=this.display.getEyeParameters(a);
return{currentFieldOfView:b.fieldOfView,maximumFieldOfView:b.fieldOfView,minimumFieldOfView:b.fieldOfView,recommendedFieldOfView:b.fieldOfView,eyeTranslation:{x:b.offset[0],y:b.offset[1],z:b.offset[2]},renderRect:{x:"right"==a?b.renderWidth:0,y:0,width:b.renderWidth,height:b.renderHeight}}};d.prototype.setFieldOfView=function(a,b,c,d){};e.prototype=new c;e.prototype.getState=function(){var a=this.display.getPose();return{position:a.position?{x:a.position[0],y:a.position[1],z:a.position[2]}:null,orientation:a.orientation?
{x:a.orientation[0],y:a.orientation[1],z:a.orientation[2],w:a.orientation[3]}:null,linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}};e.prototype.resetState=function(){return this.positionDevice.resetPose()};a.exports.VRDisplayHMDDevice=d;a.exports.VRDisplayPositionSensorDevice=e},function(a,b,c){function d(){this.displays=[];this.devices=[];this.devicesPopulated=!1;this.nativeWebVRAvailable=this.isWebVRAvailable();this.nativeLegacyWebVRAvailable=this.isDeprecatedWebVRAvailable();
this.nativeGetVRDisplaysFunc=this.nativeWebVRAvailable?navigator.getVRDisplays:null;this.nativeLegacyWebVRAvailable||(this.enablePolyfill(),window.WebVRConfig.ENABLE_DEPRECATED_API&&this.enableDeprecatedPolyfill());e()}function e(){"VRDisplay"in window&&!("VRFrameData"in window)&&(window.VRFrameData=m,"depthNear"in window.VRDisplay.prototype||(window.VRDisplay.prototype.depthNear=.01),"depthFar"in window.VRDisplay.prototype||(window.VRDisplay.prototype.depthFar=1E4),window.VRDisplay.prototype.getFrameData=
function(a){return f.frameDataFromPose(a,this.getPose(),this)})}var f=c(0),g=c(10),h=c(15),k=c(1).VRDisplay,m=c(1).VRFrameData,l=c(1).HMDVRDevice,n=c(1).PositionSensorVRDevice,p=c(6).VRDisplayHMDDevice,q=c(6).VRDisplayPositionSensorDevice;b=c(8).version;d.prototype.isWebVRAvailable=function(){return"getVRDisplays"in navigator};d.prototype.isDeprecatedWebVRAvailable=function(){return"getVRDevices"in navigator||"mozGetVRDevices"in navigator};d.prototype.connectDisplay=function(a){a.fireVRDisplayConnect_();
this.displays.push(a)};d.prototype.populateDevices=function(){if(!this.devicesPopulated){var a;this.isCardboardCompatible()&&(a=new g,this.connectDisplay(a),window.WebVRConfig.ENABLE_DEPRECATED_API&&(this.devices.push(new p(a)),this.devices.push(new q(a))));this.isMobile()||window.WebVRConfig.MOUSE_KEYBOARD_CONTROLS_DISABLED||(a=new h,this.connectDisplay(a),window.WebVRConfig.ENABLE_DEPRECATED_API&&(this.devices.push(new p(a)),this.devices.push(new q(a))));this.devicesPopulated=!0}};d.prototype.enablePolyfill=
function(){navigator.getVRDisplays=this.getVRDisplays.bind(this);if(this.nativeWebVRAvailable&&window.VRFrameData){var a=window.VRFrameData,b=new window.VRFrameData,c=window.VRDisplay.prototype.getFrameData;window.VRFrameData=m;window.VRDisplay.prototype.getFrameData=function(d){d instanceof a?c.call(this,d):(c.call(this,b),d.pose=b.pose,f.copyArray(b.leftProjectionMatrix,d.leftProjectionMatrix),f.copyArray(b.rightProjectionMatrix,d.rightProjectionMatrix),f.copyArray(b.leftViewMatrix,d.leftViewMatrix),
f.copyArray(b.rightViewMatrix,d.rightViewMatrix))}}window.VRDisplay=k;if(navigator&&!navigator.vrEnabled){var d=this;Object.defineProperty(navigator,"vrEnabled",{get:function(){return d.isCardboardCompatible()&&(d.isFullScreenAvailable()||f.isIOS())}})}"VRFrameData"in window||(window.VRFrameData=m)};d.prototype.enableDeprecatedPolyfill=function(){navigator.getVRDevices=this.getVRDevices.bind(this);window.HMDVRDevice=l;window.PositionSensorVRDevice=n};d.prototype.getVRDisplays=function(){this.populateDevices();
var a=this.displays;if(!this.nativeWebVRAvailable)return Promise.resolve(a);var b,c=this.nativeGetVRDisplaysFunc.call(navigator),d=new Promise(function(a){b=setTimeout(function(){console.warn("Native WebVR implementation detected, but `getVRDisplays()` failed to resolve. Falling back to polyfill.");a([])},window.WebVRConfig.GET_VR_DISPLAYS_TIMEOUT)});return f.race([c,d]).then(function(c){clearTimeout(b);return window.WebVRConfig.ALWAYS_APPEND_POLYFILL_DISPLAY?c.concat(a):0<c.length?c:a})};d.prototype.getVRDevices=
function(){console.warn("getVRDevices is deprecated. Please update your code to use getVRDisplays instead.");var a=this;return new Promise(function(b,c){try{if(!a.devicesPopulated){if(a.nativeWebVRAvailable)return navigator.getVRDisplays(function(c){for(var d=0;d<c.length;++d)a.devices.push(new p(c[d])),a.devices.push(new q(c[d]));a.devicesPopulated=!0;b(a.devices)},c);if(a.nativeLegacyWebVRAvailable)return(navigator.getVRDDevices||navigator.mozGetVRDevices)(function(c){for(var d=0;d<c.length;++d)c[d]instanceof
l&&a.devices.push(c[d]),c[d]instanceof n&&a.devices.push(c[d]);a.devicesPopulated=!0;b(a.devices)},c)}a.populateDevices();b(a.devices)}catch(v){c(v)}})};d.prototype.NativeVRFrameData=window.VRFrameData;d.prototype.isMobile=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)};d.prototype.isCardboardCompatible=function(){return this.isMobile()||window.WebVRConfig.FORCE_ENABLE_VR};d.prototype.isFullScreenAvailable=function(){return document.fullscreenEnabled||
document.mozFullScreenEnabled||document.webkitFullscreenEnabled||!1};d.InstallWebVRSpecShim=e;d.version=b;a.exports.WebVRPolyfill=d},function(a,b){a.exports={name:"webvr-polyfill",version:"0.9.36",homepage:"https://github.com/googlevr/webvr-polyfill",authors:["Boris Smus <boris@smus.com>","Brandon Jones <tojiro@gmail.com>","Jordan Santell <jordan@jsantell.com>"],description:"Use WebVR today, on mobile or desktop, without requiring a special browser build.",devDependencies:{chai:"^3.5.0",jsdom:"^9.12.0",
mocha:"^3.2.0",semver:"^5.3.0",webpack:"^2.6.1","webpack-dev-server":"^2.4.5"},main:"src/node-entry",keywords:["vr","webvr"],license:"Apache-2.0",scripts:{start:"npm run watch",watch:"webpack-dev-server",build:"webpack",test:"mocha"},repository:"googlevr/webvr-polyfill",bugs:{url:"https://github.com/googlevr/webvr-polyfill/issues"}}},function(a,b,c){function d(a){this.gl=a;this.ctxAttribs=a.getContextAttributes();this.meshHeight=this.meshWidth=20;this.bufferScale=window.WebVRConfig.BUFFER_SCALE;this.bufferWidth=
a.drawingBufferWidth;this.bufferHeight=a.drawingBufferHeight;this.realBindFramebuffer=a.bindFramebuffer;this.realEnable=a.enable;this.realDisable=a.disable;this.realColorMask=a.colorMask;this.realClearColor=a.clearColor;this.realViewport=a.viewport;f.isIOS()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(a.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(a.canvas.__proto__,"height"));this.isPatched=!1;this.lastBoundFramebuffer=null;this.stencilTest=this.scissorTest=
this.blend=this.depthTest=this.cullFace=!1;this.viewport=[0,0,0,0];this.colorMask=[!0,!0,!0,!0];this.clearColor=[0,0,0,0];this.attribs={position:0,texCoord:1};this.program=f.linkProgram(a,"attribute vec2 position;\nattribute vec3 texCoord;\nvarying vec2 vTexCoord;\nuniform vec4 viewportOffsetScale[2];\nvoid main() {\n  vec4 viewport = viewportOffsetScale[int(texCoord.z)];\n  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;\n  gl_Position = vec4( position, 1.0, 1.0 );\n}","precision mediump float;\nuniform sampler2D diffuse;\nvarying vec2 vTexCoord;\nvoid main() {\n  gl_FragColor = texture2D(diffuse, vTexCoord);\n}",
this.attribs);this.uniforms=f.getProgramUniforms(a,this.program);this.viewportOffsetScale=new Float32Array(8);this.setTextureBounds();this.vertexBuffer=a.createBuffer();this.indexBuffer=a.createBuffer();this.indexCount=0;this.renderTarget=a.createTexture();this.framebuffer=a.createFramebuffer();this.stencilBuffer=this.depthBuffer=this.depthStencilBuffer=null;this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=a.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=a.createRenderbuffer():
this.ctxAttribs.stencil&&(this.stencilBuffer=a.createRenderbuffer());this.patch();this.onResize();window.WebVRConfig.CARDBOARD_UI_DISABLED||(this.cardboardUI=new e(a))}var e=c(3),f=c(0),g=c(4);d.prototype.destroy=function(){var a=this.gl;this.unpatch();a.deleteProgram(this.program);a.deleteBuffer(this.vertexBuffer);a.deleteBuffer(this.indexBuffer);a.deleteTexture(this.renderTarget);a.deleteFramebuffer(this.framebuffer);this.depthStencilBuffer&&a.deleteRenderbuffer(this.depthStencilBuffer);this.depthBuffer&&
a.deleteRenderbuffer(this.depthBuffer);this.stencilBuffer&&a.deleteRenderbuffer(this.stencilBuffer);this.cardboardUI&&this.cardboardUI.destroy()};d.prototype.onResize=function(){var a=this.gl,b=this;g(a,[a.RENDERBUFFER_BINDING,a.TEXTURE_BINDING_2D,a.TEXTURE0],function(a){b.realBindFramebuffer.call(a,a.FRAMEBUFFER,null);b.scissorTest&&b.realDisable.call(a,a.SCISSOR_TEST);b.realColorMask.call(a,!0,!0,!0,!0);b.realViewport.call(a,0,0,a.drawingBufferWidth,a.drawingBufferHeight);b.realClearColor.call(a,
0,0,0,1);a.clear(a.COLOR_BUFFER_BIT);b.realBindFramebuffer.call(a,a.FRAMEBUFFER,b.framebuffer);a.bindTexture(a.TEXTURE_2D,b.renderTarget);a.texImage2D(a.TEXTURE_2D,0,b.ctxAttribs.alpha?a.RGBA:a.RGB,b.bufferWidth,b.bufferHeight,0,b.ctxAttribs.alpha?a.RGBA:a.RGB,a.UNSIGNED_BYTE,null);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,
a.CLAMP_TO_EDGE);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,b.renderTarget,0);b.ctxAttribs.depth&&b.ctxAttribs.stencil?(a.bindRenderbuffer(a.RENDERBUFFER,b.depthStencilBuffer),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_STENCIL,b.bufferWidth,b.bufferHeight),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_STENCIL_ATTACHMENT,a.RENDERBUFFER,b.depthStencilBuffer)):b.ctxAttribs.depth?(a.bindRenderbuffer(a.RENDERBUFFER,b.depthBuffer),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,
b.bufferWidth,b.bufferHeight),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,b.depthBuffer)):b.ctxAttribs.stencil&&(a.bindRenderbuffer(a.RENDERBUFFER,b.stencilBuffer),a.renderbufferStorage(a.RENDERBUFFER,a.STENCIL_INDEX8,b.bufferWidth,b.bufferHeight),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,b.stencilBuffer));!a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!");b.realBindFramebuffer.call(a,
a.FRAMEBUFFER,b.lastBoundFramebuffer);b.scissorTest&&b.realEnable.call(a,a.SCISSOR_TEST);b.realColorMask.apply(a,b.colorMask);b.realViewport.apply(a,b.viewport);b.realClearColor.apply(a,b.clearColor)});if(this.cardboardUI)this.cardboardUI.onResize()};d.prototype.patch=function(){if(!this.isPatched){var a=this,b=this.gl.canvas,c=this.gl;f.isIOS()||(b.width=f.getScreenWidth()*this.bufferScale,b.height=f.getScreenHeight()*this.bufferScale,Object.defineProperty(b,"width",{configurable:!0,enumerable:!0,
get:function(){return a.bufferWidth},set:function(c){a.bufferWidth=c;a.realCanvasWidth.set.call(b,c);a.onResize()}}),Object.defineProperty(b,"height",{configurable:!0,enumerable:!0,get:function(){return a.bufferHeight},set:function(c){a.bufferHeight=c;a.realCanvasHeight.set.call(b,c);a.onResize()}}));this.lastBoundFramebuffer=c.getParameter(c.FRAMEBUFFER_BINDING);null==this.lastBoundFramebuffer&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(c.FRAMEBUFFER,this.framebuffer));this.gl.bindFramebuffer=
function(b,d){a.lastBoundFramebuffer=d?d:a.framebuffer;a.realBindFramebuffer.call(c,b,a.lastBoundFramebuffer)};this.cullFace=c.getParameter(c.CULL_FACE);this.depthTest=c.getParameter(c.DEPTH_TEST);this.blend=c.getParameter(c.BLEND);this.scissorTest=c.getParameter(c.SCISSOR_TEST);this.stencilTest=c.getParameter(c.STENCIL_TEST);c.enable=function(b){switch(b){case c.CULL_FACE:a.cullFace=!0;break;case c.DEPTH_TEST:a.depthTest=!0;break;case c.BLEND:a.blend=!0;break;case c.SCISSOR_TEST:a.scissorTest=!0;
break;case c.STENCIL_TEST:a.stencilTest=!0}a.realEnable.call(c,b)};c.disable=function(b){switch(b){case c.CULL_FACE:a.cullFace=!1;break;case c.DEPTH_TEST:a.depthTest=!1;break;case c.BLEND:a.blend=!1;break;case c.SCISSOR_TEST:a.scissorTest=!1;break;case c.STENCIL_TEST:a.stencilTest=!1}a.realDisable.call(c,b)};this.colorMask=c.getParameter(c.COLOR_WRITEMASK);c.colorMask=function(b,d,e,f){a.colorMask[0]=b;a.colorMask[1]=d;a.colorMask[2]=e;a.colorMask[3]=f;a.realColorMask.call(c,b,d,e,f)};this.clearColor=
c.getParameter(c.COLOR_CLEAR_VALUE);c.clearColor=function(b,d,e,f){a.clearColor[0]=b;a.clearColor[1]=d;a.clearColor[2]=e;a.clearColor[3]=f;a.realClearColor.call(c,b,d,e,f)};this.viewport=c.getParameter(c.VIEWPORT);c.viewport=function(b,d,e,f){a.viewport[0]=b;a.viewport[1]=d;a.viewport[2]=e;a.viewport[3]=f;a.realViewport.call(c,b,d,e,f)};this.isPatched=!0;f.safariCssSizeWorkaround(b)}};d.prototype.unpatch=function(){if(this.isPatched){var a=this.gl,b=this.gl.canvas;f.isIOS()||(Object.defineProperty(b,
"width",this.realCanvasWidth),Object.defineProperty(b,"height",this.realCanvasHeight));b.width=this.bufferWidth;b.height=this.bufferHeight;a.bindFramebuffer=this.realBindFramebuffer;a.enable=this.realEnable;a.disable=this.realDisable;a.colorMask=this.realColorMask;a.clearColor=this.realClearColor;a.viewport=this.realViewport;this.lastBoundFramebuffer==this.framebuffer&&a.bindFramebuffer(a.FRAMEBUFFER,null);this.isPatched=!1;setTimeout(function(){f.safariCssSizeWorkaround(b)},1)}};d.prototype.setTextureBounds=
function(a,b){a||(a=[0,0,.5,1]);b||(b=[.5,0,.5,1]);this.viewportOffsetScale[0]=a[0];this.viewportOffsetScale[1]=a[1];this.viewportOffsetScale[2]=a[2];this.viewportOffsetScale[3]=a[3];this.viewportOffsetScale[4]=b[0];this.viewportOffsetScale[5]=b[1];this.viewportOffsetScale[6]=b[2];this.viewportOffsetScale[7]=b[3]};d.prototype.submitFrame=function(){var a=this.gl,b=this,c=[];window.WebVRConfig.DIRTY_SUBMIT_FRAME_BINDINGS||c.push(a.CURRENT_PROGRAM,a.ARRAY_BUFFER_BINDING,a.ELEMENT_ARRAY_BUFFER_BINDING,
a.TEXTURE_BINDING_2D,a.TEXTURE0);g(a,c,function(a){b.realBindFramebuffer.call(a,a.FRAMEBUFFER,null);b.cullFace&&b.realDisable.call(a,a.CULL_FACE);b.depthTest&&b.realDisable.call(a,a.DEPTH_TEST);b.blend&&b.realDisable.call(a,a.BLEND);b.scissorTest&&b.realDisable.call(a,a.SCISSOR_TEST);b.stencilTest&&b.realDisable.call(a,a.STENCIL_TEST);b.realColorMask.call(a,!0,!0,!0,!0);b.realViewport.call(a,0,0,a.drawingBufferWidth,a.drawingBufferHeight);if(b.ctxAttribs.alpha||f.isIOS())b.realClearColor.call(a,0,
0,0,1),a.clear(a.COLOR_BUFFER_BIT);a.useProgram(b.program);a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.indexBuffer);a.bindBuffer(a.ARRAY_BUFFER,b.vertexBuffer);a.enableVertexAttribArray(b.attribs.position);a.enableVertexAttribArray(b.attribs.texCoord);a.vertexAttribPointer(b.attribs.position,2,a.FLOAT,!1,20,0);a.vertexAttribPointer(b.attribs.texCoord,3,a.FLOAT,!1,20,8);a.activeTexture(a.TEXTURE0);a.uniform1i(b.uniforms.diffuse,0);a.bindTexture(a.TEXTURE_2D,b.renderTarget);a.uniform4fv(b.uniforms.viewportOffsetScale,
b.viewportOffsetScale);a.drawElements(a.TRIANGLES,b.indexCount,a.UNSIGNED_SHORT,0);b.cardboardUI&&b.cardboardUI.renderNoState();b.realBindFramebuffer.call(b.gl,a.FRAMEBUFFER,b.framebuffer);b.ctxAttribs.preserveDrawingBuffer||(b.realClearColor.call(a,0,0,0,0),a.clear(a.COLOR_BUFFER_BIT));window.WebVRConfig.DIRTY_SUBMIT_FRAME_BINDINGS||b.realBindFramebuffer.call(a,a.FRAMEBUFFER,b.lastBoundFramebuffer);b.cullFace&&b.realEnable.call(a,a.CULL_FACE);b.depthTest&&b.realEnable.call(a,a.DEPTH_TEST);b.blend&&
b.realEnable.call(a,a.BLEND);b.scissorTest&&b.realEnable.call(a,a.SCISSOR_TEST);b.stencilTest&&b.realEnable.call(a,a.STENCIL_TEST);b.realColorMask.apply(a,b.colorMask);b.realViewport.apply(a,b.viewport);!b.ctxAttribs.alpha&&b.ctxAttribs.preserveDrawingBuffer||b.realClearColor.apply(a,b.clearColor)});f.isIOS()&&(a=a.canvas,a.width!=b.bufferWidth||a.height!=b.bufferHeight)&&(b.bufferWidth=a.width,b.bufferHeight=a.height,b.onResize())};d.prototype.updateDeviceInfo=function(a){var b=this.gl,c=this;g(b,
[b.ARRAY_BUFFER_BINDING,b.ELEMENT_ARRAY_BUFFER_BINDING],function(b){var d=c.computeMeshVertices_(c.meshWidth,c.meshHeight,a);b.bindBuffer(b.ARRAY_BUFFER,c.vertexBuffer);b.bufferData(b.ARRAY_BUFFER,d,b.STATIC_DRAW);c.indexCount||(d=c.computeMeshIndices_(c.meshWidth,c.meshHeight),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c.indexBuffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,d,b.STATIC_DRAW),c.indexCount=d.length)})};d.prototype.computeMeshVertices_=function(a,b,c){for(var d=new Float32Array(2*a*b*5),e=c.getLeftEyeVisibleTanAngles(),
h=c.getLeftEyeNoLensTanAngles(),g=c.getLeftEyeVisibleScreenRect(h),k=0,m=0;2>m;m++){for(var t=0;t<b;t++)for(var v=0;v<a;v++,k++){var x=v/(a-1),w=t/(b-1),E=x,C=w,x=f.lerp(e[0],e[2],x),y=f.lerp(e[3],e[1],w),w=Math.sqrt(x*x+y*y),G=c.distortion.distortInverse(w),y=y*G/w,x=(x*G/w-h[0])/(h[2]-h[0]),w=(y-h[3])/(h[1]-h[3]),x=2*(g.x+x*g.width-.5),w=2*(g.y+w*g.height-.5);d[5*k+0]=x;d[5*k+1]=w;d[5*k+2]=E;d[5*k+3]=C;d[5*k+4]=m}t=e[2]-e[0];e[0]=-(t+e[0]);e[2]=t-e[2];t=h[2]-h[0];h[0]=-(t+h[0]);h[2]=t-h[2];g.x=
1-(g.x+g.width)}return d};d.prototype.computeMeshIndices_=function(a,b){for(var c=new Uint16Array(2*(a-1)*(b-1)*6),d=a/2,e=b/2,f=0,g=0,h=0;2>h;h++)for(var k=0;k<b;k++)for(var t=0;t<a;t++,f++)0!=t&&0!=k&&(t<=d==k<=e?(c[g++]=f,c[g++]=f-a-1,c[g++]=f-a,c[g++]=f-a-1,c[g++]=f,c[g++]=f-1):(c[g++]=f-1,c[g++]=f-a,c[g++]=f,c[g++]=f-a,c[g++]=f-1,c[g++]=f-a-1));return c};d.prototype.getOwnPropertyDescriptor_=function(a,b){var c=Object.getOwnPropertyDescriptor(a,b);if(void 0===c.get||void 0===c.set)c.configurable=
!0,c.enumerable=!0,c.get=function(){return this.getAttribute(b)},c.set=function(a){this.setAttribute(b,a)};return c};a.exports=d},function(a,b,c){function d(){this.displayName="Cardboard VRDisplay (webvr-polyfill)";this.capabilities.hasOrientation=!0;this.capabilities.canPresent=!0;this.bufferScale_=window.WebVRConfig.BUFFER_SCALE;this.poseSensor_=new k;this.cardboardUI_=this.distorter_=null;this.dpdb_=new h(!0,this.onDeviceParamsUpdated_.bind(this));this.deviceInfo_=new g(this.dpdb_.getDeviceParams());
this.viewerSelector_=new l;this.viewerSelector_.onChange(this.onViewerChanged_.bind(this));this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer());window.WebVRConfig.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new m);n.isIOS()&&window.addEventListener("resize",this.onResize_.bind(this))}var e=c(9),f=c(3),g=c(5),h=c(12),k=c(18),m=c(16),l=c(22);b=c(1).VRDisplay;var n=c(0);d.prototype=new b;d.prototype.getImmediatePose=function(){return{position:this.poseSensor_.getPosition(),
orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}};d.prototype.resetPose=function(){this.poseSensor_.resetPose()};d.prototype.getEyeParameters=function(a){var b=[.5*this.deviceInfo_.viewer.interLensDistance,0,0];if("left"==a)b[0]*=-1,a=this.deviceInfo_.getFieldOfViewLeftEye();else if("right"==a)a=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",a),null;return{fieldOfView:a,
offset:b,renderWidth:.5*this.deviceInfo_.device.width*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_}};d.prototype.onDeviceParamsUpdated_=function(a){n.isDebug()&&console.log("DPDB reported that device params were updated.");this.deviceInfo_.updateDeviceParams(a);this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)};d.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,
this.layer_.rightBounds)};d.prototype.beginPresent_=function(){var a=this.layer_.source.getContext("webgl");a||(a=this.layer_.source.getContext("experimental-webgl"));a||(a=this.layer_.source.getContext("webgl2"));a&&(this.layer_.predistorted?window.WebVRConfig.CARDBOARD_UI_DISABLED||(a.canvas.width=n.getScreenWidth()*this.bufferScale_,a.canvas.height=n.getScreenHeight()*this.bufferScale_,this.cardboardUI_=new f(a)):(this.distorter_=new e(a),this.distorter_.updateDeviceInfo(this.deviceInfo_),this.cardboardUI_=
this.distorter_.cardboardUI),this.cardboardUI_&&this.cardboardUI_.listen(function(a){this.viewerSelector_.show(this.layer_.source.parentElement);a.stopPropagation();a.preventDefault()}.bind(this),function(a){this.exitPresent();a.stopPropagation();a.preventDefault()}.bind(this)),this.rotateInstructions_&&(n.isLandscapeMode()&&n.isMobile()?this.rotateInstructions_.showTemporarily(3E3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),
window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())};d.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null);this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null);this.rotateInstructions_&&this.rotateInstructions_.hide();this.viewerSelector_.hide();
window.removeEventListener("orientationchange",this.orientationHandler);window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)};d.prototype.submitFrame=function(a){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){a=this.layer_.source.getContext("webgl").canvas;if(a.width!=this.lastWidth||a.height!=this.lastHeight)this.cardboardUI_.onResize();this.lastWidth=a.width;this.lastHeight=a.height;this.cardboardUI_.render()}};
d.prototype.onOrientationChange_=function(a){this.viewerSelector_.hide();this.rotateInstructions_&&this.rotateInstructions_.update();this.onResize_()};d.prototype.onResize_=function(a){this.layer_&&(a=this.layer_.source.getContext("webgl"),a.canvas.setAttribute("style",["position: absolute; top: 0; left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0; margin: 0; padding: 0 10px 10px 0; box-sizing: content-box"].join("; ")+";"),
n.safariCssSizeWorkaround(a.canvas))};d.prototype.onViewerChanged_=function(a){this.deviceInfo_.setViewer(a);this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_);this.fireVRDisplayDeviceParamsChange_()};d.prototype.fireVRDisplayDeviceParamsChange_=function(){var a=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(a)};a.exports=d},function(a,b){function c(a){this.coefficients=a}c.prototype.distortInverse=function(a){for(var b=
0,c=1,d=a-this.distort(b);1E-4<Math.abs(c-b);)var h=a-this.distort(c),d=c-(c-b)/(h-d)*h,b=c,c=d,d=h;return c};c.prototype.distort=function(a){for(var b=a*a,c=0,d=0;d<this.coefficients.length;d++)c=b*(c+this.coefficients[d]);return(c+1)*a};a.exports=c},function(a,b,c){function d(a,b){this.dpdb=f;this.recalculateDeviceParams_();if(a){this.onDeviceParamsUpdated=b;var c=new XMLHttpRequest,d=this;c.open("GET","https://dpdb.webvr.rocks/dpdb.json",!0);c.addEventListener("load",function(){d.loading=!1;200<=
c.status&&299>=c.status?(d.dpdb=JSON.parse(c.response),d.recalculateDeviceParams_()):console.error("Error loading online DPDB!")});c.send()}}function e(a){this.xdpi=a.xdpi;this.ydpi=a.ydpi;this.bevelMm=a.bevelMm}var f=c(13),g=c(0);d.prototype.getDeviceParams=function(){return this.deviceParams};d.prototype.recalculateDeviceParams_=function(){var a=this.calcDeviceParams_();if(a){if(this.deviceParams=a,this.onDeviceParamsUpdated)this.onDeviceParamsUpdated(this.deviceParams)}else console.error("Failed to recalculate device parameters.")};
d.prototype.calcDeviceParams_=function(){var a=this.dpdb;if(!a)return console.error("DPDB not available."),null;if(1!=a.format)return console.error("DPDB has unexpected format version."),null;if(!a.devices||!a.devices.length)return console.error("DPDB does not have a devices section."),null;var b=navigator.userAgent||navigator.vendor||window.opera,c=g.getScreenWidth(),d=g.getScreenHeight();if(!a.devices)return console.error("DPDB has no devices section."),null;for(var f=0;f<a.devices.length;f++){var p=
a.devices[f];if(!p.rules)console.warn("Device["+f+"] has no rules section.");else if("ios"!=p.type&&"android"!=p.type)console.warn("Device["+f+"] has invalid type.");else if(g.isIOS()==("ios"==p.type)){for(var q=!1,u=0;u<p.rules.length;u++)if(this.matchRule_(p.rules[u],b,c,d)){q=!0;break}if(q)return new e({xdpi:p.dpi[0]||p.dpi,ydpi:p.dpi[1]||p.dpi,bevelMm:p.bw})}}console.warn("No DPDB device match.");return null};d.prototype.matchRule_=function(a,b,c,d){if(!a.ua&&!a.res||a.ua&&0>b.indexOf(a.ua))return!1;
if(a.res){if(!a.res[0]||!a.res[1])return!1;b=a.res[0];a=a.res[1];if(Math.min(c,d)!=Math.min(b,a)||Math.max(c,d)!=Math.max(b,a))return!1}return!0};a.exports=d},function(a,b){a.exports={format:1,last_updated:"2017-06-01T22:33:42Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],
dpi:[537.9,533],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,
ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},
{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,
247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,
bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},
{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],
dpi:[234.5,229.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,
387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,
431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],
dpi:285.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},
{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],
dpi:[480,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1E3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1E3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1E3}]}},function(a,b,c){a=c(0);var d=c(7).WebVRPolyfill;
window.WebVRConfig=a.extend({FORCE_ENABLE_VR:!1,K_FILTER:.98,PREDICTION_TIME_S:.04,TOUCH_PANNER_DISABLED:!0,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,MOUSE_KEYBOARD_CONTROLS_DISABLED:!1,DEFER_INITIALIZATION:!1,ENABLE_DEPRECATED_API:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1,ALWAYS_APPEND_POLYFILL_DISPLAY:!1,GET_VR_DISPLAYS_TIMEOUT:1E3},window.WebVRConfig);window.WebVRConfig.DEFER_INITIALIZATION?window.InitializeWebVRPolyfill=function(){new d}:new d;window.WebVRPolyfill=
d},function(a,b,c){function d(){this.displayName="Mouse and Keyboard VRDisplay (webvr-polyfill)";this.capabilities.hasOrientation=!0;window.addEventListener("keydown",this.onKeyDown_.bind(this));window.addEventListener("mousemove",this.onMouseMove_.bind(this));window.addEventListener("mousedown",this.onMouseDown_.bind(this));window.addEventListener("mouseup",this.onMouseUp_.bind(this));this.theta_=this.phi_=0;this.angleAnimation_=this.targetAngle_=null;this.orientation_=new e.Quaternion;this.rotateStart_=
new e.Vector2;this.rotateEnd_=new e.Vector2;this.rotateDelta_=new e.Vector2;this.isDragging_=!1;this.orientationOut_=new Float32Array(4)}b=c(1).VRDisplay;var e=c(2),f=c(0);d.prototype=new b;d.prototype.getImmediatePose=function(){this.orientation_.setFromEulerYXZ(this.phi_,this.theta_,0);this.orientationOut_[0]=this.orientation_.x;this.orientationOut_[1]=this.orientation_.y;this.orientationOut_[2]=this.orientation_.z;this.orientationOut_[3]=this.orientation_.w;return{position:null,orientation:this.orientationOut_,
linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}};d.prototype.onKeyDown_=function(a){38==a.keyCode?this.animatePhi_(this.phi_+.15):39==a.keyCode?this.animateTheta_(this.theta_-.15):40==a.keyCode?this.animatePhi_(this.phi_-.15):37==a.keyCode&&this.animateTheta_(this.theta_+.15)};d.prototype.animateTheta_=function(a){this.animateKeyTransitions_("theta_",a)};d.prototype.animatePhi_=function(a){a=f.clamp(a,-Math.PI/2,Math.PI/2);this.animateKeyTransitions_("phi_",
a)};d.prototype.animateKeyTransitions_=function(a,b){this.angleAnimation_&&cancelAnimationFrame(this.angleAnimation_);var c=this[a],d=new Date;this.angleAnimation_=requestAnimationFrame(function n(){var e=new Date-d;80<=e?(this[a]=b,cancelAnimationFrame(this.angleAnimation_)):(this.angleAnimation_=requestAnimationFrame(n.bind(this)),this[a]=c+e/80*(b-c))}.bind(this))};d.prototype.onMouseDown_=function(a){this.rotateStart_.set(a.clientX,a.clientY);this.isDragging_=!0};d.prototype.onMouseMove_=function(a){if(this.isDragging_||
this.isPointerLocked_())this.isPointerLocked_()?this.rotateEnd_.set(this.rotateStart_.x-(a.movementX||a.mozMovementX||0),this.rotateStart_.y-(a.movementY||a.mozMovementY||0)):this.rotateEnd_.set(a.clientX,a.clientY),this.rotateDelta_.subVectors(this.rotateEnd_,this.rotateStart_),this.rotateStart_.copy(this.rotateEnd_),this.phi_+=2*Math.PI*this.rotateDelta_.y/screen.height*.3,this.theta_+=2*Math.PI*this.rotateDelta_.x/screen.width*.5,this.phi_=f.clamp(this.phi_,-Math.PI/2,Math.PI/2)};d.prototype.onMouseUp_=
function(a){this.isDragging_=!1};d.prototype.isPointerLocked_=function(){return void 0!==(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement)};d.prototype.resetPose=function(){this.theta_=this.phi_=0};a.exports=d},function(a,b,c){function d(){this.loadIcon_();var a=document.createElement("div"),b=a.style;b.position="fixed";b.top=0;b.right=0;b.bottom=0;b.left=0;b.backgroundColor="gray";b.fontFamily="sans-serif";b.zIndex=1E6;var c=document.createElement("img");
c.src=this.icon;b=c.style;b.marginLeft="25%";b.marginTop="25%";b.width="50%";a.appendChild(c);c=document.createElement("div");b=c.style;b.textAlign="center";b.fontSize="16px";b.lineHeight="24px";b.margin="24px 25%";b.width="50%";c.innerHTML="Place your phone into your Cardboard viewer.";a.appendChild(c);var d=document.createElement("div"),b=d.style;b.backgroundColor="#CFD8DC";b.position="fixed";b.bottom=0;b.width="100%";b.height="48px";b.padding="14px 24px";b.boxSizing="border-box";b.color="#656A6B";
a.appendChild(d);var e=document.createElement("div");e.style["float"]="left";e.innerHTML="No Cardboard viewer?";var l=document.createElement("a");l.href="https://www.google.com/get/cardboard/get-cardboard/";l.innerHTML="get one";l.target="_blank";b=l.style;b["float"]="right";b.fontWeight=600;b.textTransform="uppercase";b.borderLeft="1px solid gray";b.paddingLeft="24px";b.textDecoration="none";b.color="#656A6B";d.appendChild(e);d.appendChild(l);this.overlay=a;this.text=c;this.hide()}var e=c(0);d.prototype.show=
function(a){a||this.overlay.parentElement?a&&(this.overlay.parentElement&&this.overlay.parentElement!=a&&this.overlay.parentElement.removeChild(this.overlay),a.appendChild(this.overlay)):document.body.appendChild(this.overlay);this.overlay.style.display="block";a=this.overlay.querySelector("img").style;e.isLandscapeMode()?(a.width="20%",a.marginLeft="40%",a.marginTop="3%"):(a.width="50%",a.marginLeft="25%",a.marginTop="25%")};d.prototype.hide=function(){this.overlay.style.display="none"};d.prototype.showTemporarily=
function(a,b){this.show(b);this.timer=setTimeout(this.hide.bind(this),a)};d.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)};d.prototype.update=function(){this.disableShowTemporarily();!e.isLandscapeMode()&&e.isMobile()?this.show():this.hide()};d.prototype.loadIcon_=function(){this.icon=e.base64("image/svg+xml","PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjE5OHB4IiBoZWlnaHQ9IjI0MHB4IiB2aWV3Qm94PSIwIDAgMTk4IDI0MCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDMuMy4zICgxMjA4MSkgLSBodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2ggLS0+CiAgICA8dGl0bGU+dHJhbnNpdGlvbjwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPjwvZGVmcz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHNrZXRjaDp0eXBlPSJNU1BhZ2UiPgogICAgICAgIDxnIGlkPSJ0cmFuc2l0aW9uIiBza2V0Y2g6dHlwZT0iTVNBcnRib2FyZEdyb3VwIj4KICAgICAgICAgICAgPGcgaWQ9IkltcG9ydGVkLUxheWVycy1Db3B5LTQtKy1JbXBvcnRlZC1MYXllcnMtQ29weS0rLUltcG9ydGVkLUxheWVycy1Db3B5LTItQ29weSIgc2tldGNoOnR5cGU9Ik1TTGF5ZXJHcm91cCI+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSW1wb3J0ZWQtTGF5ZXJzLUNvcHktNCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsIDEwNy4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ5LjYyNSwyLjUyNyBDMTQ5LjYyNSwyLjUyNyAxNTUuODA1LDYuMDk2IDE1Ni4zNjIsNi40MTggTDE1Ni4zNjIsNy4zMDQgQzE1Ni4zNjIsNy40ODEgMTU2LjM3NSw3LjY2NCAxNTYuNCw3Ljg1MyBDMTU2LjQxLDcuOTM0IDE1Ni40Miw4LjAxNSAxNTYuNDI3LDguMDk1IEMxNTYuNTY3LDkuNTEgMTU3LjQwMSwxMS4wOTMgMTU4LjUzMiwxMi4wOTQgTDE2NC4yNTIsMTcuMTU2IEwxNjQuMzMzLDE3LjA2NiBDMTY0LjMzMywxNy4wNjYgMTY4LjcxNSwxNC41MzYgMTY5LjU2OCwxNC4wNDIgQzE3MS4wMjUsMTQuODgzIDE5NS41MzgsMjkuMDM1IDE5NS41MzgsMjkuMDM1IEwxOTUuNTM4LDgzLjAzNiBDMTk1LjUzOCw4My44MDcgMTk1LjE1Miw4NC4yNTMgMTk0LjU5LDg0LjI1MyBDMTk0LjM1Nyw4NC4yNTMgMTk0LjA5NSw4NC4xNzcgMTkzLjgxOCw4NC4wMTcgTDE2OS44NTEsNzAuMTc5IEwxNjkuODM3LDcwLjIwMyBMMTQyLjUxNSw4NS45NzggTDE0MS42NjUsODQuNjU1IEMxMzYuOTM0LDgzLjEyNiAxMzEuOTE3LDgxLjkxNSAxMjYuNzE0LDgxLjA0NSBDMTI2LjcwOSw4MS4wNiAxMjYuNzA3LDgxLjA2OSAxMjYuNzA3LDgxLjA2OSBMMTIxLjY0LDk4LjAzIEwxMTMuNzQ5LDEwMi41ODYgTDExMy43MTIsMTAyLjUyMyBMMTEzLjcxMiwxMzAuMTEzIEMxMTMuNzEyLDEzMC44ODUgMTEzLjMyNiwxMzEuMzMgMTEyLjc2NCwxMzEuMzMgQzExMi41MzIsMTMxLjMzIDExMi4yNjksMTMxLjI1NCAxMTEuOTkyLDEzMS4wOTQgTDY5LjUxOSwxMDYuNTcyIEM2OC41NjksMTA2LjAyMyA2Ny43OTksMTA0LjY5NSA2Ny43OTksMTAzLjYwNSBMNjcuNzk5LDEwMi41NyBMNjcuNzc4LDEwMi42MTcgQzY3LjI3LDEwMi4zOTMgNjYuNjQ4LDEwMi4yNDkgNjUuOTYyLDEwMi4yMTggQzY1Ljg3NSwxMDIuMjE0IDY1Ljc4OCwxMDIuMjEyIDY1LjcwMSwxMDIuMjEyIEM2NS42MDYsMTAyLjIxMiA2NS41MTEsMTAyLjIxNSA2NS40MTYsMTAyLjIxOSBDNjUuMTk1LDEwMi4yMjkgNjQuOTc0LDEwMi4yMzUgNjQuNzU0LDEwMi4yMzUgQzY0LjMzMSwxMDIuMjM1IDYzLjkxMSwxMDIuMjE2IDYzLjQ5OCwxMDIuMTc4IEM2MS44NDMsMTAyLjAyNSA2MC4yOTgsMTAxLjU3OCA1OS4wOTQsMTAwLjg4MiBMMTIuNTE4LDczLjk5MiBMMTIuNTIzLDc0LjAwNCBMMi4yNDUsNTUuMjU0IEMxLjI0NCw1My40MjcgMi4wMDQsNTEuMDM4IDMuOTQzLDQ5LjkxOCBMNTkuOTU0LDE3LjU3MyBDNjAuNjI2LDE3LjE4NSA2MS4zNSwxNy4wMDEgNjIuMDUzLDE3LjAwMSBDNjMuMzc5LDE3LjAwMSA2NC42MjUsMTcuNjYgNjUuMjgsMTguODU0IEw2NS4yODUsMTguODUxIEw2NS41MTIsMTkuMjY0IEw2NS41MDYsMTkuMjY4IEM2NS45MDksMjAuMDAzIDY2LjQwNSwyMC42OCA2Ni45ODMsMjEuMjg2IEw2Ny4yNiwyMS41NTYgQzY5LjE3NCwyMy40MDYgNzEuNzI4LDI0LjM1NyA3NC4zNzMsMjQuMzU3IEM3Ni4zMjIsMjQuMzU3IDc4LjMyMSwyMy44NCA4MC4xNDgsMjIuNzg1IEM4MC4xNjEsMjIuNzg1IDg3LjQ2NywxOC41NjYgODcuNDY3LDE4LjU2NiBDODguMTM5LDE4LjE3OCA4OC44NjMsMTcuOTk0IDg5LjU2NiwxNy45OTQgQzkwLjg5MiwxNy45OTQgOTIuMTM4LDE4LjY1MiA5Mi43OTIsMTkuODQ3IEw5Ni4wNDIsMjUuNzc1IEw5Ni4wNjQsMjUuNzU3IEwxMDIuODQ5LDI5LjY3NCBMMTAyLjc0NCwyOS40OTIgTDE0OS42MjUsMi41MjcgTTE0OS42MjUsMC44OTIgQzE0OS4zNDMsMC44OTIgMTQ5LjA2MiwwLjk2NSAxNDguODEsMS4xMSBMMTAyLjY0MSwyNy42NjYgTDk3LjIzMSwyNC41NDIgTDk0LjIyNiwxOS4wNjEgQzkzLjMxMywxNy4zOTQgOTEuNTI3LDE2LjM1OSA4OS41NjYsMTYuMzU4IEM4OC41NTUsMTYuMzU4IDg3LjU0NiwxNi42MzIgODYuNjQ5LDE3LjE1IEM4My44NzgsMTguNzUgNzkuNjg3LDIxLjE2OSA3OS4zNzQsMjEuMzQ1IEM3OS4zNTksMjEuMzUzIDc5LjM0NSwyMS4zNjEgNzkuMzMsMjEuMzY5IEM3Ny43OTgsMjIuMjU0IDc2LjA4NCwyMi43MjIgNzQuMzczLDIyLjcyMiBDNzIuMDgxLDIyLjcyMiA2OS45NTksMjEuODkgNjguMzk3LDIwLjM4IEw2OC4xNDUsMjAuMTM1IEM2Ny43MDYsMTkuNjcyIDY3LjMyMywxOS4xNTYgNjcuMDA2LDE4LjYwMSBDNjYuOTg4LDE4LjU1OSA2Ni45NjgsMTguNTE5IDY2Ljk0NiwxOC40NzkgTDY2LjcxOSwxOC4wNjUgQzY2LjY5LDE4LjAxMiA2Ni42NTgsMTcuOTYgNjYuNjI0LDE3LjkxMSBDNjUuNjg2LDE2LjMzNyA2My45NTEsMTUuMzY2IDYyLjA1MywxNS4zNjYgQzYxLjA0MiwxNS4zNjYgNjAuMDMzLDE1LjY0IDU5LjEzNiwxNi4xNTggTDMuMTI1LDQ4LjUwMiBDMC40MjYsNTAuMDYxIC0wLjYxMyw1My40NDIgMC44MTEsNTYuMDQgTDExLjA4OSw3NC43OSBDMTEuMjY2LDc1LjExMyAxMS41MzcsNzUuMzUzIDExLjg1LDc1LjQ5NCBMNTguMjc2LDEwMi4yOTggQzU5LjY3OSwxMDMuMTA4IDYxLjQzMywxMDMuNjMgNjMuMzQ4LDEwMy44MDYgQzYzLjgxMiwxMDMuODQ4IDY0LjI4NSwxMDMuODcgNjQuNzU0LDEwMy44NyBDNjUsMTAzLjg3IDY1LjI0OSwxMDMuODY0IDY1LjQ5NCwxMDMuODUyIEM2NS41NjMsMTAzLjg0OSA2NS42MzIsMTAzLjg0NyA2NS43MDEsMTAzLjg0NyBDNjUuNzY0LDEwMy44NDcgNjUuODI4LDEwMy44NDkgNjUuODksMTAzLjg1MiBDNjUuOTg2LDEwMy44NTYgNjYuMDgsMTAzLjg2MyA2Ni4xNzMsMTAzLjg3NCBDNjYuMjgyLDEwNS40NjcgNjcuMzMyLDEwNy4xOTcgNjguNzAyLDEwNy45ODggTDExMS4xNzQsMTMyLjUxIEMxMTEuNjk4LDEzMi44MTIgMTEyLjIzMiwxMzIuOTY1IDExMi43NjQsMTMyLjk2NSBDMTE0LjI2MSwxMzIuOTY1IDExNS4zNDcsMTMxLjc2NSAxMTUuMzQ3LDEzMC4xMTMgTDExNS4zNDcsMTAzLjU1MSBMMTIyLjQ1OCw5OS40NDYgQzEyMi44MTksOTkuMjM3IDEyMy4wODcsOTguODk4IDEyMy4yMDcsOTguNDk4IEwxMjcuODY1LDgyLjkwNSBDMTMyLjI3OSw4My43MDIgMTM2LjU1Nyw4NC43NTMgMTQwLjYwNyw4Ni4wMzMgTDE0MS4xNCw4Ni44NjIgQzE0MS40NTEsODcuMzQ2IDE0MS45NzcsODcuNjEzIDE0Mi41MTYsODcuNjEzIEMxNDIuNzk0LDg3LjYxMyAxNDMuMDc2LDg3LjU0MiAxNDMuMzMzLDg3LjM5MyBMMTY5Ljg2NSw3Mi4wNzYgTDE5Myw4NS40MzMgQzE5My41MjMsODUuNzM1IDE5NC4wNTgsODUuODg4IDE5NC41OSw4NS44ODggQzE5Ni4wODcsODUuODg4IDE5Ny4xNzMsODQuNjg5IDE5Ny4xNzMsODMuMDM2IEwxOTcuMTczLDI5LjAzNSBDMTk3LjE3MywyOC40NTEgMTk2Ljg2MSwyNy45MTEgMTk2LjM1NSwyNy42MTkgQzE5Ni4zNTUsMjcuNjE5IDE3MS44NDMsMTMuNDY3IDE3MC4zODUsMTIuNjI2IEMxNzAuMTMyLDEyLjQ4IDE2OS44NSwxMi40MDcgMTY5LjU2OCwxMi40MDcgQzE2OS4yODUsMTIuNDA3IDE2OS4wMDIsMTIuNDgxIDE2OC43NDksMTIuNjI3IEMxNjguMTQzLDEyLjk3OCAxNjUuNzU2LDE0LjM1NyAxNjQuNDI0LDE1LjEyNSBMMTU5LjYxNSwxMC44NyBDMTU4Ljc5NiwxMC4xNDUgMTU4LjE1NCw4LjkzNyAxNTguMDU0LDcuOTM0IEMxNTguMDQ1LDcuODM3IDE1OC4wMzQsNy43MzkgMTU4LjAyMSw3LjY0IEMxNTguMDA1LDcuNTIzIDE1Ny45OTgsNy40MSAxNTcuOTk4LDcuMzA0IEwxNTcuOTk4LDYuNDE4IEMxNTcuOTk4LDUuODM0IDE1Ny42ODYsNS4yOTUgMTU3LjE4MSw1LjAwMiBDMTU2LjYyNCw0LjY4IDE1MC40NDIsMS4xMTEgMTUwLjQ0MiwxLjExMSBDMTUwLjE4OSwwLjk2NSAxNDkuOTA3LDAuODkyIDE0OS42MjUsMC44OTIiIGlkPSJGaWxsLTEiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTYuMDI3LDI1LjYzNiBMMTQyLjYwMyw1Mi41MjcgQzE0My44MDcsNTMuMjIyIDE0NC41ODIsNTQuMTE0IDE0NC44NDUsNTUuMDY4IEwxNDQuODM1LDU1LjA3NSBMNjMuNDYxLDEwMi4wNTcgTDYzLjQ2LDEwMi4wNTcgQzYxLjgwNiwxMDEuOTA1IDYwLjI2MSwxMDEuNDU3IDU5LjA1NywxMDAuNzYyIEwxMi40ODEsNzMuODcxIEw5Ni4wMjcsMjUuNjM2IiBpZD0iRmlsbC0yIiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTYzLjQ2MSwxMDIuMTc0IEM2My40NTMsMTAyLjE3NCA2My40NDYsMTAyLjE3NCA2My40MzksMTAyLjE3MiBDNjEuNzQ2LDEwMi4wMTYgNjAuMjExLDEwMS41NjMgNTguOTk4LDEwMC44NjMgTDEyLjQyMiw3My45NzMgQzEyLjM4Niw3My45NTIgMTIuMzY0LDczLjkxNCAxMi4zNjQsNzMuODcxIEMxMi4zNjQsNzMuODMgMTIuMzg2LDczLjc5MSAxMi40MjIsNzMuNzcgTDk1Ljk2OCwyNS41MzUgQzk2LjAwNCwyNS41MTQgOTYuMDQ5LDI1LjUxNCA5Ni4wODUsMjUuNTM1IEwxNDIuNjYxLDUyLjQyNiBDMTQzLjg4OCw1My4xMzQgMTQ0LjY4Miw1NC4wMzggMTQ0Ljk1Nyw1NS4wMzcgQzE0NC45Nyw1NS4wODMgMTQ0Ljk1Myw1NS4xMzMgMTQ0LjkxNSw1NS4xNjEgQzE0NC45MTEsNTUuMTY1IDE0NC44OTgsNTUuMTc0IDE0NC44OTQsNTUuMTc3IEw2My41MTksMTAyLjE1OCBDNjMuNTAxLDEwMi4xNjkgNjMuNDgxLDEwMi4xNzQgNjMuNDYxLDEwMi4xNzQgTDYzLjQ2MSwxMDIuMTc0IFogTTEyLjcxNCw3My44NzEgTDU5LjExNSwxMDAuNjYxIEM2MC4yOTMsMTAxLjM0MSA2MS43ODYsMTAxLjc4MiA2My40MzUsMTAxLjkzNyBMMTQ0LjcwNyw1NS4wMTUgQzE0NC40MjgsNTQuMTA4IDE0My42ODIsNTMuMjg1IDE0Mi41NDQsNTIuNjI4IEw5Ni4wMjcsMjUuNzcxIEwxMi43MTQsNzMuODcxIEwxMi43MTQsNzMuODcxIFoiIGlkPSJGaWxsLTMiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ4LjMyNyw1OC40NzEgQzE0OC4xNDUsNTguNDggMTQ3Ljk2Miw1OC40OCAxNDcuNzgxLDU4LjQ3MiBDMTQ1Ljg4Nyw1OC4zODkgMTQ0LjQ3OSw1Ny40MzQgMTQ0LjYzNiw1Ni4zNCBDMTQ0LjY4OSw1NS45NjcgMTQ0LjY2NCw1NS41OTcgMTQ0LjU2NCw1NS4yMzUgTDYzLjQ2MSwxMDIuMDU3IEM2NC4wODksMTAyLjExNSA2NC43MzMsMTAyLjEzIDY1LjM3OSwxMDIuMDk5IEM2NS41NjEsMTAyLjA5IDY1Ljc0MywxMDIuMDkgNjUuOTI1LDEwMi4wOTggQzY3LjgxOSwxMDIuMTgxIDY5LjIyNywxMDMuMTM2IDY5LjA3LDEwNC4yMyBMMTQ4LjMyNyw1OC40NzEiIGlkPSJGaWxsLTQiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNjkuMDcsMTA0LjM0NyBDNjkuMDQ4LDEwNC4zNDcgNjkuMDI1LDEwNC4zNCA2OS4wMDUsMTA0LjMyNyBDNjguOTY4LDEwNC4zMDEgNjguOTQ4LDEwNC4yNTcgNjguOTU1LDEwNC4yMTMgQzY5LDEwMy44OTYgNjguODk4LDEwMy41NzYgNjguNjU4LDEwMy4yODggQzY4LjE1MywxMDIuNjc4IDY3LjEwMywxMDIuMjY2IDY1LjkyLDEwMi4yMTQgQzY1Ljc0MiwxMDIuMjA2IDY1LjU2MywxMDIuMjA3IDY1LjM4NSwxMDIuMjE1IEM2NC43NDIsMTAyLjI0NiA2NC4wODcsMTAyLjIzMiA2My40NSwxMDIuMTc0IEM2My4zOTksMTAyLjE2OSA2My4zNTgsMTAyLjEzMiA2My4zNDcsMTAyLjA4MiBDNjMuMzM2LDEwMi4wMzMgNjMuMzU4LDEwMS45ODEgNjMuNDAyLDEwMS45NTYgTDE0NC41MDYsNTUuMTM0IEMxNDQuNTM3LDU1LjExNiAxNDQuNTc1LDU1LjExMyAxNDQuNjA5LDU1LjEyNyBDMTQ0LjY0Miw1NS4xNDEgMTQ0LjY2OCw1NS4xNyAxNDQuNjc3LDU1LjIwNCBDMTQ0Ljc4MSw1NS41ODUgMTQ0LjgwNiw1NS45NzIgMTQ0Ljc1MSw1Ni4zNTcgQzE0NC43MDYsNTYuNjczIDE0NC44MDgsNTYuOTk0IDE0NS4wNDcsNTcuMjgyIEMxNDUuNTUzLDU3Ljg5MiAxNDYuNjAyLDU4LjMwMyAxNDcuNzg2LDU4LjM1NSBDMTQ3Ljk2NCw1OC4zNjMgMTQ4LjE0Myw1OC4zNjMgMTQ4LjMyMSw1OC4zNTQgQzE0OC4zNzcsNTguMzUyIDE0OC40MjQsNTguMzg3IDE0OC40MzksNTguNDM4IEMxNDguNDU0LDU4LjQ5IDE0OC40MzIsNTguNTQ1IDE0OC4zODUsNTguNTcyIEw2OS4xMjksMTA0LjMzMSBDNjkuMTExLDEwNC4zNDIgNjkuMDksMTA0LjM0NyA2OS4wNywxMDQuMzQ3IEw2OS4wNywxMDQuMzQ3IFogTTY1LjY2NSwxMDEuOTc1IEM2NS43NTQsMTAxLjk3NSA2NS44NDIsMTAxLjk3NyA2NS45MywxMDEuOTgxIEM2Ny4xOTYsMTAyLjAzNyA2OC4yODMsMTAyLjQ2OSA2OC44MzgsMTAzLjEzOSBDNjkuMDY1LDEwMy40MTMgNjkuMTg4LDEwMy43MTQgNjkuMTk4LDEwNC4wMjEgTDE0Ny44ODMsNTguNTkyIEMxNDcuODQ3LDU4LjU5MiAxNDcuODExLDU4LjU5MSAxNDcuNzc2LDU4LjU4OSBDMTQ2LjUwOSw1OC41MzMgMTQ1LjQyMiw1OC4xIDE0NC44NjcsNTcuNDMxIEMxNDQuNTg1LDU3LjA5MSAxNDQuNDY1LDU2LjcwNyAxNDQuNTIsNTYuMzI0IEMxNDQuNTYzLDU2LjAyMSAxNDQuNTUyLDU1LjcxNiAxNDQuNDg4LDU1LjQxNCBMNjMuODQ2LDEwMS45NyBDNjQuMzUzLDEwMi4wMDIgNjQuODY3LDEwMi4wMDYgNjUuMzc0LDEwMS45ODIgQzY1LjQ3MSwxMDEuOTc3IDY1LjU2OCwxMDEuOTc1IDY1LjY2NSwxMDEuOTc1IEw2NS42NjUsMTAxLjk3NSBaIiBpZD0iRmlsbC01IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTIuMjA4LDU1LjEzNCBDMS4yMDcsNTMuMzA3IDEuOTY3LDUwLjkxNyAzLjkwNiw0OS43OTcgTDU5LjkxNywxNy40NTMgQzYxLjg1NiwxNi4zMzMgNjQuMjQxLDE2LjkwNyA2NS4yNDMsMTguNzM0IEw2NS40NzUsMTkuMTQ0IEM2NS44NzIsMTkuODgyIDY2LjM2OCwyMC41NiA2Ni45NDUsMjEuMTY1IEw2Ny4yMjMsMjEuNDM1IEM3MC41NDgsMjQuNjQ5IDc1LjgwNiwyNS4xNTEgODAuMTExLDIyLjY2NSBMODcuNDMsMTguNDQ1IEM4OS4zNywxNy4zMjYgOTEuNzU0LDE3Ljg5OSA5Mi43NTUsMTkuNzI3IEw5Ni4wMDUsMjUuNjU1IEwxMi40ODYsNzMuODg0IEwyLjIwOCw1NS4xMzQgWiIgaWQ9IkZpbGwtNiIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMi40ODYsNzQuMDAxIEMxMi40NzYsNzQuMDAxIDEyLjQ2NSw3My45OTkgMTIuNDU1LDczLjk5NiBDMTIuNDI0LDczLjk4OCAxMi4zOTksNzMuOTY3IDEyLjM4NCw3My45NCBMMi4xMDYsNTUuMTkgQzEuMDc1LDUzLjMxIDEuODU3LDUwLjg0NSAzLjg0OCw0OS42OTYgTDU5Ljg1OCwxNy4zNTIgQzYwLjUyNSwxNi45NjcgNjEuMjcxLDE2Ljc2NCA2Mi4wMTYsMTYuNzY0IEM2My40MzEsMTYuNzY0IDY0LjY2NiwxNy40NjYgNjUuMzI3LDE4LjY0NiBDNjUuMzM3LDE4LjY1NCA2NS4zNDUsMTguNjYzIDY1LjM1MSwxOC42NzQgTDY1LjU3OCwxOS4wODggQzY1LjU4NCwxOS4xIDY1LjU4OSwxOS4xMTIgNjUuNTkxLDE5LjEyNiBDNjUuOTg1LDE5LjgzOCA2Ni40NjksMjAuNDk3IDY3LjAzLDIxLjA4NSBMNjcuMzA1LDIxLjM1MSBDNjkuMTUxLDIzLjEzNyA3MS42NDksMjQuMTIgNzQuMzM2LDI0LjEyIEM3Ni4zMTMsMjQuMTIgNzguMjksMjMuNTgyIDgwLjA1MywyMi41NjMgQzgwLjA2NCwyMi41NTcgODAuMDc2LDIyLjU1MyA4MC4wODgsMjIuNTUgTDg3LjM3MiwxOC4zNDQgQzg4LjAzOCwxNy45NTkgODguNzg0LDE3Ljc1NiA4OS41MjksMTcuNzU2IEM5MC45NTYsMTcuNzU2IDkyLjIwMSwxOC40NzIgOTIuODU4LDE5LjY3IEw5Ni4xMDcsMjUuNTk5IEM5Ni4xMzgsMjUuNjU0IDk2LjExOCwyNS43MjQgOTYuMDYzLDI1Ljc1NiBMMTIuNTQ1LDczLjk4NSBDMTIuNTI2LDczLjk5NiAxMi41MDYsNzQuMDAxIDEyLjQ4Niw3NC4wMDEgTDEyLjQ4Niw3NC4wMDEgWiBNNjIuMDE2LDE2Ljk5NyBDNjEuMzEyLDE2Ljk5NyA2MC42MDYsMTcuMTkgNTkuOTc1LDE3LjU1NCBMMy45NjUsNDkuODk5IEMyLjA4Myw1MC45ODUgMS4zNDEsNTMuMzA4IDIuMzEsNTUuMDc4IEwxMi41MzEsNzMuNzIzIEw5NS44NDgsMjUuNjExIEw5Mi42NTMsMTkuNzgyIEM5Mi4wMzgsMTguNjYgOTAuODcsMTcuOTkgODkuNTI5LDE3Ljk5IEM4OC44MjUsMTcuOTkgODguMTE5LDE4LjE4MiA4Ny40ODksMTguNTQ3IEw4MC4xNzIsMjIuNzcyIEM4MC4xNjEsMjIuNzc4IDgwLjE0OSwyMi43ODIgODAuMTM3LDIyLjc4NSBDNzguMzQ2LDIzLjgxMSA3Ni4zNDEsMjQuMzU0IDc0LjMzNiwyNC4zNTQgQzcxLjU4OCwyNC4zNTQgNjkuMDMzLDIzLjM0NyA2Ny4xNDIsMjEuNTE5IEw2Ni44NjQsMjEuMjQ5IEM2Ni4yNzcsMjAuNjM0IDY1Ljc3NCwxOS45NDcgNjUuMzY3LDE5LjIwMyBDNjUuMzYsMTkuMTkyIDY1LjM1NiwxOS4xNzkgNjUuMzU0LDE5LjE2NiBMNjUuMTYzLDE4LjgxOSBDNjUuMTU0LDE4LjgxMSA2NS4xNDYsMTguODAxIDY1LjE0LDE4Ljc5IEM2NC41MjUsMTcuNjY3IDYzLjM1NywxNi45OTcgNjIuMDE2LDE2Ljk5NyBMNjIuMDE2LDE2Ljk5NyBaIiBpZD0iRmlsbC03IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTQyLjQzNCw0OC44MDggTDQyLjQzNCw0OC44MDggQzM5LjkyNCw0OC44MDcgMzcuNzM3LDQ3LjU1IDM2LjU4Miw0NS40NDMgQzM0Ljc3MSw0Mi4xMzkgMzYuMTQ0LDM3LjgwOSAzOS42NDEsMzUuNzg5IEw1MS45MzIsMjguNjkxIEM1My4xMDMsMjguMDE1IDU0LjQxMywyNy42NTggNTUuNzIxLDI3LjY1OCBDNTguMjMxLDI3LjY1OCA2MC40MTgsMjguOTE2IDYxLjU3MywzMS4wMjMgQzYzLjM4NCwzNC4zMjcgNjIuMDEyLDM4LjY1NyA1OC41MTQsNDAuNjc3IEw0Ni4yMjMsNDcuNzc1IEM0NS4wNTMsNDguNDUgNDMuNzQyLDQ4LjgwOCA0Mi40MzQsNDguODA4IEw0Mi40MzQsNDguODA4IFogTTU1LjcyMSwyOC4xMjUgQzU0LjQ5NSwyOC4xMjUgNTMuMjY1LDI4LjQ2MSA1Mi4xNjYsMjkuMDk2IEwzOS44NzUsMzYuMTk0IEMzNi41OTYsMzguMDg3IDM1LjMwMiw0Mi4xMzYgMzYuOTkyLDQ1LjIxOCBDMzguMDYzLDQ3LjE3MyA0MC4wOTgsNDguMzQgNDIuNDM0LDQ4LjM0IEM0My42NjEsNDguMzQgNDQuODksNDguMDA1IDQ1Ljk5LDQ3LjM3IEw1OC4yODEsNDAuMjcyIEM2MS41NiwzOC4zNzkgNjIuODUzLDM0LjMzIDYxLjE2NCwzMS4yNDggQzYwLjA5MiwyOS4yOTMgNTguMDU4LDI4LjEyNSA1NS43MjEsMjguMTI1IEw1NS43MjEsMjguMTI1IFoiIGlkPSJGaWxsLTgiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTQ5LjU4OCwyLjQwNyBDMTQ5LjU4OCwyLjQwNyAxNTUuNzY4LDUuOTc1IDE1Ni4zMjUsNi4yOTcgTDE1Ni4zMjUsNy4xODQgQzE1Ni4zMjUsNy4zNiAxNTYuMzM4LDcuNTQ0IDE1Ni4zNjIsNy43MzMgQzE1Ni4zNzMsNy44MTQgMTU2LjM4Miw3Ljg5NCAxNTYuMzksNy45NzUgQzE1Ni41Myw5LjM5IDE1Ny4zNjMsMTAuOTczIDE1OC40OTUsMTEuOTc0IEwxNjUuODkxLDE4LjUxOSBDMTY2LjA2OCwxOC42NzUgMTY2LjI0OSwxOC44MTQgMTY2LjQzMiwxOC45MzQgQzE2OC4wMTEsMTkuOTc0IDE2OS4zODIsMTkuNCAxNjkuNDk0LDE3LjY1MiBDMTY5LjU0MywxNi44NjggMTY5LjU1MSwxNi4wNTcgMTY5LjUxNywxNS4yMjMgTDE2OS41MTQsMTUuMDYzIEwxNjkuNTE0LDEzLjkxMiBDMTcwLjc4LDE0LjY0MiAxOTUuNTAxLDI4LjkxNSAxOTUuNTAxLDI4LjkxNSBMMTk1LjUwMSw4Mi45MTUgQzE5NS41MDEsODQuMDA1IDE5NC43MzEsODQuNDQ1IDE5My43ODEsODMuODk3IEwxNTEuMzA4LDU5LjM3NCBDMTUwLjM1OCw1OC44MjYgMTQ5LjU4OCw1Ny40OTcgMTQ5LjU4OCw1Ni40MDggTDE0OS41ODgsMjIuMzc1IiBpZD0iRmlsbC05IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE5NC41NTMsODQuMjUgQzE5NC4yOTYsODQuMjUgMTk0LjAxMyw4NC4xNjUgMTkzLjcyMiw4My45OTcgTDE1MS4yNSw1OS40NzYgQzE1MC4yNjksNTguOTA5IDE0OS40NzEsNTcuNTMzIDE0OS40NzEsNTYuNDA4IEwxNDkuNDcxLDIyLjM3NSBMMTQ5LjcwNSwyMi4zNzUgTDE0OS43MDUsNTYuNDA4IEMxNDkuNzA1LDU3LjQ1OSAxNTAuNDUsNTguNzQ0IDE1MS4zNjYsNTkuMjc0IEwxOTMuODM5LDgzLjc5NSBDMTk0LjI2Myw4NC4wNCAxOTQuNjU1LDg0LjA4MyAxOTQuOTQyLDgzLjkxNyBDMTk1LjIyNyw4My43NTMgMTk1LjM4NCw4My4zOTcgMTk1LjM4NCw4Mi45MTUgTDE5NS4zODQsMjguOTgyIEMxOTQuMTAyLDI4LjI0MiAxNzIuMTA0LDE1LjU0MiAxNjkuNjMxLDE0LjExNCBMMTY5LjYzNCwxNS4yMiBDMTY5LjY2OCwxNi4wNTIgMTY5LjY2LDE2Ljg3NCAxNjkuNjEsMTcuNjU5IEMxNjkuNTU2LDE4LjUwMyAxNjkuMjE0LDE5LjEyMyAxNjguNjQ3LDE5LjQwNSBDMTY4LjAyOCwxOS43MTQgMTY3LjE5NywxOS41NzggMTY2LjM2NywxOS4wMzIgQzE2Ni4xODEsMTguOTA5IDE2NS45OTUsMTguNzY2IDE2NS44MTQsMTguNjA2IEwxNTguNDE3LDEyLjA2MiBDMTU3LjI1OSwxMS4wMzYgMTU2LjQxOCw5LjQzNyAxNTYuMjc0LDcuOTg2IEMxNTYuMjY2LDcuOTA3IDE1Ni4yNTcsNy44MjcgMTU2LjI0Nyw3Ljc0OCBDMTU2LjIyMSw3LjU1NSAxNTYuMjA5LDcuMzY1IDE1Ni4yMDksNy4xODQgTDE1Ni4yMDksNi4zNjQgQzE1NS4zNzUsNS44ODMgMTQ5LjUyOSwyLjUwOCAxNDkuNTI5LDIuNTA4IEwxNDkuNjQ2LDIuMzA2IEMxNDkuNjQ2LDIuMzA2IDE1NS44MjcsNS44NzQgMTU2LjM4NCw2LjE5NiBMMTU2LjQ0Miw2LjIzIEwxNTYuNDQyLDcuMTg0IEMxNTYuNDQyLDcuMzU1IDE1Ni40NTQsNy41MzUgMTU2LjQ3OCw3LjcxNyBDMTU2LjQ4OSw3LjggMTU2LjQ5OSw3Ljg4MiAxNTYuNTA3LDcuOTYzIEMxNTYuNjQ1LDkuMzU4IDE1Ny40NTUsMTAuODk4IDE1OC41NzIsMTEuODg2IEwxNjUuOTY5LDE4LjQzMSBDMTY2LjE0MiwxOC41ODQgMTY2LjMxOSwxOC43MiAxNjYuNDk2LDE4LjgzNyBDMTY3LjI1NCwxOS4zMzYgMTY4LDE5LjQ2NyAxNjguNTQzLDE5LjE5NiBDMTY5LjAzMywxOC45NTMgMTY5LjMyOSwxOC40MDEgMTY5LjM3NywxNy42NDUgQzE2OS40MjcsMTYuODY3IDE2OS40MzQsMTYuMDU0IDE2OS40MDEsMTUuMjI4IEwxNjkuMzk3LDE1LjA2NSBMMTY5LjM5NywxMy43MSBMMTY5LjU3MiwxMy44MSBDMTcwLjgzOSwxNC41NDEgMTk1LjU1OSwyOC44MTQgMTk1LjU1OSwyOC44MTQgTDE5NS42MTgsMjguODQ3IEwxOTUuNjE4LDgyLjkxNSBDMTk1LjYxOCw4My40ODQgMTk1LjQyLDgzLjkxMSAxOTUuMDU5LDg0LjExOSBDMTk0LjkwOCw4NC4yMDYgMTk0LjczNyw4NC4yNSAxOTQuNTUzLDg0LjI1IiBpZD0iRmlsbC0xMCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNDUuNjg1LDU2LjE2MSBMMTY5LjgsNzAuMDgzIEwxNDMuODIyLDg1LjA4MSBMMTQyLjM2LDg0Ljc3NCBDMTM1LjgyNiw4Mi42MDQgMTI4LjczMiw4MS4wNDYgMTIxLjM0MSw4MC4xNTggQzExNi45NzYsNzkuNjM0IDExMi42NzgsODEuMjU0IDExMS43NDMsODMuNzc4IEMxMTEuNTA2LDg0LjQxNCAxMTEuNTAzLDg1LjA3MSAxMTEuNzMyLDg1LjcwNiBDMTEzLjI3LDg5Ljk3MyAxMTUuOTY4LDk0LjA2OSAxMTkuNzI3LDk3Ljg0MSBMMTIwLjI1OSw5OC42ODYgQzEyMC4yNiw5OC42ODUgOTQuMjgyLDExMy42ODMgOTQuMjgyLDExMy42ODMgTDcwLjE2Nyw5OS43NjEgTDE0NS42ODUsNTYuMTYxIiBpZD0iRmlsbC0xMSIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik05NC4yODIsMTEzLjgxOCBMOTQuMjIzLDExMy43ODUgTDY5LjkzMyw5OS43NjEgTDcwLjEwOCw5OS42NiBMMTQ1LjY4NSw1Ni4wMjYgTDE0NS43NDMsNTYuMDU5IEwxNzAuMDMzLDcwLjA4MyBMMTQzLjg0Miw4NS4yMDUgTDE0My43OTcsODUuMTk1IEMxNDMuNzcyLDg1LjE5IDE0Mi4zMzYsODQuODg4IDE0Mi4zMzYsODQuODg4IEMxMzUuNzg3LDgyLjcxNCAxMjguNzIzLDgxLjE2MyAxMjEuMzI3LDgwLjI3NCBDMTIwLjc4OCw4MC4yMDkgMTIwLjIzNiw4MC4xNzcgMTE5LjY4OSw4MC4xNzcgQzExNS45MzEsODAuMTc3IDExMi42MzUsODEuNzA4IDExMS44NTIsODMuODE5IEMxMTEuNjI0LDg0LjQzMiAxMTEuNjIxLDg1LjA1MyAxMTEuODQyLDg1LjY2NyBDMTEzLjM3Nyw4OS45MjUgMTE2LjA1OCw5My45OTMgMTE5LjgxLDk3Ljc1OCBMMTE5LjgyNiw5Ny43NzkgTDEyMC4zNTIsOTguNjE0IEMxMjAuMzU0LDk4LjYxNyAxMjAuMzU2LDk4LjYyIDEyMC4zNTgsOTguNjI0IEwxMjAuNDIyLDk4LjcyNiBMMTIwLjMxNyw5OC43ODcgQzEyMC4yNjQsOTguODE4IDk0LjU5OSwxMTMuNjM1IDk0LjM0LDExMy43ODUgTDk0LjI4MiwxMTMuODE4IEw5NC4yODIsMTEzLjgxOCBaIE03MC40MDEsOTkuNzYxIEw5NC4yODIsMTEzLjU0OSBMMTE5LjA4NCw5OS4yMjkgQzExOS42Myw5OC45MTQgMTE5LjkzLDk4Ljc0IDEyMC4xMDEsOTguNjU0IEwxMTkuNjM1LDk3LjkxNCBDMTE1Ljg2NCw5NC4xMjcgMTEzLjE2OCw5MC4wMzMgMTExLjYyMiw4NS43NDYgQzExMS4zODIsODUuMDc5IDExMS4zODYsODQuNDA0IDExMS42MzMsODMuNzM4IEMxMTIuNDQ4LDgxLjUzOSAxMTUuODM2LDc5Ljk0MyAxMTkuNjg5LDc5Ljk0MyBDMTIwLjI0Niw3OS45NDMgMTIwLjgwNiw3OS45NzYgMTIxLjM1NSw4MC4wNDIgQzEyOC43NjcsODAuOTMzIDEzNS44NDYsODIuNDg3IDE0Mi4zOTYsODQuNjYzIEMxNDMuMjMyLDg0LjgzOCAxNDMuNjExLDg0LjkxNyAxNDMuNzg2LDg0Ljk2NyBMMTY5LjU2Niw3MC4wODMgTDE0NS42ODUsNTYuMjk1IEw3MC40MDEsOTkuNzYxIEw3MC40MDEsOTkuNzYxIFoiIGlkPSJGaWxsLTEyIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2Ny4yMywxOC45NzkgTDE2Ny4yMyw2OS44NSBMMTM5LjkwOSw4NS42MjMgTDEzMy40NDgsNzEuNDU2IEMxMzIuNTM4LDY5LjQ2IDEzMC4wMiw2OS43MTggMTI3LjgyNCw3Mi4wMyBDMTI2Ljc2OSw3My4xNCAxMjUuOTMxLDc0LjU4NSAxMjUuNDk0LDc2LjA0OCBMMTE5LjAzNCw5Ny42NzYgTDkxLjcxMiwxMTMuNDUgTDkxLjcxMiw2Mi41NzkgTDE2Ny4yMywxOC45NzkiIGlkPSJGaWxsLTEzIiBmaWxsPSIjRkZGRkZGIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTkxLjcxMiwxMTMuNTY3IEM5MS42OTIsMTEzLjU2NyA5MS42NzIsMTEzLjU2MSA5MS42NTMsMTEzLjU1MSBDOTEuNjE4LDExMy41MyA5MS41OTUsMTEzLjQ5MiA5MS41OTUsMTEzLjQ1IEw5MS41OTUsNjIuNTc5IEM5MS41OTUsNjIuNTM3IDkxLjYxOCw2Mi40OTkgOTEuNjUzLDYyLjQ3OCBMMTY3LjE3MiwxOC44NzggQzE2Ny4yMDgsMTguODU3IDE2Ny4yNTIsMTguODU3IDE2Ny4yODgsMTguODc4IEMxNjcuMzI0LDE4Ljg5OSAxNjcuMzQ3LDE4LjkzNyAxNjcuMzQ3LDE4Ljk3OSBMMTY3LjM0Nyw2OS44NSBDMTY3LjM0Nyw2OS44OTEgMTY3LjMyNCw2OS45MyAxNjcuMjg4LDY5Ljk1IEwxMzkuOTY3LDg1LjcyNSBDMTM5LjkzOSw4NS43NDEgMTM5LjkwNSw4NS43NDUgMTM5Ljg3Myw4NS43MzUgQzEzOS44NDIsODUuNzI1IDEzOS44MTYsODUuNzAyIDEzOS44MDIsODUuNjcyIEwxMzMuMzQyLDcxLjUwNCBDMTMyLjk2Nyw3MC42ODIgMTMyLjI4LDcwLjIyOSAxMzEuNDA4LDcwLjIyOSBDMTMwLjMxOSw3MC4yMjkgMTI5LjA0NCw3MC45MTUgMTI3LjkwOCw3Mi4xMSBDMTI2Ljg3NCw3My4yIDEyNi4wMzQsNzQuNjQ3IDEyNS42MDYsNzYuMDgyIEwxMTkuMTQ2LDk3LjcwOSBDMTE5LjEzNyw5Ny43MzggMTE5LjExOCw5Ny43NjIgMTE5LjA5Miw5Ny43NzcgTDkxLjc3LDExMy41NTEgQzkxLjc1MiwxMTMuNTYxIDkxLjczMiwxMTMuNTY3IDkxLjcxMiwxMTMuNTY3IEw5MS43MTIsMTEzLjU2NyBaIE05MS44MjksNjIuNjQ3IEw5MS44MjksMTEzLjI0OCBMMTE4LjkzNSw5Ny41OTggTDEyNS4zODIsNzYuMDE1IEMxMjUuODI3LDc0LjUyNSAxMjYuNjY0LDczLjA4MSAxMjcuNzM5LDcxLjk1IEMxMjguOTE5LDcwLjcwOCAxMzAuMjU2LDY5Ljk5NiAxMzEuNDA4LDY5Ljk5NiBDMTMyLjM3Nyw2OS45OTYgMTMzLjEzOSw3MC40OTcgMTMzLjU1NCw3MS40MDcgTDEzOS45NjEsODUuNDU4IEwxNjcuMTEzLDY5Ljc4MiBMMTY3LjExMywxOS4xODEgTDkxLjgyOSw2Mi42NDcgTDkxLjgyOSw2Mi42NDcgWiIgaWQ9IkZpbGwtMTQiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTY4LjU0MywxOS4yMTMgTDE2OC41NDMsNzAuMDgzIEwxNDEuMjIxLDg1Ljg1NyBMMTM0Ljc2MSw3MS42ODkgQzEzMy44NTEsNjkuNjk0IDEzMS4zMzMsNjkuOTUxIDEyOS4xMzcsNzIuMjYzIEMxMjguMDgyLDczLjM3NCAxMjcuMjQ0LDc0LjgxOSAxMjYuODA3LDc2LjI4MiBMMTIwLjM0Niw5Ny45MDkgTDkzLjAyNSwxMTMuNjgzIEw5My4wMjUsNjIuODEzIEwxNjguNTQzLDE5LjIxMyIgaWQ9IkZpbGwtMTUiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTMuMDI1LDExMy44IEM5My4wMDUsMTEzLjggOTIuOTg0LDExMy43OTUgOTIuOTY2LDExMy43ODUgQzkyLjkzMSwxMTMuNzY0IDkyLjkwOCwxMTMuNzI1IDkyLjkwOCwxMTMuNjg0IEw5Mi45MDgsNjIuODEzIEM5Mi45MDgsNjIuNzcxIDkyLjkzMSw2Mi43MzMgOTIuOTY2LDYyLjcxMiBMMTY4LjQ4NCwxOS4xMTIgQzE2OC41MiwxOS4wOSAxNjguNTY1LDE5LjA5IDE2OC42MDEsMTkuMTEyIEMxNjguNjM3LDE5LjEzMiAxNjguNjYsMTkuMTcxIDE2OC42NiwxOS4yMTIgTDE2OC42Niw3MC4wODMgQzE2OC42Niw3MC4xMjUgMTY4LjYzNyw3MC4xNjQgMTY4LjYwMSw3MC4xODQgTDE0MS4yOCw4NS45NTggQzE0MS4yNTEsODUuOTc1IDE0MS4yMTcsODUuOTc5IDE0MS4xODYsODUuOTY4IEMxNDEuMTU0LDg1Ljk1OCAxNDEuMTI5LDg1LjkzNiAxNDEuMTE1LDg1LjkwNiBMMTM0LjY1NSw3MS43MzggQzEzNC4yOCw3MC45MTUgMTMzLjU5Myw3MC40NjMgMTMyLjcyLDcwLjQ2MyBDMTMxLjYzMiw3MC40NjMgMTMwLjM1Nyw3MS4xNDggMTI5LjIyMSw3Mi4zNDQgQzEyOC4xODYsNzMuNDMzIDEyNy4zNDcsNzQuODgxIDEyNi45MTksNzYuMzE1IEwxMjAuNDU4LDk3Ljk0MyBDMTIwLjQ1LDk3Ljk3MiAxMjAuNDMxLDk3Ljk5NiAxMjAuNDA1LDk4LjAxIEw5My4wODMsMTEzLjc4NSBDOTMuMDY1LDExMy43OTUgOTMuMDQ1LDExMy44IDkzLjAyNSwxMTMuOCBMOTMuMDI1LDExMy44IFogTTkzLjE0Miw2Mi44ODEgTDkzLjE0MiwxMTMuNDgxIEwxMjAuMjQ4LDk3LjgzMiBMMTI2LjY5NSw3Ni4yNDggQzEyNy4xNCw3NC43NTggMTI3Ljk3Nyw3My4zMTUgMTI5LjA1Miw3Mi4xODMgQzEzMC4yMzEsNzAuOTQyIDEzMS41NjgsNzAuMjI5IDEzMi43Miw3MC4yMjkgQzEzMy42ODksNzAuMjI5IDEzNC40NTIsNzAuNzMxIDEzNC44NjcsNzEuNjQxIEwxNDEuMjc0LDg1LjY5MiBMMTY4LjQyNiw3MC4wMTYgTDE2OC40MjYsMTkuNDE1IEw5My4xNDIsNjIuODgxIEw5My4xNDIsNjIuODgxIFoiIGlkPSJGaWxsLTE2IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2OS44LDcwLjA4MyBMMTQyLjQ3OCw4NS44NTcgTDEzNi4wMTgsNzEuNjg5IEMxMzUuMTA4LDY5LjY5NCAxMzIuNTksNjkuOTUxIDEzMC4zOTMsNzIuMjYzIEMxMjkuMzM5LDczLjM3NCAxMjguNSw3NC44MTkgMTI4LjA2NCw3Ni4yODIgTDEyMS42MDMsOTcuOTA5IEw5NC4yODIsMTEzLjY4MyBMOTQuMjgyLDYyLjgxMyBMMTY5LjgsMTkuMjEzIEwxNjkuOCw3MC4wODMgWiIgaWQ9IkZpbGwtMTciIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOTQuMjgyLDExMy45MTcgQzk0LjI0MSwxMTMuOTE3IDk0LjIwMSwxMTMuOTA3IDk0LjE2NSwxMTMuODg2IEM5NC4wOTMsMTEzLjg0NSA5NC4wNDgsMTEzLjc2NyA5NC4wNDgsMTEzLjY4NCBMOTQuMDQ4LDYyLjgxMyBDOTQuMDQ4LDYyLjczIDk0LjA5Myw2Mi42NTIgOTQuMTY1LDYyLjYxMSBMMTY5LjY4MywxOS4wMSBDMTY5Ljc1NSwxOC45NjkgMTY5Ljg0NCwxOC45NjkgMTY5LjkxNywxOS4wMSBDMTY5Ljk4OSwxOS4wNTIgMTcwLjAzMywxOS4xMjkgMTcwLjAzMywxOS4yMTIgTDE3MC4wMzMsNzAuMDgzIEMxNzAuMDMzLDcwLjE2NiAxNjkuOTg5LDcwLjI0NCAxNjkuOTE3LDcwLjI4NSBMMTQyLjU5NSw4Ni4wNiBDMTQyLjUzOCw4Ni4wOTIgMTQyLjQ2OSw4Ni4xIDE0Mi40MDcsODYuMDggQzE0Mi4zNDQsODYuMDYgMTQyLjI5Myw4Ni4wMTQgMTQyLjI2Niw4NS45NTQgTDEzNS44MDUsNzEuNzg2IEMxMzUuNDQ1LDcwLjk5NyAxMzQuODEzLDcwLjU4IDEzMy45NzcsNzAuNTggQzEzMi45MjEsNzAuNTggMTMxLjY3Niw3MS4yNTIgMTMwLjU2Miw3Mi40MjQgQzEyOS41NCw3My41MDEgMTI4LjcxMSw3NC45MzEgMTI4LjI4Nyw3Ni4zNDggTDEyMS44MjcsOTcuOTc2IEMxMjEuODEsOTguMDM0IDEyMS43NzEsOTguMDgyIDEyMS43Miw5OC4xMTIgTDk0LjM5OCwxMTMuODg2IEM5NC4zNjIsMTEzLjkwNyA5NC4zMjIsMTEzLjkxNyA5NC4yODIsMTEzLjkxNyBMOTQuMjgyLDExMy45MTcgWiBNOTQuNTE1LDYyLjk0OCBMOTQuNTE1LDExMy4yNzkgTDEyMS40MDYsOTcuNzU0IEwxMjcuODQsNzYuMjE1IEMxMjguMjksNzQuNzA4IDEyOS4xMzcsNzMuMjQ3IDEzMC4yMjQsNzIuMTAzIEMxMzEuNDI1LDcwLjgzOCAxMzIuNzkzLDcwLjExMiAxMzMuOTc3LDcwLjExMiBDMTM0Ljk5NSw3MC4xMTIgMTM1Ljc5NSw3MC42MzggMTM2LjIzLDcxLjU5MiBMMTQyLjU4NCw4NS41MjYgTDE2OS41NjYsNjkuOTQ4IEwxNjkuNTY2LDE5LjYxNyBMOTQuNTE1LDYyLjk0OCBMOTQuNTE1LDYyLjk0OCBaIiBpZD0iRmlsbC0xOCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMDkuODk0LDkyLjk0MyBMMTA5Ljg5NCw5Mi45NDMgQzEwOC4xMiw5Mi45NDMgMTA2LjY1Myw5Mi4yMTggMTA1LjY1LDkwLjgyMyBDMTA1LjU4Myw5MC43MzEgMTA1LjU5Myw5MC42MSAxMDUuNjczLDkwLjUyOSBDMTA1Ljc1Myw5MC40NDggMTA1Ljg4LDkwLjQ0IDEwNS45NzQsOTAuNTA2IEMxMDYuNzU0LDkxLjA1MyAxMDcuNjc5LDkxLjMzMyAxMDguNzI0LDkxLjMzMyBDMTEwLjA0Nyw5MS4zMzMgMTExLjQ3OCw5MC44OTQgMTEyLjk4LDkwLjAyNyBDMTE4LjI5MSw4Ni45NiAxMjIuNjExLDc5LjUwOSAxMjIuNjExLDczLjQxNiBDMTIyLjYxMSw3MS40ODkgMTIyLjE2OSw2OS44NTYgMTIxLjMzMyw2OC42OTIgQzEyMS4yNjYsNjguNiAxMjEuMjc2LDY4LjQ3MyAxMjEuMzU2LDY4LjM5MiBDMTIxLjQzNiw2OC4zMTEgMTIxLjU2Myw2OC4yOTkgMTIxLjY1Niw2OC4zNjUgQzEyMy4zMjcsNjkuNTM3IDEyNC4yNDcsNzEuNzQ2IDEyNC4yNDcsNzQuNTg0IEMxMjQuMjQ3LDgwLjgyNiAxMTkuODIxLDg4LjQ0NyAxMTQuMzgyLDkxLjU4NyBDMTEyLjgwOCw5Mi40OTUgMTExLjI5OCw5Mi45NDMgMTA5Ljg5NCw5Mi45NDMgTDEwOS44OTQsOTIuOTQzIFogTTEwNi45MjUsOTEuNDAxIEMxMDcuNzM4LDkyLjA1MiAxMDguNzQ1LDkyLjI3OCAxMDkuODkzLDkyLjI3OCBMMTA5Ljg5NCw5Mi4yNzggQzExMS4yMTUsOTIuMjc4IDExMi42NDcsOTEuOTUxIDExNC4xNDgsOTEuMDg0IEMxMTkuNDU5LDg4LjAxNyAxMjMuNzgsODAuNjIxIDEyMy43OCw3NC41MjggQzEyMy43OCw3Mi41NDkgMTIzLjMxNyw3MC45MjkgMTIyLjQ1NCw2OS43NjcgQzEyMi44NjUsNzAuODAyIDEyMy4wNzksNzIuMDQyIDEyMy4wNzksNzMuNDAyIEMxMjMuMDc5LDc5LjY0NSAxMTguNjUzLDg3LjI4NSAxMTMuMjE0LDkwLjQyNSBDMTExLjY0LDkxLjMzNCAxMTAuMTMsOTEuNzQyIDEwOC43MjQsOTEuNzQyIEMxMDguMDgzLDkxLjc0MiAxMDcuNDgxLDkxLjU5MyAxMDYuOTI1LDkxLjQwMSBMMTA2LjkyNSw5MS40MDEgWiIgaWQ9IkZpbGwtMTkiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjA5Nyw5MC4yMyBDMTE4LjQ4MSw4Ny4xMjIgMTIyLjg0NSw3OS41OTQgMTIyLjg0NSw3My40MTYgQzEyMi44NDUsNzEuMzY1IDEyMi4zNjIsNjkuNzI0IDEyMS41MjIsNjguNTU2IEMxMTkuNzM4LDY3LjMwNCAxMTcuMTQ4LDY3LjM2MiAxMTQuMjY1LDY5LjAyNiBDMTA4Ljg4MSw3Mi4xMzQgMTA0LjUxNyw3OS42NjIgMTA0LjUxNyw4NS44NCBDMTA0LjUxNyw4Ny44OTEgMTA1LDg5LjUzMiAxMDUuODQsOTAuNyBDMTA3LjYyNCw5MS45NTIgMTEwLjIxNCw5MS44OTQgMTEzLjA5Nyw5MC4yMyIgaWQ9IkZpbGwtMjAiIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTA4LjcyNCw5MS42MTQgTDEwOC43MjQsOTEuNjE0IEMxMDcuNTgyLDkxLjYxNCAxMDYuNTY2LDkxLjQwMSAxMDUuNzA1LDkwLjc5NyBDMTA1LjY4NCw5MC43ODMgMTA1LjY2NSw5MC44MTEgMTA1LjY1LDkwLjc5IEMxMDQuNzU2LDg5LjU0NiAxMDQuMjgzLDg3Ljg0MiAxMDQuMjgzLDg1LjgxNyBDMTA0LjI4Myw3OS41NzUgMTA4LjcwOSw3MS45NTMgMTE0LjE0OCw2OC44MTIgQzExNS43MjIsNjcuOTA0IDExNy4yMzIsNjcuNDQ5IDExOC42MzgsNjcuNDQ5IEMxMTkuNzgsNjcuNDQ5IDEyMC43OTYsNjcuNzU4IDEyMS42NTYsNjguMzYyIEMxMjEuNjc4LDY4LjM3NyAxMjEuNjk3LDY4LjM5NyAxMjEuNzEyLDY4LjQxOCBDMTIyLjYwNiw2OS42NjIgMTIzLjA3OSw3MS4zOSAxMjMuMDc5LDczLjQxNSBDMTIzLjA3OSw3OS42NTggMTE4LjY1Myw4Ny4xOTggMTEzLjIxNCw5MC4zMzggQzExMS42NCw5MS4yNDcgMTEwLjEzLDkxLjYxNCAxMDguNzI0LDkxLjYxNCBMMTA4LjcyNCw5MS42MTQgWiBNMTA2LjAwNiw5MC41MDUgQzEwNi43OCw5MS4wMzcgMTA3LjY5NCw5MS4yODEgMTA4LjcyNCw5MS4yODEgQzExMC4wNDcsOTEuMjgxIDExMS40NzgsOTAuODY4IDExMi45OCw5MC4wMDEgQzExOC4yOTEsODYuOTM1IDEyMi42MTEsNzkuNDk2IDEyMi42MTEsNzMuNDAzIEMxMjIuNjExLDcxLjQ5NCAxMjIuMTc3LDY5Ljg4IDEyMS4zNTYsNjguNzE4IEMxMjAuNTgyLDY4LjE4NSAxMTkuNjY4LDY3LjkxOSAxMTguNjM4LDY3LjkxOSBDMTE3LjMxNSw2Ny45MTkgMTE1Ljg4Myw2OC4zNiAxMTQuMzgyLDY5LjIyNyBDMTA5LjA3MSw3Mi4yOTMgMTA0Ljc1MSw3OS43MzMgMTA0Ljc1MSw4NS44MjYgQzEwNC43NTEsODcuNzM1IDEwNS4xODUsODkuMzQzIDEwNi4wMDYsOTAuNTA1IEwxMDYuMDA2LDkwLjUwNSBaIiBpZD0iRmlsbC0yMSIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNDkuMzE4LDcuMjYyIEwxMzkuMzM0LDE2LjE0IEwxNTUuMjI3LDI3LjE3MSBMMTYwLjgxNiwyMS4wNTkgTDE0OS4zMTgsNy4yNjIiIGlkPSJGaWxsLTIyIiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE2OS42NzYsMTMuODQgTDE1OS45MjgsMTkuNDY3IEMxNTYuMjg2LDIxLjU3IDE1MC40LDIxLjU4IDE0Ni43ODEsMTkuNDkxIEMxNDMuMTYxLDE3LjQwMiAxNDMuMTgsMTQuMDAzIDE0Ni44MjIsMTEuOSBMMTU2LjMxNyw2LjI5MiBMMTQ5LjU4OCwyLjQwNyBMNjcuNzUyLDQ5LjQ3OCBMMTEzLjY3NSw3NS45OTIgTDExNi43NTYsNzQuMjEzIEMxMTcuMzg3LDczLjg0OCAxMTcuNjI1LDczLjMxNSAxMTcuMzc0LDcyLjgyMyBDMTE1LjAxNyw2OC4xOTEgMTE0Ljc4MSw2My4yNzcgMTE2LjY5MSw1OC41NjEgQzEyMi4zMjksNDQuNjQxIDE0MS4yLDMzLjc0NiAxNjUuMzA5LDMwLjQ5MSBDMTczLjQ3OCwyOS4zODggMTgxLjk4OSwyOS41MjQgMTkwLjAxMywzMC44ODUgQzE5MC44NjUsMzEuMDMgMTkxLjc4OSwzMC44OTMgMTkyLjQyLDMwLjUyOCBMMTk1LjUwMSwyOC43NSBMMTY5LjY3NiwxMy44NCIgaWQ9IkZpbGwtMjMiIGZpbGw9IiNGQUZBRkEiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjY3NSw3Ni40NTkgQzExMy41OTQsNzYuNDU5IDExMy41MTQsNzYuNDM4IDExMy40NDIsNzYuMzk3IEw2Ny41MTgsNDkuODgyIEM2Ny4zNzQsNDkuNzk5IDY3LjI4NCw0OS42NDUgNjcuMjg1LDQ5LjQ3OCBDNjcuMjg1LDQ5LjMxMSA2Ny4zNzQsNDkuMTU3IDY3LjUxOSw0OS4wNzMgTDE0OS4zNTUsMi4wMDIgQzE0OS40OTksMS45MTkgMTQ5LjY3NywxLjkxOSAxNDkuODIxLDIuMDAyIEwxNTYuNTUsNS44ODcgQzE1Ni43NzQsNi4wMTcgMTU2Ljg1LDYuMzAyIDE1Ni43MjIsNi41MjYgQzE1Ni41OTIsNi43NDkgMTU2LjMwNyw2LjgyNiAxNTYuMDgzLDYuNjk2IEwxNDkuNTg3LDIuOTQ2IEw2OC42ODcsNDkuNDc5IEwxMTMuNjc1LDc1LjQ1MiBMMTE2LjUyMyw3My44MDggQzExNi43MTUsNzMuNjk3IDExNy4xNDMsNzMuMzk5IDExNi45NTgsNzMuMDM1IEMxMTQuNTQyLDY4LjI4NyAxMTQuMyw2My4yMjEgMTE2LjI1OCw1OC4zODUgQzExOS4wNjQsNTEuNDU4IDEyNS4xNDMsNDUuMTQzIDEzMy44NCw0MC4xMjIgQzE0Mi40OTcsMzUuMTI0IDE1My4zNTgsMzEuNjMzIDE2NS4yNDcsMzAuMDI4IEMxNzMuNDQ1LDI4LjkyMSAxODIuMDM3LDI5LjA1OCAxOTAuMDkxLDMwLjQyNSBDMTkwLjgzLDMwLjU1IDE5MS42NTIsMzAuNDMyIDE5Mi4xODYsMzAuMTI0IEwxOTQuNTY3LDI4Ljc1IEwxNjkuNDQyLDE0LjI0NCBDMTY5LjIxOSwxNC4xMTUgMTY5LjE0MiwxMy44MjkgMTY5LjI3MSwxMy42MDYgQzE2OS40LDEzLjM4MiAxNjkuNjg1LDEzLjMwNiAxNjkuOTA5LDEzLjQzNSBMMTk1LjczNCwyOC4zNDUgQzE5NS44NzksMjguNDI4IDE5NS45NjgsMjguNTgzIDE5NS45NjgsMjguNzUgQzE5NS45NjgsMjguOTE2IDE5NS44NzksMjkuMDcxIDE5NS43MzQsMjkuMTU0IEwxOTIuNjUzLDMwLjkzMyBDMTkxLjkzMiwzMS4zNSAxOTAuODksMzEuNTA4IDE4OS45MzUsMzEuMzQ2IEMxODEuOTcyLDI5Ljk5NSAxNzMuNDc4LDI5Ljg2IDE2NS4zNzIsMzAuOTU0IEMxNTMuNjAyLDMyLjU0MyAxNDIuODYsMzUuOTkzIDEzNC4zMDcsNDAuOTMxIEMxMjUuNzkzLDQ1Ljg0NyAxMTkuODUxLDUyLjAwNCAxMTcuMTI0LDU4LjczNiBDMTE1LjI3LDYzLjMxNCAxMTUuNTAxLDY4LjExMiAxMTcuNzksNzIuNjExIEMxMTguMTYsNzMuMzM2IDExNy44NDUsNzQuMTI0IDExNi45OSw3NC42MTcgTDExMy45MDksNzYuMzk3IEMxMTMuODM2LDc2LjQzOCAxMTMuNzU2LDc2LjQ1OSAxMTMuNjc1LDc2LjQ1OSIgaWQ9IkZpbGwtMjQiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUzLjMxNiwyMS4yNzkgQzE1MC45MDMsMjEuMjc5IDE0OC40OTUsMjAuNzUxIDE0Ni42NjQsMTkuNjkzIEMxNDQuODQ2LDE4LjY0NCAxNDMuODQ0LDE3LjIzMiAxNDMuODQ0LDE1LjcxOCBDMTQzLjg0NCwxNC4xOTEgMTQ0Ljg2LDEyLjc2MyAxNDYuNzA1LDExLjY5OCBMMTU2LjE5OCw2LjA5MSBDMTU2LjMwOSw2LjAyNSAxNTYuNDUyLDYuMDYyIDE1Ni41MTgsNi4xNzMgQzE1Ni41ODMsNi4yODQgMTU2LjU0Nyw2LjQyNyAxNTYuNDM2LDYuNDkzIEwxNDYuOTQsMTIuMTAyIEMxNDUuMjQ0LDEzLjA4MSAxNDQuMzEyLDE0LjM2NSAxNDQuMzEyLDE1LjcxOCBDMTQ0LjMxMiwxNy4wNTggMTQ1LjIzLDE4LjMyNiAxNDYuODk3LDE5LjI4OSBDMTUwLjQ0NiwyMS4zMzggMTU2LjI0LDIxLjMyNyAxNTkuODExLDE5LjI2NSBMMTY5LjU1OSwxMy42MzcgQzE2OS42NywxMy41NzMgMTY5LjgxMywxMy42MTEgMTY5Ljg3OCwxMy43MjMgQzE2OS45NDMsMTMuODM0IDE2OS45MDQsMTMuOTc3IDE2OS43OTMsMTQuMDQyIEwxNjAuMDQ1LDE5LjY3IEMxNTguMTg3LDIwLjc0MiAxNTUuNzQ5LDIxLjI3OSAxNTMuMzE2LDIxLjI3OSIgaWQ9IkZpbGwtMjUiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEzLjY3NSw3NS45OTIgTDY3Ljc2Miw0OS40ODQiIGlkPSJGaWxsLTI2IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTExMy42NzUsNzYuMzQyIEMxMTMuNjE1LDc2LjM0MiAxMTMuNTU1LDc2LjMyNyAxMTMuNSw3Ni4yOTUgTDY3LjU4Nyw0OS43ODcgQzY3LjQxOSw0OS42OSA2Ny4zNjIsNDkuNDc2IDY3LjQ1OSw0OS4zMDkgQzY3LjU1Niw0OS4xNDEgNjcuNzcsNDkuMDgzIDY3LjkzNyw0OS4xOCBMMTEzLjg1LDc1LjY4OCBDMTE0LjAxOCw3NS43ODUgMTE0LjA3NSw3NiAxMTMuOTc4LDc2LjE2NyBDMTEzLjkxNCw3Ni4yNzkgMTEzLjc5Niw3Ni4zNDIgMTEzLjY3NSw3Ni4zNDIiIGlkPSJGaWxsLTI3IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTY3Ljc2Miw0OS40ODQgTDY3Ljc2MiwxMDMuNDg1IEM2Ny43NjIsMTA0LjU3NSA2OC41MzIsMTA1LjkwMyA2OS40ODIsMTA2LjQ1MiBMMTExLjk1NSwxMzAuOTczIEMxMTIuOTA1LDEzMS41MjIgMTEzLjY3NSwxMzEuMDgzIDExMy42NzUsMTI5Ljk5MyBMMTEzLjY3NSw3NS45OTIiIGlkPSJGaWxsLTI4IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTExMi43MjcsMTMxLjU2MSBDMTEyLjQzLDEzMS41NjEgMTEyLjEwNywxMzEuNDY2IDExMS43OCwxMzEuMjc2IEw2OS4zMDcsMTA2Ljc1NSBDNjguMjQ0LDEwNi4xNDIgNjcuNDEyLDEwNC43MDUgNjcuNDEyLDEwMy40ODUgTDY3LjQxMiw0OS40ODQgQzY3LjQxMiw0OS4yOSA2Ny41NjksNDkuMTM0IDY3Ljc2Miw0OS4xMzQgQzY3Ljk1Niw0OS4xMzQgNjguMTEzLDQ5LjI5IDY4LjExMyw0OS40ODQgTDY4LjExMywxMDMuNDg1IEM2OC4xMTMsMTA0LjQ0NSA2OC44MiwxMDUuNjY1IDY5LjY1NywxMDYuMTQ4IEwxMTIuMTMsMTMwLjY3IEMxMTIuNDc0LDEzMC44NjggMTEyLjc5MSwxMzAuOTEzIDExMywxMzAuNzkyIEMxMTMuMjA2LDEzMC42NzMgMTEzLjMyNSwxMzAuMzgxIDExMy4zMjUsMTI5Ljk5MyBMMTEzLjMyNSw3NS45OTIgQzExMy4zMjUsNzUuNzk4IDExMy40ODIsNzUuNjQxIDExMy42NzUsNzUuNjQxIEMxMTMuODY5LDc1LjY0MSAxMTQuMDI1LDc1Ljc5OCAxMTQuMDI1LDc1Ljk5MiBMMTE0LjAyNSwxMjkuOTkzIEMxMTQuMDI1LDEzMC42NDggMTEzLjc4NiwxMzEuMTQ3IDExMy4zNSwxMzEuMzk5IEMxMTMuMTYyLDEzMS41MDcgMTEyLjk1MiwxMzEuNTYxIDExMi43MjcsMTMxLjU2MSIgaWQ9IkZpbGwtMjkiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTEyLjg2LDQwLjUxMiBDMTEyLjg2LDQwLjUxMiAxMTIuODYsNDAuNTEyIDExMi44NTksNDAuNTEyIEMxMTAuNTQxLDQwLjUxMiAxMDguMzYsMzkuOTkgMTA2LjcxNywzOS4wNDEgQzEwNS4wMTIsMzguMDU3IDEwNC4wNzQsMzYuNzI2IDEwNC4wNzQsMzUuMjkyIEMxMDQuMDc0LDMzLjg0NyAxMDUuMDI2LDMyLjUwMSAxMDYuNzU0LDMxLjUwNCBMMTE4Ljc5NSwyNC41NTEgQzEyMC40NjMsMjMuNTg5IDEyMi42NjksMjMuMDU4IDEyNS4wMDcsMjMuMDU4IEMxMjcuMzI1LDIzLjA1OCAxMjkuNTA2LDIzLjU4MSAxMzEuMTUsMjQuNTMgQzEzMi44NTQsMjUuNTE0IDEzMy43OTMsMjYuODQ1IDEzMy43OTMsMjguMjc4IEMxMzMuNzkzLDI5LjcyNCAxMzIuODQxLDMxLjA2OSAxMzEuMTEzLDMyLjA2NyBMMTE5LjA3MSwzOS4wMTkgQzExNy40MDMsMzkuOTgyIDExNS4xOTcsNDAuNTEyIDExMi44Niw0MC41MTIgTDExMi44Niw0MC41MTIgWiBNMTI1LjAwNywyMy43NTkgQzEyMi43OSwyMy43NTkgMTIwLjcwOSwyNC4yNTYgMTE5LjE0NiwyNS4xNTggTDEwNy4xMDQsMzIuMTEgQzEwNS42MDIsMzIuOTc4IDEwNC43NzQsMzQuMTA4IDEwNC43NzQsMzUuMjkyIEMxMDQuNzc0LDM2LjQ2NSAxMDUuNTg5LDM3LjU4MSAxMDcuMDY3LDM4LjQzNCBDMTA4LjYwNSwzOS4zMjMgMTEwLjY2MywzOS44MTIgMTEyLjg1OSwzOS44MTIgTDExMi44NiwzOS44MTIgQzExNS4wNzYsMzkuODEyIDExNy4xNTgsMzkuMzE1IDExOC43MjEsMzguNDEzIEwxMzAuNzYyLDMxLjQ2IEMxMzIuMjY0LDMwLjU5MyAxMzMuMDkyLDI5LjQ2MyAxMzMuMDkyLDI4LjI3OCBDMTMzLjA5MiwyNy4xMDYgMTMyLjI3OCwyNS45OSAxMzAuOCwyNS4xMzYgQzEyOS4yNjEsMjQuMjQ4IDEyNy4yMDQsMjMuNzU5IDEyNS4wMDcsMjMuNzU5IEwxMjUuMDA3LDIzLjc1OSBaIiBpZD0iRmlsbC0zMCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNjUuNjMsMTYuMjE5IEwxNTkuODk2LDE5LjUzIEMxNTYuNzI5LDIxLjM1OCAxNTEuNjEsMjEuMzY3IDE0OC40NjMsMTkuNTUgQzE0NS4zMTYsMTcuNzMzIDE0NS4zMzIsMTQuNzc4IDE0OC40OTksMTIuOTQ5IEwxNTQuMjMzLDkuNjM5IEwxNjUuNjMsMTYuMjE5IiBpZD0iRmlsbC0zMSIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xNTQuMjMzLDEwLjQ0OCBMMTY0LjIyOCwxNi4yMTkgTDE1OS41NDYsMTguOTIzIEMxNTguMTEyLDE5Ljc1IDE1Ni4xOTQsMjAuMjA2IDE1NC4xNDcsMjAuMjA2IEMxNTIuMTE4LDIwLjIwNiAxNTAuMjI0LDE5Ljc1NyAxNDguODE0LDE4Ljk0MyBDMTQ3LjUyNCwxOC4xOTkgMTQ2LjgxNCwxNy4yNDkgMTQ2LjgxNCwxNi4yNjkgQzE0Ni44MTQsMTUuMjc4IDE0Ny41MzcsMTQuMzE0IDE0OC44NSwxMy41NTYgTDE1NC4yMzMsMTAuNDQ4IE0xNTQuMjMzLDkuNjM5IEwxNDguNDk5LDEyLjk0OSBDMTQ1LjMzMiwxNC43NzggMTQ1LjMxNiwxNy43MzMgMTQ4LjQ2MywxOS41NSBDMTUwLjAzMSwyMC40NTUgMTUyLjA4NiwyMC45MDcgMTU0LjE0NywyMC45MDcgQzE1Ni4yMjQsMjAuOTA3IDE1OC4zMDYsMjAuNDQ3IDE1OS44OTYsMTkuNTMgTDE2NS42MywxNi4yMTkgTDE1NC4yMzMsOS42MzkiIGlkPSJGaWxsLTMyIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0NS40NDUsNzIuNjY3IEwxNDUuNDQ1LDcyLjY2NyBDMTQzLjY3Miw3Mi42NjcgMTQyLjIwNCw3MS44MTcgMTQxLjIwMiw3MC40MjIgQzE0MS4xMzUsNzAuMzMgMTQxLjE0NSw3MC4xNDcgMTQxLjIyNSw3MC4wNjYgQzE0MS4zMDUsNjkuOTg1IDE0MS40MzIsNjkuOTQ2IDE0MS41MjUsNzAuMDExIEMxNDIuMzA2LDcwLjU1OSAxNDMuMjMxLDcwLjgyMyAxNDQuMjc2LDcwLjgyMiBDMTQ1LjU5OCw3MC44MjIgMTQ3LjAzLDcwLjM3NiAxNDguNTMyLDY5LjUwOSBDMTUzLjg0Miw2Ni40NDMgMTU4LjE2Myw1OC45ODcgMTU4LjE2Myw1Mi44OTQgQzE1OC4xNjMsNTAuOTY3IDE1Ny43MjEsNDkuMzMyIDE1Ni44ODQsNDguMTY4IEMxNTYuODE4LDQ4LjA3NiAxNTYuODI4LDQ3Ljk0OCAxNTYuOTA4LDQ3Ljg2NyBDMTU2Ljk4OCw0Ny43ODYgMTU3LjExNCw0Ny43NzQgMTU3LjIwOCw0Ny44NCBDMTU4Ljg3OCw0OS4wMTIgMTU5Ljc5OCw1MS4yMiAxNTkuNzk4LDU0LjA1OSBDMTU5Ljc5OCw2MC4zMDEgMTU1LjM3Myw2OC4wNDYgMTQ5LjkzMyw3MS4xODYgQzE0OC4zNiw3Mi4wOTQgMTQ2Ljg1LDcyLjY2NyAxNDUuNDQ1LDcyLjY2NyBMMTQ1LjQ0NSw3Mi42NjcgWiBNMTQyLjQ3Niw3MSBDMTQzLjI5LDcxLjY1MSAxNDQuMjk2LDcyLjAwMiAxNDUuNDQ1LDcyLjAwMiBDMTQ2Ljc2Nyw3Mi4wMDIgMTQ4LjE5OCw3MS41NSAxNDkuNyw3MC42ODIgQzE1NS4wMSw2Ny42MTcgMTU5LjMzMSw2MC4xNTkgMTU5LjMzMSw1NC4wNjUgQzE1OS4zMzEsNTIuMDg1IDE1OC44NjgsNTAuNDM1IDE1OC4wMDYsNDkuMjcyIEMxNTguNDE3LDUwLjMwNyAxNTguNjMsNTEuNTMyIDE1OC42Myw1Mi44OTIgQzE1OC42Myw1OS4xMzQgMTU0LjIwNSw2Ni43NjcgMTQ4Ljc2NSw2OS45MDcgQzE0Ny4xOTIsNzAuODE2IDE0NS42ODEsNzEuMjgzIDE0NC4yNzYsNzEuMjgzIEMxNDMuNjM0LDcxLjI4MyAxNDMuMDMzLDcxLjE5MiAxNDIuNDc2LDcxIEwxNDIuNDc2LDcxIFoiIGlkPSJGaWxsLTMzIiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0OC42NDgsNjkuNzA0IEMxNTQuMDMyLDY2LjU5NiAxNTguMzk2LDU5LjA2OCAxNTguMzk2LDUyLjg5MSBDMTU4LjM5Niw1MC44MzkgMTU3LjkxMyw0OS4xOTggMTU3LjA3NCw0OC4wMyBDMTU1LjI4OSw0Ni43NzggMTUyLjY5OSw0Ni44MzYgMTQ5LjgxNiw0OC41MDEgQzE0NC40MzMsNTEuNjA5IDE0MC4wNjgsNTkuMTM3IDE0MC4wNjgsNjUuMzE0IEMxNDAuMDY4LDY3LjM2NSAxNDAuNTUyLDY5LjAwNiAxNDEuMzkxLDcwLjE3NCBDMTQzLjE3Niw3MS40MjcgMTQ1Ljc2NSw3MS4zNjkgMTQ4LjY0OCw2OS43MDQiIGlkPSJGaWxsLTM0IiBmaWxsPSIjRkFGQUZBIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTE0NC4yNzYsNzEuMjc2IEwxNDQuMjc2LDcxLjI3NiBDMTQzLjEzMyw3MS4yNzYgMTQyLjExOCw3MC45NjkgMTQxLjI1Nyw3MC4zNjUgQzE0MS4yMzYsNzAuMzUxIDE0MS4yMTcsNzAuMzMyIDE0MS4yMDIsNzAuMzExIEMxNDAuMzA3LDY5LjA2NyAxMzkuODM1LDY3LjMzOSAxMzkuODM1LDY1LjMxNCBDMTM5LjgzNSw1OS4wNzMgMTQ0LjI2LDUxLjQzOSAxNDkuNyw0OC4yOTggQzE1MS4yNzMsNDcuMzkgMTUyLjc4NCw0Ni45MjkgMTU0LjE4OSw0Ni45MjkgQzE1NS4zMzIsNDYuOTI5IDE1Ni4zNDcsNDcuMjM2IDE1Ny4yMDgsNDcuODM5IEMxNTcuMjI5LDQ3Ljg1NCAxNTcuMjQ4LDQ3Ljg3MyAxNTcuMjYzLDQ3Ljg5NCBDMTU4LjE1Nyw0OS4xMzggMTU4LjYzLDUwLjg2NSAxNTguNjMsNTIuODkxIEMxNTguNjMsNTkuMTMyIDE1NC4yMDUsNjYuNzY2IDE0OC43NjUsNjkuOTA3IEMxNDcuMTkyLDcwLjgxNSAxNDUuNjgxLDcxLjI3NiAxNDQuMjc2LDcxLjI3NiBMMTQ0LjI3Niw3MS4yNzYgWiBNMTQxLjU1OCw3MC4xMDQgQzE0Mi4zMzEsNzAuNjM3IDE0My4yNDUsNzEuMDA1IDE0NC4yNzYsNzEuMDA1IEMxNDUuNTk4LDcxLjAwNSAxNDcuMDMsNzAuNDY3IDE0OC41MzIsNjkuNiBDMTUzLjg0Miw2Ni41MzQgMTU4LjE2Myw1OS4wMzMgMTU4LjE2Myw1Mi45MzkgQzE1OC4xNjMsNTEuMDMxIDE1Ny43MjksNDkuMzg1IDE1Ni45MDcsNDguMjIzIEMxNTYuMTMzLDQ3LjY5MSAxNTUuMjE5LDQ3LjQwOSAxNTQuMTg5LDQ3LjQwOSBDMTUyLjg2Nyw0Ny40MDkgMTUxLjQzNSw0Ny44NDIgMTQ5LjkzMyw0OC43MDkgQzE0NC42MjMsNTEuNzc1IDE0MC4zMDIsNTkuMjczIDE0MC4zMDIsNjUuMzY2IEMxNDAuMzAyLDY3LjI3NiAxNDAuNzM2LDY4Ljk0MiAxNDEuNTU4LDcwLjEwNCBMMTQxLjU1OCw3MC4xMDQgWiIgaWQ9IkZpbGwtMzUiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTUwLjcyLDY1LjM2MSBMMTUwLjM1Nyw2NS4wNjYgQzE1MS4xNDcsNjQuMDkyIDE1MS44NjksNjMuMDQgMTUyLjUwNSw2MS45MzggQzE1My4zMTMsNjAuNTM5IDE1My45NzgsNTkuMDY3IDE1NC40ODIsNTcuNTYzIEwxNTQuOTI1LDU3LjcxMiBDMTU0LjQxMiw1OS4yNDUgMTUzLjczMyw2MC43NDUgMTUyLjkxLDYyLjE3MiBDMTUyLjI2Miw2My4yOTUgMTUxLjUyNSw2NC4zNjggMTUwLjcyLDY1LjM2MSIgaWQ9IkZpbGwtMzYiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTE1LjkxNyw4NC41MTQgTDExNS41NTQsODQuMjIgQzExNi4zNDQsODMuMjQ1IDExNy4wNjYsODIuMTk0IDExNy43MDIsODEuMDkyIEMxMTguNTEsNzkuNjkyIDExOS4xNzUsNzguMjIgMTE5LjY3OCw3Ni43MTcgTDEyMC4xMjEsNzYuODY1IEMxMTkuNjA4LDc4LjM5OCAxMTguOTMsNzkuODk5IDExOC4xMDYsODEuMzI2IEMxMTcuNDU4LDgyLjQ0OCAxMTYuNzIyLDgzLjUyMSAxMTUuOTE3LDg0LjUxNCIgaWQ9IkZpbGwtMzciIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTE0LDEzMC40NzYgTDExNCwxMzAuMDA4IEwxMTQsNzYuMDUyIEwxMTQsNzUuNTg0IEwxMTQsNzYuMDUyIEwxMTQsMTMwLjAwOCBMMTE0LDEzMC40NzYiIGlkPSJGaWxsLTM4IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgICAgICA8ZyBpZD0iSW1wb3J0ZWQtTGF5ZXJzLUNvcHkiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYyLjAwMDAwMCwgMC4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTkuODIyLDM3LjQ3NCBDMTkuODM5LDM3LjMzOSAxOS43NDcsMzcuMTk0IDE5LjU1NSwzNy4wODIgQzE5LjIyOCwzNi44OTQgMTguNzI5LDM2Ljg3MiAxOC40NDYsMzcuMDM3IEwxMi40MzQsNDAuNTA4IEMxMi4zMDMsNDAuNTg0IDEyLjI0LDQwLjY4NiAxMi4yNDMsNDAuNzkzIEMxMi4yNDUsNDAuOTI1IDEyLjI0NSw0MS4yNTQgMTIuMjQ1LDQxLjM3MSBMMTIuMjQ1LDQxLjQxNCBMMTIuMjM4LDQxLjU0MiBDOC4xNDgsNDMuODg3IDUuNjQ3LDQ1LjMyMSA1LjY0Nyw0NS4zMjEgQzUuNjQ2LDQ1LjMyMSAzLjU3LDQ2LjM2NyAyLjg2LDUwLjUxMyBDMi44Niw1MC41MTMgMS45NDgsNTcuNDc0IDEuOTYyLDcwLjI1OCBDMS45NzcsODIuODI4IDIuNTY4LDg3LjMyOCAzLjEyOSw5MS42MDkgQzMuMzQ5LDkzLjI5MyA2LjEzLDkzLjczNCA2LjEzLDkzLjczNCBDNi40NjEsOTMuNzc0IDYuODI4LDkzLjcwNyA3LjIxLDkzLjQ4NiBMODIuNDgzLDQ5LjkzNSBDODQuMjkxLDQ4Ljg2NiA4NS4xNSw0Ni4yMTYgODUuNTM5LDQzLjY1MSBDODYuNzUyLDM1LjY2MSA4Ny4yMTQsMTAuNjczIDg1LjI2NCwzLjc3MyBDODUuMDY4LDMuMDggODQuNzU0LDIuNjkgODQuMzk2LDIuNDkxIEw4Mi4zMSwxLjcwMSBDODEuNTgzLDEuNzI5IDgwLjg5NCwyLjE2OCA4MC43NzYsMi4yMzYgQzgwLjYzNiwyLjMxNyA0MS44MDcsMjQuNTg1IDIwLjAzMiwzNy4wNzIgTDE5LjgyMiwzNy40NzQiIGlkPSJGaWxsLTEiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNODIuMzExLDEuNzAxIEw4NC4zOTYsMi40OTEgQzg0Ljc1NCwyLjY5IDg1LjA2OCwzLjA4IDg1LjI2NCwzLjc3MyBDODcuMjEzLDEwLjY3MyA4Ni43NTEsMzUuNjYgODUuNTM5LDQzLjY1MSBDODUuMTQ5LDQ2LjIxNiA4NC4yOSw0OC44NjYgODIuNDgzLDQ5LjkzNSBMNy4yMSw5My40ODYgQzYuODk3LDkzLjY2NyA2LjU5NSw5My43NDQgNi4zMTQsOTMuNzQ0IEw2LjEzMSw5My43MzMgQzYuMTMxLDkzLjczNCAzLjM0OSw5My4yOTMgMy4xMjgsOTEuNjA5IEMyLjU2OCw4Ny4zMjcgMS45NzcsODIuODI4IDEuOTYzLDcwLjI1OCBDMS45NDgsNTcuNDc0IDIuODYsNTAuNTEzIDIuODYsNTAuNTEzIEMzLjU3LDQ2LjM2NyA1LjY0Nyw0NS4zMjEgNS42NDcsNDUuMzIxIEM1LjY0Nyw0NS4zMjEgOC4xNDgsNDMuODg3IDEyLjIzOCw0MS41NDIgTDEyLjI0NSw0MS40MTQgTDEyLjI0NSw0MS4zNzEgQzEyLjI0NSw0MS4yNTQgMTIuMjQ1LDQwLjkyNSAxMi4yNDMsNDAuNzkzIEMxMi4yNCw0MC42ODYgMTIuMzAyLDQwLjU4MyAxMi40MzQsNDAuNTA4IEwxOC40NDYsMzcuMDM2IEMxOC41NzQsMzYuOTYyIDE4Ljc0NiwzNi45MjYgMTguOTI3LDM2LjkyNiBDMTkuMTQ1LDM2LjkyNiAxOS4zNzYsMzYuOTc5IDE5LjU1NCwzNy4wODIgQzE5Ljc0NywzNy4xOTQgMTkuODM5LDM3LjM0IDE5LjgyMiwzNy40NzQgTDIwLjAzMywzNy4wNzIgQzQxLjgwNiwyNC41ODUgODAuNjM2LDIuMzE4IDgwLjc3NywyLjIzNiBDODAuODk0LDIuMTY4IDgxLjU4MywxLjcyOSA4Mi4zMTEsMS43MDEgTTgyLjMxMSwwLjcwNCBMODIuMjcyLDAuNzA1IEM4MS42NTQsMC43MjggODAuOTg5LDAuOTQ5IDgwLjI5OCwxLjM2MSBMODAuMjc3LDEuMzczIEM4MC4xMjksMS40NTggNTkuNzY4LDEzLjEzNSAxOS43NTgsMzYuMDc5IEMxOS41LDM1Ljk4MSAxOS4yMTQsMzUuOTI5IDE4LjkyNywzNS45MjkgQzE4LjU2MiwzNS45MjkgMTguMjIzLDM2LjAxMyAxNy45NDcsMzYuMTczIEwxMS45MzUsMzkuNjQ0IEMxMS40OTMsMzkuODk5IDExLjIzNiw0MC4zMzQgMTEuMjQ2LDQwLjgxIEwxMS4yNDcsNDAuOTYgTDUuMTY3LDQ0LjQ0NyBDNC43OTQsNDQuNjQ2IDIuNjI1LDQ1Ljk3OCAxLjg3Nyw1MC4zNDUgTDEuODcxLDUwLjM4NCBDMS44NjIsNTAuNDU0IDAuOTUxLDU3LjU1NyAwLjk2NSw3MC4yNTkgQzAuOTc5LDgyLjg3OSAxLjU2OCw4Ny4zNzUgMi4xMzcsOTEuNzI0IEwyLjEzOSw5MS43MzkgQzIuNDQ3LDk0LjA5NCA1LjYxNCw5NC42NjIgNS45NzUsOTQuNzE5IEw2LjAwOSw5NC43MjMgQzYuMTEsOTQuNzM2IDYuMjEzLDk0Ljc0MiA2LjMxNCw5NC43NDIgQzYuNzksOTQuNzQyIDcuMjYsOTQuNjEgNy43MSw5NC4zNSBMODIuOTgzLDUwLjc5OCBDODQuNzk0LDQ5LjcyNyA4NS45ODIsNDcuMzc1IDg2LjUyNSw0My44MDEgQzg3LjcxMSwzNS45ODcgODguMjU5LDEwLjcwNSA4Ni4yMjQsMy41MDIgQzg1Ljk3MSwyLjYwOSA4NS41MiwxLjk3NSA4NC44ODEsMS42MiBMODQuNzQ5LDEuNTU4IEw4Mi42NjQsMC43NjkgQzgyLjU1MSwwLjcyNSA4Mi40MzEsMC43MDQgODIuMzExLDAuNzA0IiBpZD0iRmlsbC0yIiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTY2LjI2NywxMS41NjUgTDY3Ljc2MiwxMS45OTkgTDExLjQyMyw0NC4zMjUiIGlkPSJGaWxsLTMiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMjAyLDkwLjU0NSBDMTIuMDI5LDkwLjU0NSAxMS44NjIsOTAuNDU1IDExLjc2OSw5MC4yOTUgQzExLjYzMiw5MC4wNTcgMTEuNzEzLDg5Ljc1MiAxMS45NTIsODkuNjE0IEwzMC4zODksNzguOTY5IEMzMC42MjgsNzguODMxIDMwLjkzMyw3OC45MTMgMzEuMDcxLDc5LjE1MiBDMzEuMjA4LDc5LjM5IDMxLjEyNyw3OS42OTYgMzAuODg4LDc5LjgzMyBMMTIuNDUxLDkwLjQ3OCBMMTIuMjAyLDkwLjU0NSIgaWQ9IkZpbGwtNCIgZmlsbD0iIzYwN0Q4QiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMy43NjQsNDIuNjU0IEwxMy42NTYsNDIuNTkyIEwxMy43MDIsNDIuNDIxIEwxOC44MzcsMzkuNDU3IEwxOS4wMDcsMzkuNTAyIEwxOC45NjIsMzkuNjczIEwxMy44MjcsNDIuNjM3IEwxMy43NjQsNDIuNjU0IiBpZD0iRmlsbC01IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTguNTIsOTAuMzc1IEw4LjUyLDQ2LjQyMSBMOC41ODMsNDYuMzg1IEw3NS44NCw3LjU1NCBMNzUuODQsNTEuNTA4IEw3NS43NzgsNTEuNTQ0IEw4LjUyLDkwLjM3NSBMOC41Miw5MC4zNzUgWiBNOC43Nyw0Ni41NjQgTDguNzcsODkuOTQ0IEw3NS41OTEsNTEuMzY1IEw3NS41OTEsNy45ODUgTDguNzcsNDYuNTY0IEw4Ljc3LDQ2LjU2NCBaIiBpZD0iRmlsbC02IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTI0Ljk4Niw4My4xODIgQzI0Ljc1Niw4My4zMzEgMjQuMzc0LDgzLjU2NiAyNC4xMzcsODMuNzA1IEwxMi42MzIsOTAuNDA2IEMxMi4zOTUsOTAuNTQ1IDEyLjQyNiw5MC42NTggMTIuNyw5MC42NTggTDEzLjI2NSw5MC42NTggQzEzLjU0LDkwLjY1OCAxMy45NTgsOTAuNTQ1IDE0LjE5NSw5MC40MDYgTDI1LjcsODMuNzA1IEMyNS45MzcsODMuNTY2IDI2LjEyOCw4My40NTIgMjYuMTI1LDgzLjQ0OSBDMjYuMTIyLDgzLjQ0NyAyNi4xMTksODMuMjIgMjYuMTE5LDgyLjk0NiBDMjYuMTE5LDgyLjY3MiAyNS45MzEsODIuNTY5IDI1LjcwMSw4Mi43MTkgTDI0Ljk4Niw4My4xODIiIGlkPSJGaWxsLTciIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTMuMjY2LDkwLjc4MiBMMTIuNyw5MC43ODIgQzEyLjUsOTAuNzgyIDEyLjM4NCw5MC43MjYgMTIuMzU0LDkwLjYxNiBDMTIuMzI0LDkwLjUwNiAxMi4zOTcsOTAuMzk5IDEyLjU2OSw5MC4yOTkgTDI0LjA3NCw4My41OTcgQzI0LjMxLDgzLjQ1OSAyNC42ODksODMuMjI2IDI0LjkxOCw4My4wNzggTDI1LjYzMyw4Mi42MTQgQzI1LjcyMyw4Mi41NTUgMjUuODEzLDgyLjUyNSAyNS44OTksODIuNTI1IEMyNi4wNzEsODIuNTI1IDI2LjI0NCw4Mi42NTUgMjYuMjQ0LDgyLjk0NiBDMjYuMjQ0LDgzLjE2IDI2LjI0NSw4My4zMDkgMjYuMjQ3LDgzLjM4MyBMMjYuMjUzLDgzLjM4NyBMMjYuMjQ5LDgzLjQ1NiBDMjYuMjQ2LDgzLjUzMSAyNi4yNDYsODMuNTMxIDI1Ljc2Myw4My44MTIgTDE0LjI1OCw5MC41MTQgQzE0LDkwLjY2NSAxMy41NjQsOTAuNzgyIDEzLjI2Niw5MC43ODIgTDEzLjI2Niw5MC43ODIgWiBNMTIuNjY2LDkwLjUzMiBMMTIuNyw5MC41MzMgTDEzLjI2Niw5MC41MzMgQzEzLjUxOCw5MC41MzMgMTMuOTE1LDkwLjQyNSAxNC4xMzIsOTAuMjk5IEwyNS42MzcsODMuNTk3IEMyNS44MDUsODMuNDk5IDI1LjkzMSw4My40MjQgMjUuOTk4LDgzLjM4MyBDMjUuOTk0LDgzLjI5OSAyNS45OTQsODMuMTY1IDI1Ljk5NCw4Mi45NDYgTDI1Ljg5OSw4Mi43NzUgTDI1Ljc2OCw4Mi44MjQgTDI1LjA1NCw4My4yODcgQzI0LjgyMiw4My40MzcgMjQuNDM4LDgzLjY3MyAyNC4yLDgzLjgxMiBMMTIuNjk1LDkwLjUxNCBMMTIuNjY2LDkwLjUzMiBMMTIuNjY2LDkwLjUzMiBaIiBpZD0iRmlsbC04IiBmaWxsPSIjNjA3RDhCIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEzLjI2Niw4OS44NzEgTDEyLjcsODkuODcxIEMxMi41LDg5Ljg3MSAxMi4zODQsODkuODE1IDEyLjM1NCw4OS43MDUgQzEyLjMyNCw4OS41OTUgMTIuMzk3LDg5LjQ4OCAxMi41NjksODkuMzg4IEwyNC4wNzQsODIuNjg2IEMyNC4zMzIsODIuNTM1IDI0Ljc2OCw4Mi40MTggMjUuMDY3LDgyLjQxOCBMMjUuNjMyLDgyLjQxOCBDMjUuODMyLDgyLjQxOCAyNS45NDgsODIuNDc0IDI1Ljk3OCw4Mi41ODQgQzI2LjAwOCw4Mi42OTQgMjUuOTM1LDgyLjgwMSAyNS43NjMsODIuOTAxIEwxNC4yNTgsODkuNjAzIEMxNCw4OS43NTQgMTMuNTY0LDg5Ljg3MSAxMy4yNjYsODkuODcxIEwxMy4yNjYsODkuODcxIFogTTEyLjY2Niw4OS42MjEgTDEyLjcsODkuNjIyIEwxMy4yNjYsODkuNjIyIEMxMy41MTgsODkuNjIyIDEzLjkxNSw4OS41MTUgMTQuMTMyLDg5LjM4OCBMMjUuNjM3LDgyLjY4NiBMMjUuNjY3LDgyLjY2OCBMMjUuNjMyLDgyLjY2NyBMMjUuMDY3LDgyLjY2NyBDMjQuODE1LDgyLjY2NyAyNC40MTgsODIuNzc1IDI0LjIsODIuOTAxIEwxMi42OTUsODkuNjAzIEwxMi42NjYsODkuNjIxIEwxMi42NjYsODkuNjIxIFoiIGlkPSJGaWxsLTkiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMTIuMzcsOTAuODAxIEwxMi4zNyw4OS41NTQgTDEyLjM3LDkwLjgwMSIgaWQ9IkZpbGwtMTAiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi4xMyw5My45MDEgQzUuMzc5LDkzLjgwOCA0LjgxNiw5My4xNjQgNC42OTEsOTIuNTI1IEMzLjg2LDg4LjI4NyAzLjU0LDgzLjc0MyAzLjUyNiw3MS4xNzMgQzMuNTExLDU4LjM4OSA0LjQyMyw1MS40MjggNC40MjMsNTEuNDI4IEM1LjEzNCw0Ny4yODIgNy4yMSw0Ni4yMzYgNy4yMSw0Ni4yMzYgQzcuMjEsNDYuMjM2IDgxLjY2NywzLjI1IDgyLjA2OSwzLjAxNyBDODIuMjkyLDIuODg4IDg0LjU1NiwxLjQzMyA4NS4yNjQsMy45NCBDODcuMjE0LDEwLjg0IDg2Ljc1MiwzNS44MjcgODUuNTM5LDQzLjgxOCBDODUuMTUsNDYuMzgzIDg0LjI5MSw0OS4wMzMgODIuNDgzLDUwLjEwMSBMNy4yMSw5My42NTMgQzYuODI4LDkzLjg3NCA2LjQ2MSw5My45NDEgNi4xMyw5My45MDEgQzYuMTMsOTMuOTAxIDMuMzQ5LDkzLjQ2IDMuMTI5LDkxLjc3NiBDMi41NjgsODcuNDk1IDEuOTc3LDgyLjk5NSAxLjk2Miw3MC40MjUgQzEuOTQ4LDU3LjY0MSAyLjg2LDUwLjY4IDIuODYsNTAuNjggQzMuNTcsNDYuNTM0IDUuNjQ3LDQ1LjQ4OSA1LjY0Nyw0NS40ODkgQzUuNjQ2LDQ1LjQ4OSA4LjA2NSw0NC4wOTIgMTIuMjQ1LDQxLjY3OSBMMTMuMTE2LDQxLjU2IEwxOS43MTUsMzcuNzMgTDE5Ljc2MSwzNy4yNjkgTDYuMTMsOTMuOTAxIiBpZD0iRmlsbC0xMSIgZmlsbD0iI0ZBRkFGQSI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjMxNyw5NC4xNjEgTDYuMTAyLDk0LjE0OCBMNi4xMDEsOTQuMTQ4IEw1Ljg1Nyw5NC4xMDEgQzUuMTM4LDkzLjk0NSAzLjA4NSw5My4zNjUgMi44ODEsOTEuODA5IEMyLjMxMyw4Ny40NjkgMS43MjcsODIuOTk2IDEuNzEzLDcwLjQyNSBDMS42OTksNTcuNzcxIDIuNjA0LDUwLjcxOCAyLjYxMyw1MC42NDggQzMuMzM4LDQ2LjQxNyA1LjQ0NSw0NS4zMSA1LjUzNSw0NS4yNjYgTDEyLjE2Myw0MS40MzkgTDEzLjAzMyw0MS4zMiBMMTkuNDc5LDM3LjU3OCBMMTkuNTEzLDM3LjI0NCBDMTkuNTI2LDM3LjEwNyAxOS42NDcsMzcuMDA4IDE5Ljc4NiwzNy4wMjEgQzE5LjkyMiwzNy4wMzQgMjAuMDIzLDM3LjE1NiAyMC4wMDksMzcuMjkzIEwxOS45NSwzNy44ODIgTDEzLjE5OCw0MS44MDEgTDEyLjMyOCw0MS45MTkgTDUuNzcyLDQ1LjcwNCBDNS43NDEsNDUuNzIgMy43ODIsNDYuNzcyIDMuMTA2LDUwLjcyMiBDMy4wOTksNTAuNzgyIDIuMTk4LDU3LjgwOCAyLjIxMiw3MC40MjQgQzIuMjI2LDgyLjk2MyAyLjgwOSw4Ny40MiAzLjM3Myw5MS43MjkgQzMuNDY0LDkyLjQyIDQuMDYyLDkyLjg4MyA0LjY4Miw5My4xODEgQzQuNTY2LDkyLjk4NCA0LjQ4Niw5Mi43NzYgNC40NDYsOTIuNTcyIEMzLjY2NSw4OC41ODggMy4yOTEsODQuMzcgMy4yNzYsNzEuMTczIEMzLjI2Miw1OC41MiA0LjE2Nyw1MS40NjYgNC4xNzYsNTEuMzk2IEM0LjkwMSw0Ny4xNjUgNy4wMDgsNDYuMDU5IDcuMDk4LDQ2LjAxNCBDNy4wOTQsNDYuMDE1IDgxLjU0MiwzLjAzNCA4MS45NDQsMi44MDIgTDgxLjk3MiwyLjc4NSBDODIuODc2LDIuMjQ3IDgzLjY5MiwyLjA5NyA4NC4zMzIsMi4zNTIgQzg0Ljg4NywyLjU3MyA4NS4yODEsMy4wODUgODUuNTA0LDMuODcyIEM4Ny41MTgsMTEgODYuOTY0LDM2LjA5MSA4NS43ODUsNDMuODU1IEM4NS4yNzgsNDcuMTk2IDg0LjIxLDQ5LjM3IDgyLjYxLDUwLjMxNyBMNy4zMzUsOTMuODY5IEM2Ljk5OSw5NC4wNjMgNi42NTgsOTQuMTYxIDYuMzE3LDk0LjE2MSBMNi4zMTcsOTQuMTYxIFogTTYuMTcsOTMuNjU0IEM2LjQ2Myw5My42OSA2Ljc3NCw5My42MTcgNy4wODUsOTMuNDM3IEw4Mi4zNTgsNDkuODg2IEM4NC4xODEsNDguODA4IDg0Ljk2LDQ1Ljk3MSA4NS4yOTIsNDMuNzggQzg2LjQ2NiwzNi4wNDkgODcuMDIzLDExLjA4NSA4NS4wMjQsNC4wMDggQzg0Ljg0NiwzLjM3NyA4NC41NTEsMi45NzYgODQuMTQ4LDIuODE2IEM4My42NjQsMi42MjMgODIuOTgyLDIuNzY0IDgyLjIyNywzLjIxMyBMODIuMTkzLDMuMjM0IEM4MS43OTEsMy40NjYgNy4zMzUsNDYuNDUyIDcuMzM1LDQ2LjQ1MiBDNy4zMDQsNDYuNDY5IDUuMzQ2LDQ3LjUyMSA0LjY2OSw1MS40NzEgQzQuNjYyLDUxLjUzIDMuNzYxLDU4LjU1NiAzLjc3NSw3MS4xNzMgQzMuNzksODQuMzI4IDQuMTYxLDg4LjUyNCA0LjkzNiw5Mi40NzYgQzUuMDI2LDkyLjkzNyA1LjQxMiw5My40NTkgNS45NzMsOTMuNjE1IEM2LjA4Nyw5My42NCA2LjE1OCw5My42NTIgNi4xNjksOTMuNjU0IEw2LjE3LDkzLjY1NCBMNi4xNyw5My42NTQgWiIgaWQ9IkZpbGwtMTIiIGZpbGw9IiM0NTVBNjQiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNy4zMTcsNjguOTgyIEM3LjgwNiw2OC43MDEgOC4yMDIsNjguOTI2IDguMjAyLDY5LjQ4NyBDOC4yMDIsNzAuMDQ3IDcuODA2LDcwLjczIDcuMzE3LDcxLjAxMiBDNi44MjksNzEuMjk0IDYuNDMzLDcxLjA2OSA2LjQzMyw3MC41MDggQzYuNDMzLDY5Ljk0OCA2LjgyOSw2OS4yNjUgNy4zMTcsNjguOTgyIiBpZD0iRmlsbC0xMyIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjkyLDcxLjEzMyBDNi42MzEsNzEuMTMzIDYuNDMzLDcwLjkwNSA2LjQzMyw3MC41MDggQzYuNDMzLDY5Ljk0OCA2LjgyOSw2OS4yNjUgNy4zMTcsNjguOTgyIEM3LjQ2LDY4LjkgNy41OTUsNjguODYxIDcuNzE0LDY4Ljg2MSBDOC4wMDMsNjguODYxIDguMjAyLDY5LjA5IDguMjAyLDY5LjQ4NyBDOC4yMDIsNzAuMDQ3IDcuODA2LDcwLjczIDcuMzE3LDcxLjAxMiBDNy4xNzQsNzEuMDk0IDcuMDM5LDcxLjEzMyA2LjkyLDcxLjEzMyBNNy43MTQsNjguNjc0IEM3LjU1Nyw2OC42NzQgNy4zOTIsNjguNzIzIDcuMjI0LDY4LjgyMSBDNi42NzYsNjkuMTM4IDYuMjQ2LDY5Ljg3OSA2LjI0Niw3MC41MDggQzYuMjQ2LDcwLjk5NCA2LjUxNyw3MS4zMiA2LjkyLDcxLjMyIEM3LjA3OCw3MS4zMiA3LjI0Myw3MS4yNzEgNy40MTEsNzEuMTc0IEM3Ljk1OSw3MC44NTcgOC4zODksNzAuMTE3IDguMzg5LDY5LjQ4NyBDOC4zODksNjkuMDAxIDguMTE3LDY4LjY3NCA3LjcxNCw2OC42NzQiIGlkPSJGaWxsLTE0IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTYuOTIsNzAuOTQ3IEM2LjY0OSw3MC45NDcgNi42MjEsNzAuNjQgNi42MjEsNzAuNTA4IEM2LjYyMSw3MC4wMTcgNi45ODIsNjkuMzkyIDcuNDExLDY5LjE0NSBDNy41MjEsNjkuMDgyIDcuNjI1LDY5LjA0OSA3LjcxNCw2OS4wNDkgQzcuOTg2LDY5LjA0OSA4LjAxNSw2OS4zNTUgOC4wMTUsNjkuNDg3IEM4LjAxNSw2OS45NzggNy42NTIsNzAuNjAzIDcuMjI0LDcwLjg1MSBDNy4xMTUsNzAuOTE0IDcuMDEsNzAuOTQ3IDYuOTIsNzAuOTQ3IE03LjcxNCw2OC44NjEgQzcuNTk1LDY4Ljg2MSA3LjQ2LDY4LjkgNy4zMTcsNjguOTgyIEM2LjgyOSw2OS4yNjUgNi40MzMsNjkuOTQ4IDYuNDMzLDcwLjUwOCBDNi40MzMsNzAuOTA1IDYuNjMxLDcxLjEzMyA2LjkyLDcxLjEzMyBDNy4wMzksNzEuMTMzIDcuMTc0LDcxLjA5NCA3LjMxNyw3MS4wMTIgQzcuODA2LDcwLjczIDguMjAyLDcwLjA0NyA4LjIwMiw2OS40ODcgQzguMjAyLDY5LjA5IDguMDAzLDY4Ljg2MSA3LjcxNCw2OC44NjEiIGlkPSJGaWxsLTE1IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTcuNDQ0LDg1LjM1IEM3LjcwOCw4NS4xOTggNy45MjEsODUuMzE5IDcuOTIxLDg1LjYyMiBDNy45MjEsODUuOTI1IDcuNzA4LDg2LjI5MiA3LjQ0NCw4Ni40NDQgQzcuMTgxLDg2LjU5NyA2Ljk2Nyw4Ni40NzUgNi45NjcsODYuMTczIEM2Ljk2Nyw4NS44NzEgNy4xODEsODUuNTAyIDcuNDQ0LDg1LjM1IiBpZD0iRmlsbC0xNiIgZmlsbD0iI0ZGRkZGRiI+PC9wYXRoPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik03LjIzLDg2LjUxIEM3LjA3NCw4Ni41MSA2Ljk2Nyw4Ni4zODcgNi45NjcsODYuMTczIEM2Ljk2Nyw4NS44NzEgNy4xODEsODUuNTAyIDcuNDQ0LDg1LjM1IEM3LjUyMSw4NS4zMDUgNy41OTQsODUuMjg0IDcuNjU4LDg1LjI4NCBDNy44MTQsODUuMjg0IDcuOTIxLDg1LjQwOCA3LjkyMSw4NS42MjIgQzcuOTIxLDg1LjkyNSA3LjcwOCw4Ni4yOTIgNy40NDQsODYuNDQ0IEM3LjM2Nyw4Ni40ODkgNy4yOTQsODYuNTEgNy4yMyw4Ni41MSBNNy42NTgsODUuMDk4IEM3LjU1OCw4NS4wOTggNy40NTUsODUuMTI3IDcuMzUxLDg1LjE4OCBDNy4wMzEsODUuMzczIDYuNzgxLDg1LjgwNiA2Ljc4MSw4Ni4xNzMgQzYuNzgxLDg2LjQ4MiA2Ljk2Niw4Ni42OTcgNy4yMyw4Ni42OTcgQzcuMzMsODYuNjk3IDcuNDMzLDg2LjY2NiA3LjUzOCw4Ni42MDcgQzcuODU4LDg2LjQyMiA4LjEwOCw4NS45ODkgOC4xMDgsODUuNjIyIEM4LjEwOCw4NS4zMTMgNy45MjMsODUuMDk4IDcuNjU4LDg1LjA5OCIgaWQ9IkZpbGwtMTciIGZpbGw9IiM4MDk3QTIiPjwvcGF0aD4KICAgICAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNy4yMyw4Ni4zMjIgTDcuMTU0LDg2LjE3MyBDNy4xNTQsODUuOTM4IDcuMzMzLDg1LjYyOSA3LjUzOCw4NS41MTIgTDcuNjU4LDg1LjQ3MSBMNy43MzQsODUuNjIyIEM3LjczNCw4NS44NTYgNy41NTUsODYuMTY0IDcuMzUxLDg2LjI4MiBMNy4yMyw4Ni4zMjIgTTcuNjU4LDg1LjI4NCBDNy41OTQsODUuMjg0IDcuNTIxLDg1LjMwNSA3LjQ0NCw4NS4zNSBDNy4xODEsODUuNTAyIDYuOTY3LDg1Ljg3MSA2Ljk2Nyw4Ni4xNzMgQzYuOTY3LDg2LjM4NyA3LjA3NCw4Ni41MSA3LjIzLDg2LjUxIEM3LjI5NCw4Ni41MSA3LjM2Nyw4Ni40ODkgNy40NDQsODYuNDQ0IEM3LjcwOCw4Ni4yOTIgNy45MjEsODUuOTI1IDcuOTIxLDg1LjYyMiBDNy45MjEsODUuNDA4IDcuODE0LDg1LjI4NCA3LjY1OCw4NS4yODQiIGlkPSJGaWxsLTE4IiBmaWxsPSIjODA5N0EyIj48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTc3LjI3OCw3Ljc2OSBMNzcuMjc4LDUxLjQzNiBMMTAuMjA4LDkwLjE2IEwxMC4yMDgsNDYuNDkzIEw3Ny4yNzgsNy43NjkiIGlkPSJGaWxsLTE5IiBmaWxsPSIjNDU1QTY0Ij48L3BhdGg+CiAgICAgICAgICAgICAgICAgICAgPHBhdGggZD0iTTEwLjA4Myw5MC4zNzUgTDEwLjA4Myw0Ni40MjEgTDEwLjE0Niw0Ni4zODUgTDc3LjQwMyw3LjU1NCBMNzcuNDAzLDUxLjUwOCBMNzcuMzQxLDUxLjU0NCBMMTAuMDgzLDkwLjM3NSBMMTAuMDgzLDkwLjM3NSBaIE0xMC4zMzMsNDYuNTY0IEwxMC4zMzMsODkuOTQ0IEw3Ny4xNTQsNTEuMzY1IEw3Ny4xNTQsNy45ODUgTDEwLjMzMyw0Ni41NjQgTDEwLjMzMyw0Ni41NjQgWiIgaWQ9IkZpbGwtMjAiIGZpbGw9IiM2MDdEOEIiPjwvcGF0aD4KICAgICAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMjUuNzM3LDg4LjY0NyBMMTE4LjA5OCw5MS45ODEgTDExOC4wOTgsODQgTDEwNi42MzksODguNzEzIEwxMDYuNjM5LDk2Ljk4MiBMOTksMTAwLjMxNSBMMTEyLjM2OSwxMDMuOTYxIEwxMjUuNzM3LDg4LjY0NyIgaWQ9IkltcG9ydGVkLUxheWVycy1Db3B5LTIiIGZpbGw9IiM0NTVBNjQiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+")};
a.exports=d},function(a,b,c){function d(a){this.kFilter=a;this.currentAccelMeasurement=new e;this.currentGyroMeasurement=new e;this.previousGyroMeasurement=new e;g.isIOS()?this.filterQ=new f.Quaternion(-1,0,0,1):this.filterQ=new f.Quaternion(1,0,0,1);this.previousFilterQ=new f.Quaternion;this.previousFilterQ.copy(this.filterQ);this.accelQ=new f.Quaternion;this.isOrientationInitialized=!1;this.estimatedGravity=new f.Vector3;this.measuredGravity=new f.Vector3;this.gyroIntegralQ=new f.Quaternion}var e=
c(20),f=c(2),g=c(0);d.prototype.addAccelMeasurement=function(a,b){this.currentAccelMeasurement.set(a,b)};d.prototype.addGyroMeasurement=function(a,b){this.currentGyroMeasurement.set(a,b);g.isTimestampDeltaValid(b-this.previousGyroMeasurement.timestampS)&&this.run_();this.previousGyroMeasurement.copy(this.currentGyroMeasurement)};d.prototype.run_=function(){if(this.isOrientationInitialized){var a=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,this.currentGyroMeasurement.timestampS-
this.previousGyroMeasurement.timestampS);this.gyroIntegralQ.multiply(a);this.filterQ.copy(this.previousFilterQ);this.filterQ.multiply(a);a=new f.Quaternion;a.copy(this.filterQ);a.inverse();this.estimatedGravity.set(0,0,-1);this.estimatedGravity.applyQuaternion(a);this.estimatedGravity.normalize();this.measuredGravity.copy(this.currentAccelMeasurement.sample);this.measuredGravity.normalize();a=new f.Quaternion;a.setFromUnitVectors(this.estimatedGravity,this.measuredGravity);a.inverse();g.isDebug()&&
console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",f.radToDeg*g.getQuaternionAngle(a),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var b=new f.Quaternion;b.copy(this.filterQ);b.multiply(a);this.filterQ.slerp(b,1-this.kFilter);this.previousFilterQ.copy(this.filterQ)}else this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),
this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0};d.prototype.getOrientation=function(){return this.filterQ};d.prototype.accelToQuaternion_=function(a){var b=new f.Vector3;b.copy(a);b.normalize();a=new f.Quaternion;a.setFromUnitVectors(new f.Vector3(0,0,-1),b);a.inverse();return a};d.prototype.gyroToQuaternionDelta_=function(a,b){var c=new f.Quaternion,d=new f.Vector3;d.copy(a);d.normalize();c.setFromAxisAngle(d,a.length()*b);return c};a.exports=d},function(a,b,c){function d(){this.deviceId=
"webvr-polyfill:fused";this.deviceName="VR Position Device (webvr-polyfill:fused)";this.accelerometer=new h.Vector3;this.gyroscope=new h.Vector3;this.start();this.filter=new e(window.WebVRConfig.K_FILTER);this.posePredictor=new f(window.WebVRConfig.PREDICTION_TIME_S);this.touchPanner=new g;this.filterToWorldQ=new h.Quaternion;k.isIOS()?this.filterToWorldQ.setFromAxisAngle(new h.Vector3(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new h.Vector3(1,0,0),-Math.PI/2);this.inverseWorldToScreenQ=
new h.Quaternion;this.worldToScreenQ=new h.Quaternion;this.originalPoseAdjustQ=new h.Quaternion;this.originalPoseAdjustQ.setFromAxisAngle(new h.Vector3(0,0,1),-window.orientation*Math.PI/180);this.setScreenTransform_();k.isLandscapeMode()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ);this.resetQ=new h.Quaternion;this.isFirefoxAndroid=k.isFirefoxAndroid();this.isIOS=k.isIOS();this.orientationOut_=new Float32Array(4)}var e=c(17),f=c(19),g=c(21),h=c(2),k=c(0);d.prototype.getPosition=function(){return null};
d.prototype.getOrientation=function(){var a=this.filter.getOrientation();this.predictedQ=this.posePredictor.getPrediction(a,this.gyroscope,this.previousTimestampS);a=new h.Quaternion;a.copy(this.filterToWorldQ);a.multiply(this.resetQ);window.WebVRConfig.TOUCH_PANNER_DISABLED||a.multiply(this.touchPanner.getOrientation());a.multiply(this.predictedQ);a.multiply(this.worldToScreenQ);window.WebVRConfig.YAW_ONLY&&(a.x=0,a.z=0,a.normalize());this.orientationOut_[0]=a.x;this.orientationOut_[1]=a.y;this.orientationOut_[2]=
a.z;this.orientationOut_[3]=a.w;return this.orientationOut_};d.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation());this.resetQ.x=0;this.resetQ.y=0;this.resetQ.z*=-1;this.resetQ.normalize();k.isLandscapeMode()&&this.resetQ.multiply(this.inverseWorldToScreenQ);this.resetQ.multiply(this.originalPoseAdjustQ);window.WebVRConfig.TOUCH_PANNER_DISABLED||this.touchPanner.resetSensor()};d.prototype.onDeviceMotion_=function(a){this.updateDeviceMotion_(a)};d.prototype.updateDeviceMotion_=
function(a){var b=a.accelerationIncludingGravity,c=a.rotationRate;a=a.timeStamp/1E3;var d=a-this.previousTimestampS;d<=k.MIN_TIMESTEP||d>k.MAX_TIMESTEP?console.warn("Invalid timestamps detected. Time step between successive gyroscope sensor samples is very small or not monotonic"):(this.accelerometer.set(-b.x,-b.y,-b.z),this.gyroscope.set(c.alpha,c.beta,c.gamma),(this.isIOS||this.isFirefoxAndroid)&&this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,a),this.filter.addGyroMeasurement(this.gyroscope,
a));this.previousTimestampS=a};d.prototype.onOrientationChange_=function(a){this.setScreenTransform_()};d.prototype.onMessage_=function(a){(a=a.data)&&a.type&&"devicemotion"===a.type.toLowerCase()&&this.updateDeviceMotion_(a.deviceMotionEvent)};d.prototype.setScreenTransform_=function(){this.worldToScreenQ.set(0,0,0,1);switch(window.orientation){case 90:this.worldToScreenQ.setFromAxisAngle(new h.Vector3(0,0,1),-Math.PI/2);break;case -90:this.worldToScreenQ.setFromAxisAngle(new h.Vector3(0,0,1),Math.PI/
2)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ);this.inverseWorldToScreenQ.inverse()};d.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this);this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this);this.onMessageCallback_=this.onMessage_.bind(this);k.isIOS()&&k.isInsideCrossDomainIFrame()&&window.addEventListener("message",this.onMessageCallback_);window.addEventListener("orientationchange",this.onOrientationChangeCallback_);window.addEventListener("devicemotion",
this.onDeviceMotionCallback_)};d.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_);window.removeEventListener("orientationchange",this.onOrientationChangeCallback_);window.removeEventListener("message",this.onMessageCallback_)};a.exports=d},function(a,b,c){function d(a){this.predictionTimeS=a;this.previousQ=new e.Quaternion;this.previousTimestampS=null;this.deltaQ=new e.Quaternion;this.outQ=new e.Quaternion}var e=c(2),f=c(0);d.prototype.getPrediction=
function(a,b,c){if(!this.previousTimestampS)return this.previousQ.copy(a),this.previousTimestampS=c,a;var d=new e.Vector3;d.copy(b);d.normalize();b=b.length();if(b<20*e.degToRad)return f.isDebug()&&console.log("Moving slowly, at %s deg/s: no prediction",(e.radToDeg*b).toFixed(1)),this.outQ.copy(a),this.previousQ.copy(a),this.outQ;this.deltaQ.setFromAxisAngle(d,b*this.predictionTimeS);this.outQ.copy(this.previousQ);this.outQ.multiply(this.deltaQ);this.previousQ.copy(a);this.previousTimestampS=c;return this.outQ};
a.exports=d},function(a,b){function c(a,b){this.set(a,b)}c.prototype.set=function(a,b){this.sample=a;this.timestampS=b};c.prototype.copy=function(a){this.set(a.sample,a.timestampS)};a.exports=c},function(a,b,c){function d(){window.addEventListener("touchstart",this.onTouchStart_.bind(this));window.addEventListener("touchmove",this.onTouchMove_.bind(this));window.addEventListener("touchend",this.onTouchEnd_.bind(this));this.isTouching=!1;this.rotateStart=new e.Vector2;this.rotateEnd=new e.Vector2;
this.rotateDelta=new e.Vector2;this.theta=0;this.orientation=new e.Quaternion}var e=c(2),f=c(0);d.prototype.getOrientation=function(){this.orientation.setFromEulerXYZ(0,0,this.theta);return this.orientation};d.prototype.resetSensor=function(){this.theta=0};d.prototype.onTouchStart_=function(a){a.touches&&1==a.touches.length&&(this.rotateStart.set(a.touches[0].pageX,a.touches[0].pageY),this.isTouching=!0)};d.prototype.onTouchMove_=function(a){this.isTouching&&(this.rotateEnd.set(a.touches[0].pageX,
a.touches[0].pageY),this.rotateDelta.subVectors(this.rotateEnd,this.rotateStart),this.rotateStart.copy(this.rotateEnd),f.isIOS()&&(this.rotateDelta.x*=-1),this.theta+=2*Math.PI*this.rotateDelta.x/document.body.clientWidth*.5)};d.prototype.onTouchEnd_=function(a){this.isTouching=!1};a.exports=d},function(a,b,c){function d(){try{this.selectedKey=localStorage.getItem("WEBVR_CARDBOARD_VIEWER")}catch(f){console.error("Failed to load viewer profile: %s",f)}this.selectedKey||(this.selectedKey="CardboardV1");
this.dialog=this.createDialog_(e.Viewers);this.root=null;this.onChangeCallbacks_=[]}var e=c(5);c(0);d.prototype.show=function(a){this.root=a;a.appendChild(this.dialog);this.dialog.querySelector("#"+this.selectedKey).checked=!0;this.dialog.style.display="block"};d.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog);this.dialog.style.display="none"};d.prototype.getCurrentViewer=function(){return e.Viewers[this.selectedKey]};d.prototype.getSelectedKey_=
function(){var a=this.dialog.querySelector("input[name=field]:checked");return a?a.id:null};d.prototype.onChange=function(a){this.onChangeCallbacks_.push(a)};d.prototype.fireOnChange_=function(a){for(var b=0;b<this.onChangeCallbacks_.length;b++)this.onChangeCallbacks_[b](a)};d.prototype.onSave_=function(){if((this.selectedKey=this.getSelectedKey_())&&e.Viewers[this.selectedKey]){this.fireOnChange_(e.Viewers[this.selectedKey]);try{localStorage.setItem("WEBVR_CARDBOARD_VIEWER",this.selectedKey)}catch(f){console.error("Failed to save viewer profile: %s",
f)}this.hide()}else console.error("ViewerSelector.onSave_: this should never happen!")};d.prototype.createDialog_=function(a){var b=document.createElement("div");b.classList.add("webvr-polyfill-viewer-selector");b.style.display="none";var c=document.createElement("div"),d=c.style;d.position="fixed";d.left=0;d.top=0;d.width="100%";d.height="100%";d.background="rgba(0, 0, 0, 0.3)";c.addEventListener("click",this.hide.bind(this));var e=document.createElement("div"),d=e.style;d.boxSizing="border-box";
d.position="fixed";d.top="24px";d.left="50%";d.marginLeft="-140px";d.width="280px";d.padding="24px";d.overflow="hidden";d.background="#fafafa";d.fontFamily="'Roboto', sans-serif";d.boxShadow="0px 5px 20px #666";e.appendChild(this.createH1_("Select your viewer"));for(var f in a)e.appendChild(this.createChoice_(f,a[f].label));e.appendChild(this.createButton_("Save",this.onSave_.bind(this)));b.appendChild(c);b.appendChild(e);return b};d.prototype.createH1_=function(a){var b=document.createElement("h1"),
c=b.style;c.color="black";c.fontSize="20px";c.fontWeight="bold";c.marginTop=0;c.marginBottom="24px";b.innerHTML=a;return b};d.prototype.createChoice_=function(a,b){var c=document.createElement("div");c.style.marginTop="8px";c.style.color="black";var d=document.createElement("input");d.style.fontSize="30px";d.setAttribute("id",a);d.setAttribute("type","radio");d.setAttribute("value",a);d.setAttribute("name","field");var e=document.createElement("label");e.style.marginLeft="4px";e.setAttribute("for",
a);e.innerHTML=b;c.appendChild(d);c.appendChild(e);return c};d.prototype.createButton_=function(a,b){var c=document.createElement("button");c.innerHTML=a;var d=c.style;d["float"]="right";d.textTransform="uppercase";d.color="#1094f7";d.fontSize="14px";d.letterSpacing=0;d.border=0;d.background="none";d.marginTop="16px";c.addEventListener("click",b);return c};a.exports=d},function(a,b,c){function d(){function a(a,b,c){var d=document.createElement("source");d.src=c;d.type="video/"+b;a.appendChild(d)}
var b=document.createElement("video");b.setAttribute("loop","");a(b,"webm",f.base64("video/webm","GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA="));a(b,"mp4",f.base64("video/mp4","AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAAG21kYXQAAAGzABAHAAABthADAowdbb9/AAAC6W1vb3YAAABsbXZoZAAAAAB8JbCAfCWwgAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIVdHJhawAAAFx0a2hkAAAAD3wlsIB8JbCAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAIAAAACAAAAAABsW1kaWEAAAAgbWRoZAAAAAB8JbCAfCWwgAAAA+gAAAAAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAAAVxtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAAEcc3RibAAAALhzdHNkAAAAAAAAAAEAAACobXA0dgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAIAAgASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAAFJlc2RzAAAAAANEAAEABDwgEQAAAAADDUAAAAAABS0AAAGwAQAAAbWJEwAAAQAAAAEgAMSNiB9FAEQBFGMAAAGyTGF2YzUyLjg3LjQGAQIAAAAYc3R0cwAAAAAAAAABAAAAAQAAAAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAEAAAABAAAAFHN0c3oAAAAAAAAAEwAAAAEAAAAUc3RjbwAAAAAAAAABAAAALAAAAGB1ZHRhAAAAWG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAK2lsc3QAAAAjqXRvbwAAABtkYXRhAAAAAQAAAABMYXZmNTIuNzguMw=="));
this.request=function(){b.paused&&b.play()};this.release=function(){b.pause()}}function e(){var a=null;this.request=function(){a||(a=setInterval(function(){window.location=window.location;setTimeout(window.stop,0)},3E4))};this.release=function(){a&&(clearInterval(a),a=null)}}var f=c(0);a.exports=function(){var a=navigator.userAgent||navigator.vendor||window.opera;return a.match(/iPhone/i)||a.match(/iPod/i)?e:d}()}]);(function(){WALK.Texture=function(a,b,c,d,e,f,g,h,k){this.webFormats=this.stdExt=this.rawExt=this.name=this.id=null;this.image=void 0!==a?a:WALK.Texture.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==b?b:WALK.Texture.DEFAULT_MAPPING;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==d?d:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==e?e:THREE.LinearFilter;this.minFilter=void 0!==f?f:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==k?k:1;this.hasAlpha=!1;this.format=
void 0!==g?g:THREE.RGBAFormat;this.type=void 0!==h?h:THREE.UnsignedByteType;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this._needsUpdate=!1;this.onUpdate=null;this.loaded=!1;this._loadedListeners=[];this.fromEditor=!1};WALK.Texture.DEFAULT_IMAGE=void 0;WALK.Texture.DEFAULT_MAPPING=THREE.UVMapping;WALK.Texture.prototype={constructor:WALK.Texture,get needsUpdate(){return this._needsUpdate},set needsUpdate(a){!0===a&&this.update();this._needsUpdate=a},clone:function(a){void 0===
a&&(a=new WALK.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.hasAlpha=this.hasAlpha;a.format=this.format;a.type=this.type;a.generateMipmaps=this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=this.unpackAlignment;return a},update:function(){this.dispatchEvent({type:"update"})},dispose:function(){this.dispatchEvent({type:"dispose"})},
addLoadedListener:function(a){this.loaded&&a();this._loadedListeners.push(a)},notifyLoaded:function(){var a,b;this.loaded=!0;b=this._loadedListeners;for(a=0;a<b.length;a+=1)b[a]();b.length=0}};THREE.EventDispatcher.prototype.apply(WALK.Texture.prototype)})();(function(){WALK.CompressedTexture=function(a,b,c,d,e,f,g,h,k,m,l){WALK.Texture.call(this,null,f,g,h,k,m,d,e,l);this.image={width:b,height:c};this.mipmaps=a;this.generateMipmaps=this.flipY=!1};WALK.CompressedTexture.prototype=Object.create(WALK.Texture.prototype);WALK.CompressedTexture.prototype.constructor=WALK.CompressedTexture;WALK.CompressedTexture.prototype.clone=function(){var a=new WALK.CompressedTexture;WALK.Texture.prototype.clone.call(this,a);return a}})();(function(){WALK.CubeTexture=function(a,b,c,d,e,f,g,h,k){b=void 0!==b?b:THREE.CubeReflectionMapping;WALK.Texture.call(this,a,b,c,d,e,f,g,h,k);this.images=a};WALK.CubeTexture.prototype=Object.create(WALK.Texture.prototype);WALK.CubeTexture.prototype.constructor=WALK.CubeTexture;WALK.CubeTexture.clone=function(a){void 0===a&&(a=new WALK.CubeTexture);WALK.Texture.prototype.clone.call(this,a);a.images=this.images;return a}})();(function(){WALK.DataTexture=function(a,b,c,d,e,f,g,h,k,m,l){WALK.Texture.call(this,null,f,g,h,k,m,d,e,l);this.image={data:a,width:b,height:c}};WALK.DataTexture.prototype=Object.create(WALK.Texture.prototype);WALK.DataTexture.prototype.constructor=WALK.DataTexture;WALK.DataTexture.prototype.clone=function(){var a=new WALK.DataTexture;WALK.Texture.prototype.clone.call(this,a);return a}})();(function(){var a=0;WALK.BaseMaterial=function(b,c){a+=1;Object.defineProperty(this,"id",{value:a});this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.colorWrite=this.depthWrite=this.depthTest=!0;this.defines={};this.uniforms={};this.attributes=null;this._vertexShaderBody=
b;this.fragmentShaderExtensions=null;this._fragmentShaderBody=c;this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this._programNeedsUpdate=this.visible=!0;this.fragmentPrecision=null};WALK.BaseMaterial.prototype={constructor:WALK.BaseMaterial,get programNeedsUpdate(){return this._programNeedsUpdate},set programNeedsUpdate(a){this._programNeedsUpdate=a},_generateDefinesString:function(){var a,c,d=[];for(a in this.defines)this.defines.hasOwnProperty(a)&&
(c=this.defines[a],!1!==c&&d.push("#define "+a+" "+c));d.sort();return d.join("\n")},generateVertexShader:function(){return["precision highp float;\nprecision highp int;",this._generateDefinesString(),"uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec2 sphericalNormal;\nattribute vec2 uv;\nattribute vec2 uv2;",this._vertexShaderBody].join("\n")},
generateFragmentShader:function(){return[this.fragmentShaderExtensions||"","precision "+this.fragmentPrecision+" float;","precision "+this.fragmentPrecision+" int;",this._generateDefinesString(),"uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;",this._fragmentShaderBody].join("\n")},dispose:function(){this.dispatchEvent({type:"dispose"})},addUniform:function(a,c,d){this.uniforms[a]={type:c,value:d};this.programNeedsUpdate=!0},propertyFromUniform:function(a){Object.defineProperty(this,a,{get:function(){return this.uniforms[a].value},
set:function(b){this.uniforms[a].value=b}})}};THREE.EventDispatcher.prototype.apply(WALK.BaseMaterial.prototype)})();(function(){WALK.CompressedTextureLoader=function(){this._parser=null};WALK.CompressedTextureLoader.prototype={constructor:WALK.CompressedTextureLoader,load:function(a,b,c,d){var e=this,f=[],g;g=new WALK.CompressedTexture;g.image=f;WALK.queueAjaxGet(a,b,!0,function(a){var b,d,h;a=e._parser(a,!0);if(a.isCubemap)for(b=a.mipmaps.length/a.mipmapCount,d=0;d<b;d+=1)for(f[d]={mipmaps:[]},h=0;h<a.mipmapCount;h+=1)f[d].mipmaps.push(a.mipmaps[d*a.mipmapCount+h]),f[d].format=a.format,f[d].width=a.width,f[d].height=
a.height;else g.image.width=a.width,g.image.height=a.height,g.mipmaps=a.mipmaps;1===a.mipmapCount&&(g.minFilter=THREE.LinearFilter);g.format=a.format;c&&c(g)},d);return g}}})();THREE.FXAAShader={uniforms:{tDiffuse:{type:"t",value:null},resolution:{type:"v2",value:new THREE.Vector2(1/1024,1/512)}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D tDiffuse;\nuniform vec2 resolution;\n#define FXAA_REDUCE_MIN   (1.0/128.0)\n#define FXAA_REDUCE_MUL   (1.0/8.0)\n#define FXAA_SPAN_MAX     8.0\nvoid main() {\nvec3 rgbNW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ).xyz;\nvec3 rgbNE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ).xyz;\nvec3 rgbSW = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ).xyz;\nvec3 rgbSE = texture2D( tDiffuse, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ).xyz;\nvec4 rgbaM  = texture2D( tDiffuse,  gl_FragCoord.xy  * resolution );\nvec3 rgbM  = rgbaM.xyz;\nvec3 luma = vec3( 0.299, 0.587, 0.114 );\nfloat lumaNW = dot( rgbNW, luma );\nfloat lumaNE = dot( rgbNE, luma );\nfloat lumaSW = dot( rgbSW, luma );\nfloat lumaSE = dot( rgbSE, luma );\nfloat lumaM  = dot( rgbM,  luma );\nfloat lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );\nfloat lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );\nvec2 dir;\ndir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\ndir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\nfloat dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );\nfloat rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );\ndir = min( vec2( FXAA_SPAN_MAX,  FXAA_SPAN_MAX),\nmax( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\ndir * rcpDirMin)) * resolution;\nvec4 rgbA = (1.0/2.0) * (\ntexture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (1.0/3.0 - 0.5)) +\ntexture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (2.0/3.0 - 0.5)));\nvec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * (\ntexture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (0.0/3.0 - 0.5)) +\ntexture2D(tDiffuse,  gl_FragCoord.xy  * resolution + dir * (3.0/3.0 - 0.5)));\nfloat lumaB = dot(rgbB, vec4(luma, 0.0));\nif ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) ) {\ngl_FragColor = rgbA;\n} else {\ngl_FragColor = rgbB;\n}\n}"};THREE.CopyShader={uniforms:{tDiffuse:{type:"t",value:null},opacity:{type:"f",value:1}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float opacity;\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\nvoid main() {\nvec4 texel = texture2D( tDiffuse, vUv );\ngl_FragColor = opacity * texel;\n}"};THREE.EffectComposer=function(a){this.renderer=a;this.renderTarget2=this.renderTarget1=null;this.passes=[];void 0===THREE.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader");this.copyPass=new THREE.ShaderPass(THREE.CopyShader)};
THREE.EffectComposer.prototype={addPass:function(a){this.passes.push(a)},disposeTarget:function(){this.renderTarget1&&(this.renderTarget1.dispose(),this.renderTarget1=null);this.renderTarget2&&(this.renderTarget2.dispose(),this.renderTarget2=null)},configureTarget:function(a,b,c){this.disposeTarget();this.renderTarget1=new THREE.WebGLRenderTarget(a,b,c);this.renderTarget1.generateMipmaps=!1;this.renderTarget2=new THREE.WebGLRenderTarget(a,b,c);this.renderTarget2.generateMipmaps=!1},render:function(){var a,
b;return function(c){a=this.renderTarget1;b=this.renderTarget2;var d=!1,e,f,g=this.passes.length;for(f=0;f<g;f++)if(e=this.passes[f],e.enabled){e.render(this.renderer,a,b,c,d);if(e.needsSwap&&f!=g-1){if(d){var h=this.renderer.context;h.stencilFunc(h.NOTEQUAL,1,4294967295);this.copyPass.render(this.renderer,a,b,c);h.stencilFunc(h.EQUAL,1,4294967295)}h=b;b=a;a=h}e instanceof THREE.MaskPass?d=!0:e instanceof THREE.ClearMaskPass&&(d=!1)}}}()};THREE.ShaderPass=function(a,b){this.textureID=void 0!==b?b:"tDiffuse";this.uniforms=THREE.UniformsUtils.clone(a.uniforms);this.material=new WALK.BaseMaterial(a.vertexShader,a.fragmentShader);this.material.uniforms=this.uniforms;this.renderToScreen=!1;this.needsSwap=this.enabled=!0;this.clear=!1;this.camera=new THREE.OrthographicCamera(-1,1,1,-1,0,1);this.scene=new THREE.Scene;this.quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),null);this.scene.add(this.quad);this.initialized=!1};
THREE.ShaderPass.prototype={render:function(a,b,c,d){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=c);this.quad.material=this.material;this.initialized||(this.initialized=!0);this.renderToScreen?a.render(this.scene,this.camera):a.render(this.scene,this.camera,b,this.clear)}};THREE.RenderPass=function(a,b,c,d,e){this.scene=a;this.camera=b;this.overrideMaterial=c;this.clearColor=d;this.clearAlpha=void 0!==e?e:1;this.oldClearColor=new THREE.Color;this.oldClearAlpha=1;this.needsSwap=this.clear=this.enabled=!0};
THREE.RenderPass.prototype={render:function(a,b,c,d){c=this.scene.overrideMaterial;this.overrideMaterial&&(this.scene.overrideMaterial=this.overrideMaterial);this.clearColor&&(this.oldClearColor.copy(a.getClearColor()),this.oldClearAlpha=a.getClearAlpha(),a.setClearColor(this.clearColor,this.clearAlpha));a.render(this.scene,this.camera,b,this.clear);this.clearColor&&a.setClearColor(this.oldClearColor,this.oldClearAlpha);this.scene.overrideMaterial=c}};THREE.MaskPass=function(a,b){this.scene=a;this.camera=b;this.clear=this.enabled=!0;this.inverse=this.needsSwap=!1};
THREE.MaskPass.prototype={render:function(a,b,c,d){d=a.context;d.colorMask(!1,!1,!1,!1);d.depthMask(!1);var e,f;this.inverse?(e=0,f=1):(e=1,f=0);d.enable(d.STENCIL_TEST);d.stencilOp(d.REPLACE,d.REPLACE,d.REPLACE);d.stencilFunc(d.ALWAYS,e,4294967295);d.clearStencil(f);a.render(this.scene,this.camera,c,this.clear);a.render(this.scene,this.camera,b,this.clear);d.colorMask(!0,!0,!0,!0);d.depthMask(!0);d.stencilFunc(d.EQUAL,1,4294967295);d.stencilOp(d.KEEP,d.KEEP,d.KEEP)}};
THREE.ClearMaskPass=function(){this.enabled=!0};THREE.ClearMaskPass.prototype={render:function(a,b,c,d){a=a.context;a.disable(a.STENCIL_TEST)}};(function(a){function b(a){return!isNaN(a)&&isFinite(a)}function c(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1}a.Octree=function(c){c=c||{};this.nodeCount=0;this.INDEX_INSIDE_CROSS=-1;this.INDEX_OUTSIDE_OFFSET=2;this.INDEX_OUTSIDE_POS_X=b(c.INDEX_OUTSIDE_POS_X)?c.INDEX_OUTSIDE_POS_X:0;this.INDEX_OUTSIDE_NEG_X=b(c.INDEX_OUTSIDE_NEG_X)?c.INDEX_OUTSIDE_NEG_X:1;this.INDEX_OUTSIDE_POS_Y=b(c.INDEX_OUTSIDE_POS_Y)?c.INDEX_OUTSIDE_POS_Y:2;this.INDEX_OUTSIDE_NEG_Y=b(c.INDEX_OUTSIDE_NEG_Y)?
c.INDEX_OUTSIDE_NEG_Y:3;this.INDEX_OUTSIDE_POS_Z=b(c.INDEX_OUTSIDE_POS_Z)?c.INDEX_OUTSIDE_POS_Z:4;this.INDEX_OUTSIDE_NEG_Z=b(c.INDEX_OUTSIDE_NEG_Z)?c.INDEX_OUTSIDE_NEG_Z:5;this.INDEX_OUTSIDE_MAP=[];this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_X]={index:this.INDEX_OUTSIDE_POS_X,count:0,x:1,y:0,z:0};this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_X]={index:this.INDEX_OUTSIDE_NEG_X,count:0,x:-1,y:0,z:0};this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Y]={index:this.INDEX_OUTSIDE_POS_Y,count:0,x:0,y:1,z:0};
this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Y]={index:this.INDEX_OUTSIDE_NEG_Y,count:0,x:0,y:-1,z:0};this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_POS_Z]={index:this.INDEX_OUTSIDE_POS_Z,count:0,x:0,y:0,z:1};this.INDEX_OUTSIDE_MAP[this.INDEX_OUTSIDE_NEG_Z]={index:this.INDEX_OUTSIDE_NEG_Z,count:0,x:0,y:0,z:-1};this.FLAG_POS_X=1<<this.INDEX_OUTSIDE_POS_X+1;this.FLAG_NEG_X=1<<this.INDEX_OUTSIDE_NEG_X+1;this.FLAG_POS_Y=1<<this.INDEX_OUTSIDE_POS_Y+1;this.FLAG_NEG_Y=1<<this.INDEX_OUTSIDE_NEG_Y+1;this.FLAG_POS_Z=
1<<this.INDEX_OUTSIDE_POS_Z+1;this.FLAG_NEG_Z=1<<this.INDEX_OUTSIDE_NEG_Z+1;this.utilVec31Search=new a.Vector3;this.utilVec32Search=new a.Vector3;if(this.scene=c.scene)this.visualGeometry=new a.BoxBufferGeometry(1,1,1),this.visualGeometry.addTriangleOrderAttribute(),this.visualMaterial=new WALK.WireframeMaterial(new a.Color(65280));this.objectsDeferred=[];this.depthMax=b(c.depthMax)?c.depthMax:Infinity;this.objectsThreshold=b(c.objectsThreshold)?c.objectsThreshold:8;this.overlapPct=b(c.overlapPct)?
c.overlapPct:.15;this.undeferred=c.undeferred||!1;this.root=new a.OctreeNode({tree:this,parent:null,position:new a.Vector3})};a.Octree.prototype={update:function(){if(0<this.objectsDeferred.length){for(var a=0,b=this.objectsDeferred.length;a<b;a++)this.addDeferred(this.objectsDeferred[a]);this.objectsDeferred.length=0}},add:function(a){this.undeferred?(this.updateObject(a),this.addDeferred(a)):this.objectsDeferred.push(a)},addDeferred:function(b){this.root.addObject(new a.OctreeObjectData(b))},updateObject:function(a){var b,
c=[a],d,e;for(d=a.parent;d;)c.push(d),d=d.parent;a=0;for(b=c.length;a<b;a++)d=c[a],!0===d.matrixWorldNeedsUpdate&&(e=d);"undefined"!==typeof e&&e.updateMatrixWorld()},search:function(b,c,d){var e,f,g,h,p=[];this.root.appendObjectsFromNode(p);0<c||(c=Number.MAX_VALUE);d instanceof a.Vector3&&(d=this.utilVec31Search.copy(d).normalize(),h=this.utilVec32Search.set(1,1,1).divide(d));e=0;for(f=this.root.nodesIndices.length;e<f;e++)g=this.root.nodesByIndex[this.root.nodesIndices[e]],g.search(b,c,d,h,p);
return p},setRoot:function(b){b instanceof a.OctreeNode&&(this.root=b,this.root.updateProperties())},getDepthEnd:function(){return this.root.getDepthEnd()},getNodeCountEnd:function(){return this.root.getNodeCountEnd()},getObjectCountEnd:function(){return this.root.getObjectCountEnd()},toConsole:function(){this.root.toConsole()}};a.OctreeObjectData=function(a){this.object=a;this.radius=0;this.position=null;this.update()};a.OctreeObjectData.prototype={update:function(){this.radius=this.object.geometry.boundingSphere.radius;
this.position=this.object.geometry.boundingSphere.center}};var d=new a.Vector3,e=new a.Vector3;new a.Vector3;a.OctreeNode=function(b){this.tree=b.tree;this.id=this.tree.nodeCount++;this.position=b.position;this.radius=0<b.radius?b.radius:1;this.indexOctant=b.indexOctant;this.depth=0;this.reset();this.setParent(b.parent);this.overlap=this.radius*this.tree.overlapPct;this.radiusOverlap=this.radius+this.overlap;this.left=this.position.x-this.radiusOverlap;this.right=this.position.x+this.radiusOverlap;
this.bottom=this.position.y-this.radiusOverlap;this.top=this.position.y+this.radiusOverlap;this.back=this.position.z-this.radiusOverlap;this.front=this.position.z+this.radiusOverlap;this.tree.scene&&(this.visual=new a.Mesh(this.tree.visualGeometry,this.tree.visualMaterial),this.visual.scale.set(2*this.radiusOverlap,2*this.radiusOverlap,2*this.radiusOverlap),this.visual.position.copy(this.position),this.tree.scene.add(this.visual),this.tree.scene.updateMatrixWorld())};a.OctreeNode.prototype={setParent:function(a){a!==
this&&this.parent!==a&&(this.parent=a,this.updateProperties())},updateProperties:function(){var b,c;this.parent instanceof a.OctreeNode?(this.tree=this.parent.tree,this.depth=this.parent.depth+1):this.depth=0;b=0;for(c=this.nodesIndices.length;b<c;b++)this.nodesByIndex[this.nodesIndices[b]].updateProperties()},reset:function(a,b){var c,d,e,f=this.nodesIndices||[],g=this.nodesByIndex;this.objects=[];this.nodesIndices=[];this.nodesByIndex={};c=0;for(d=f.length;c<d;c++)e=g[f[c]],e.setParent(void 0),
!0===a&&e.reset(a,b);!0===b&&this.visual&&this.visual.parent&&this.visual.parent.remove(this.visual)},addNode:function(a,b){a.indexOctant=b;-1===c(this.nodesIndices,b)&&this.nodesIndices.push(b);this.nodesByIndex[b]=a;a.parent!==this&&a.setParent(this)},removeNode:function(a){var b,d;b=c(this.nodesIndices,a);this.nodesIndices.splice(b,1);d=d||this.nodesByIndex[a];delete this.nodesByIndex[a];d.parent===this&&d.setParent(void 0)},addObject:function(b){var d;d=this.getOctantIndex(b);-1<d&&0<this.nodesIndices.length?
(d=this.branch(d),d.addObject(b)):-1>d&&this.parent instanceof a.OctreeNode?this.parent.addObject(b):(d=c(this.objects,b),-1===d&&this.objects.push(b),b.node=this,this.checkGrow())},addObjectWithoutCheck:function(a){var b,c,d;b=0;for(c=a.length;b<c;b++)d=a[b],this.objects.push(d),d.node=this},checkGrow:function(){this.objects.length>this.tree.objectsThreshold&&0<this.tree.objectsThreshold&&this.grow()},grow:function(){var a,b,c=[],d=[],e=[],l=[],n=[],p,q;p=0;for(q=this.objects.length;p<q;p++)b=this.objects[p],
a=this.getOctantIndex(b),-1<a?(e.push(b),l.push(a)):-1>a?(c.push(b),d.push(a)):n.push(b);0<e.length&&(n=n.concat(this.split(e,l)));0<c.length&&(n=n.concat(this.expand(c,d)));this.objects=n;this.checkMerge()},split:function(a,b){var c,d,e,f,g;if(this.depth<this.tree.depthMax){a=a||this.objects;b=b||[];g=[];c=0;for(d=a.length;c<d;c++)f=a[c],e=b[c],-1<e?(e=this.branch(e),e.addObject(f)):g.push(f);a===this.objects&&(this.objects=g)}else g=this.objects;return g},branch:function(b){var c,e;this.nodesByIndex[b]instanceof
a.OctreeNode?c=this.nodesByIndex[b]:(c=.5*this.radiusOverlap,e=c*this.tree.overlapPct,e=c-e,e=d.set(b&1?e:-e,b&2?e:-e,b&4?e:-e),e=(new a.Vector3).addVectors(this.position,e),c=new a.OctreeNode({tree:this.tree,parent:this,position:e,radius:c,indexOctant:b}),this.addNode(c,b));return c},expand:function(b,c){var d,f,g,l,n,p,q=this.tree.INDEX_OUTSIDE_MAP,u,r,t,v;if(this.tree.root.getDepthEnd()<this.tree.depthMax){b=b||this.objects;c=c||[];l=[];n=[];d=0;for(f=q.length;d<f;d++)q[d].count=0;d=0;for(f=b.length;d<
f;d++)g=b[d],p=c[d],-1>p?(p=-p-this.tree.INDEX_OUTSIDE_OFFSET,p&this.tree.FLAG_POS_X?q[this.tree.INDEX_OUTSIDE_POS_X].count++:p&this.tree.FLAG_NEG_X&&q[this.tree.INDEX_OUTSIDE_NEG_X].count++,p&this.tree.FLAG_POS_Y?q[this.tree.INDEX_OUTSIDE_POS_Y].count++:p&this.tree.FLAG_NEG_Y&&q[this.tree.INDEX_OUTSIDE_NEG_Y].count++,p&this.tree.FLAG_POS_Z?q[this.tree.INDEX_OUTSIDE_POS_Z].count++:p&this.tree.FLAG_NEG_Z&&q[this.tree.INDEX_OUTSIDE_NEG_Z].count++,n.push(g)):l.push(g);if(0<n.length)for(u=q.slice(0),
u.sort(function(a,b){return b.count-a.count}),p=u[0],f=p.index|1,q=u[1],r=u[2],d=(q.index|1)!==f?q:r,g=d.index|1,q=u[2],r=u[3],u=u[4],t=q.index|1,v=r.index|1,q=t!==f&&t!==g?q:v!==f&&v!==g?r:u,f=p.x+d.x+q.x,g=p.y+d.y+q.y,d=p.z+d.z+q.z,p=this.getOctantIndexFromPosition(f,g,d),d=this.getOctantIndexFromPosition(-f,-g,-d),g=this.overlap,q=this.radius,f=0<this.tree.overlapPct?g/(.5*this.tree.overlapPct*(1+this.tree.overlapPct)):2*q,r=f*this.tree.overlapPct,g=f+r-(q+g),e.set(p&1?g:-g,p&2?g:-g,p&4?g:-g),
p=(new a.Vector3).addVectors(this.position,e),p=new a.OctreeNode({tree:this.tree,position:p,radius:f}),p.addNode(this,d),this.tree.setRoot(p),d=0,f=n.length;d<f;d++)this.tree.root.addObject(n[d]);b===this.objects&&(this.objects=l)}else l=b;return l},shrink:function(){this.checkMerge();this.tree.root.checkContract()},checkMerge:function(){for(var b=this,c;b.parent instanceof a.OctreeNode&&b.getObjectCountEnd()<this.tree.objectsThreshold;)c=b,b=b.parent;b!==this&&b.merge(c)},merge:function(a){var b,
c,d;a=a?"[object Array]"===Object.prototype.toString.call(a)!==!0?[a]:a:[];b=0;for(c=a.length;b<c;b++)d=a[b],this.addObjectWithoutCheck(d.getObjectsEnd()),d.reset(!0,!0),this.removeNode(d.indexOctant,d);this.checkMerge()},checkContract:function(){var b,c,d,e,m,l,n;if(0<this.nodesIndices.length){l=0;n=this.objects.length;b=0;for(c=this.nodesIndices.length;b<c;b++)if(d=this.nodesByIndex[this.nodesIndices[b]],e=d.getObjectCountEnd(),n+=e,!1===m instanceof a.OctreeNode||e>l)m=d,l=e;n-l<this.tree.objectsThreshold&&
m instanceof a.OctreeNode&&this.contract(m)}},contract:function(a){var b,c,d;b=0;for(c=this.nodesIndices.length;b<c;b++)d=this.nodesByIndex[this.nodesIndices[b]],d!==a&&(a.addObjectWithoutCheck(d.getObjectsEnd()),d.reset(!0,!0));a.addObjectWithoutCheck(this.objects);this.reset(!1,!0);this.tree.setRoot(a);a.checkContract()},getOctantIndex:function(b){var c,d,e=this.position,f=this.radiusOverlap,l=this.overlap,n,p,q,u,r=0;b instanceof a.OctreeObjectData?(d=b.radius,c=b.position):b instanceof a.OctreeNode&&
(c=b.position,d=0);n=c.x-e.x;p=c.y-e.y;c=c.z-e.z;e=Math.abs(n);q=Math.abs(p);u=Math.abs(c);if(Math.max(e,q,u)+d>f)return e+d>f&&(r^=0<n?this.tree.FLAG_POS_X:this.tree.FLAG_NEG_X),q+d>f&&(r^=0<p?this.tree.FLAG_POS_Y:this.tree.FLAG_NEG_Y),u+d>f&&(r^=0<c?this.tree.FLAG_POS_Z:this.tree.FLAG_NEG_Z),b.indexOctant=-r-this.tree.INDEX_OUTSIDE_OFFSET,b.indexOctant;if(n-d>-l)r|=1;else if(!(n+d<l))return b.indexOctant=this.tree.INDEX_INSIDE_CROSS,b.indexOctant;if(p-d>-l)r|=2;else if(!(p+d<l))return b.indexOctant=
this.tree.INDEX_INSIDE_CROSS,b.indexOctant;if(c-d>-l)r|=4;else if(!(c+d<l))return b.indexOctant=this.tree.INDEX_INSIDE_CROSS,b.indexOctant;b.indexOctant=r;return b.indexOctant},getOctantIndexFromPosition:function(a,b,c){var d=0;0<a&&(d|=1);0<b&&(d|=2);0<c&&(d|=4);return d},appendObjectsFromNode:function(a){var b,c,d=this.objects;b=0;for(c=d.length;b<c;b+=1)a.push(d[b].object)},search:function(a,b,c,d,e){var f,g,h;if(!0===this.intersectRay(a,c,b,d))for(this.appendObjectsFromNode(e),f=0,g=this.nodesIndices.length;f<
g;f++)h=this.nodesByIndex[this.nodesIndices[f]],h.search(a,b,c,d,e)},intersectRay:function(a,b,c,d){b=(this.left-a.x)*d.x;var e=(this.right-a.x)*d.x,f=(this.bottom-a.y)*d.y,g=(this.top-a.y)*d.y,h=(this.back-a.z)*d.z;d=(this.front-a.z)*d.z;a=Math.min(Math.min(Math.max(b,e),Math.max(f,g)),Math.max(h,d));if(0>a)return!1;b=Math.max(Math.max(Math.min(b,e),Math.min(f,g)),Math.min(h,d));return b>a||b>c?!1:!0},getDepthEnd:function(a){var b,c,d;if(0<this.nodesIndices.length)for(b=0,c=this.nodesIndices.length;b<
c;b++)d=this.nodesByIndex[this.nodesIndices[b]],a=d.getDepthEnd(a);else a=!a||this.depth>a?this.depth:a;return a},getNodeCountEnd:function(){return this.tree.root.getNodeCountRecursive()+1},getNodeCountRecursive:function(){var a,b,c=this.nodesIndices.length;a=0;for(b=this.nodesIndices.length;a<b;a++)c+=this.nodesByIndex[this.nodesIndices[a]].getNodeCountRecursive();return c},getObjectsEnd:function(a){var b,c,d;a=(a||[]).concat(this.objects);b=0;for(c=this.nodesIndices.length;b<c;b++)d=this.nodesByIndex[this.nodesIndices[b]],
a=d.getObjectsEnd(a);return a},getObjectCountEnd:function(){var a,b,c=this.objects.length;a=0;for(b=this.nodesIndices.length;a<b;a++)c+=this.nodesByIndex[this.nodesIndices[a]].getObjectCountEnd();return c},getObjectCountStart:function(){for(var b=this.objects.length,c=this.parent;c instanceof a.OctreeNode;)b+=c.objects.length,c=c.parent;return b},toConsole:function(a){var b,c,d;a="string"===typeof a?a:"   ";console.log(this.parent?a+" octree NODE > ":" octree ROOT > ",this," // id: ",this.id," // indexOctant: ",
this.indexOctant," // position: ",this.position.x,this.position.y,this.position.z," // radius: ",this.radius," // depth: ",this.depth);console.log(this.parent?a+" ":" ","+ objects ( ",this.objects.length," ) ",this.objects);console.log(this.parent?a+" ":" ","+ children ( ",this.nodesIndices.length," )",this.nodesIndices,this.nodesByIndex);b=0;for(c=this.nodesIndices.length;b<c;b++)d=this.nodesByIndex[this.nodesIndices[b]],d.toConsole(a+"   ")}}})(THREE);(function(){function a(a,c){a.r=Math.pow(a.r,c);a.g=Math.pow(a.g,c);a.b=Math.pow(a.b,c);return a}THREE.Color.prototype.copyGammaToLinear=function(a){this.copy(a);return this.convertGammaToLinear()};THREE.Color.prototype.copyLinearToGamma=function(a){this.copy(a);return this.convertLinearToGamma()};THREE.Color.prototype.convertGammaToLinear=function(){return a(this,WALK.GAMMA_IN)};THREE.Color.prototype.convertLinearToGamma=function(){return a(this.WALK.GAMMA_OUT)}})();(function(){WALK.Math={toSnorm8:function(a){return Math.round(127*THREE.Math.clamp(a,-1,1))},minBytesToHold:function(a){return 127>=a?1:32767>=a?2:4}}})();(function(){WALK.Euler=function(a,b,c){THREE.Euler.call(this,b,c,a,"ZXY")};WALK.Euler.prototype=Object.create(THREE.Euler.prototype);WALK.Euler.prototype.constructor=WALK.Euler;Object.defineProperty(WALK.Euler.prototype,"yaw",{get:function(){return this.z},set:function(a){this.z=a}});Object.defineProperty(WALK.Euler.prototype,"pitch",{get:function(){return this.x},set:function(a){this.x=a}});Object.defineProperty(WALK.Euler.prototype,"roll",{get:function(){return this.y},set:function(a){this.y=a}});
Object.defineProperty(WALK.Euler.prototype,"yawDeg",{get:function(){return THREE.Math.radToDeg(this.yaw)},set:function(a){this.yaw=THREE.Math.degToRad(a)}});Object.defineProperty(WALK.Euler.prototype,"pitchDeg",{get:function(){return THREE.Math.radToDeg(this.pitch)},set:function(a){this.pitch=THREE.Math.degToRad(a)}});Object.defineProperty(WALK.Euler.prototype,"rollDeg",{get:function(){return THREE.Math.radToDeg(this.roll)},set:function(a){this.roll=THREE.Math.degToRad(a)}});WALK.Euler.prototype.setFromDegTriple=
function(a){var b,c;b=THREE.Math.degToRad(a[0]);c=THREE.Math.degToRad(a[1]);a=THREE.Math.degToRad(a[2]);this.set(c,a,b);return this};WALK.Euler.prototype.toDegTriple=function(){return[this.yawDeg,this.pitchDeg,this.rollDeg]};WALK.Euler.prototype.setFromDirection=function(a){this.set(Math.asin(a.z),0,Math.atan2(-a.x,a.y));return this};WALK.Euler.prototype.toQuaternion=function(){var a=new THREE.Quaternion;a.setFromEuler(this);return a};WALK.Euler.prototype.toRotationMatrix=function(){var a=new THREE.Matrix4;
a.makeRotationFromEuler(this);return a}})();(function(){var a=new THREE.Sphere;WALK.Frustum=function(){this.planes=[new THREE.Plane,new THREE.Plane,new THREE.Plane,new THREE.Plane,new THREE.Plane,new THREE.Plane]};WALK.Frustum.prototype={constructor:WALK.Frustum,setFromMatrix:function(a){var b=this.planes,d=a.elements;a=d[0];var e=d[1],f=d[2],g=d[3],h=d[4],k=d[5],m=d[6],l=d[7],n=d[8],p=d[9],q=d[10],u=d[11],r=d[12],t=d[13],v=d[14],d=d[15];b[0].setComponents(g-a,l-h,u-n,d-r).normalize();b[1].setComponents(g+a,l+h,u+n,d+r).normalize();b[2].setComponents(g+
e,l+k,u+p,d+t).normalize();b[3].setComponents(g-e,l-k,u-p,d-t).normalize();b[4].setComponents(g-f,l-m,u-q,d-v).normalize();b[5].setComponents(g+f,l+m,u+q,d+v).normalize();return this},intersectsObject:function(b){var c=b.geometry;null===c.boundingSphere&&c.computeBoundingSphere();b.matrixWorld?(a.copy(c.boundingSphere),a.applyMatrix4(b.matrixWorld),b=a):b=c.boundingSphere;return this.intersectsSphere(b)},nearPlaneDistanceTo:function(b){var c=b.geometry,d;d=this.planes[5];b.matrixWorld?(a.copy(c.boundingSphere),
a.applyMatrix4(b.matrixWorld),b=a):b=c.boundingSphere;d=d.distanceToPoint(b.center);b=b.radius;return Math.abs(d)<b?b+d:d-b},intersectsSphere:function(a){var b=this.planes,d=a.center;a=-a.radius;var e,f;for(e=0;6>e;e+=1)if(f=b[e].distanceToPoint(d),f<a)return!1;return!0},intersectsBox:function(){var a=new THREE.Vector3,c=new THREE.Vector3;return function(b){var d=this.planes,f,g,h;for(f=0;6>f;f+=1)if(g=d[f],a.x=0<g.normal.x?b.min.x:b.max.x,c.x=0<g.normal.x?b.max.x:b.min.x,a.y=0<g.normal.y?b.min.y:
b.max.y,c.y=0<g.normal.y?b.max.y:b.min.y,a.z=0<g.normal.z?b.min.z:b.max.z,c.z=0<g.normal.z?b.max.z:b.min.z,h=g.distanceToPoint(a),g=g.distanceToPoint(c),0>h&&0>g)return!1;return!0}}(),containsPoint:function(a){var b=this.planes,d;for(d=0;6>d;d+=1)if(0>b[d].distanceToPoint(a))return!1;return!0}}})();(function(){WALK.USER_MSG=new function(){this.hideInfo=function(){$("info-message").style.display="none"};this.info=function(a){var b=$("info-message");b.innerHTML=a;b.style.display="";setTimeout(this.hideInfo,15E3)};this.error=function(a){var b=$("error-message");b.innerHTML=a;b.style.display=""}}})();(function(){WALK.Detector=function(a){function b(b){var c=f[b];if(void 0!==c)return c;switch(b){case "EXT_texture_filter_anisotropic":c=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case "WEBGL_compressed_texture_s3tc":c=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;
case "WEBGL_compressed_texture_pvrtc":c=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case "WEBGL_compressed_texture_etc1":c=a.getExtension("WEBGL_compressed_texture_etc1");break;default:c=a.getExtension(b)}return f[b]=c}function c(b){var c,d;c=a.createTexture();a.bindTexture(a.TEXTURE_2D,c);a.texImage2D(a.TEXTURE_2D,0,a.RGBA,2,2,0,a.RGBA,b,null);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,
a.TEXTURE_MIN_FILTER,a.LINEAR);b=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,b);a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,c,0);d=a.checkFramebufferStatus(a.FRAMEBUFFER)===a.FRAMEBUFFER_COMPLETE;a.deleteTexture(c);a.deleteFramebuffer(b);a.bindTexture(a.TEXTURE_2D,null);a.bindFramebuffer(a.FRAMEBUFFER,null);return d}function d(a,b){var c=a.toLowerCase(),d=b.toLowerCase();return-1!==c.indexOf(d)}function e(a){return navigator&&navigator.userAgent?d(navigator.userAgent,
a):!1}var f={};this.extension=b;this.mobile=/mobile|ip(ad|hone|od)|android|silk/i.test(navigator.userAgent)||WALK.urlHashContains("mobile");this.ios=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;this.android=/Android/.test(navigator.userAgent);this.inCrossOriginIframe=function(){var a,b,c;a=window.self!==window.top;b=WALK.getOriginFromUrl(document.referrer);c=WALK.getOriginFromUrl(window.location.href);return a&&b!==c}();this.antialiasNative=a.getContextAttributes().antialias&&1<
a.getParameter(a.SAMPLES);this.antialiasSamples=a.getParameter(a.SAMPLES);this.antialiasPostprocess=!this.mobile;this.floatTextures=b("OES_texture_float");this.floatTexturesInterpolate=b("OES_texture_float_linear");this.halfFloatTextures=b("OES_texture_half_float");this.halfFloatTexturesInterpolate=b("OES_texture_half_float_linear");this.standardDerivatives=b("OES_standard_derivatives");this.maxAnisotropy=function(){var c=b("EXT_texture_filter_anisotropic");return null!==c?a.getParameter(c.MAX_TEXTURE_MAX_ANISOTROPY_EXT):
0}();this.indexUint=b("OES_element_index_uint");this.fragmentPrecision=void 0===a.getShaderPrecisionFormat||0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision?"highp":0<a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision?"mediump":"lowp";var g;g=4096>a.getParameter(a.MAX_TEXTURE_SIZE)?"Your graphics card does not have sufficient capabilities, texture sizes 4096x4096 need to be supported.":null;this.missingCapabilities=g;g=this.floatTextures?c(a.FLOAT):!1;this.floatTargets=
g;g=this.halfFloatTextures?c(this.halfFloatTextures.HALF_FLOAT_OES):!1;this.dynamicLights=(this.halfFloatTargets=g)&&this.floatTargets&&this.halfFloatTexturesInterpolate;this.dxtTextures=function(){var c,d,e=!1,f=!1,g;try{if(WALK.urlHashContains("nodxt"))return!1;c=b("WEBGL_compressed_texture_s3tc");d=a.getParameter(a.COMPRESSED_TEXTURE_FORMATS);for(g=0;g<d.length;g+=1)e=e||d[g]===c.COMPRESSED_RGB_S3TC_DXT1_EXT,f=f||d[g]===c.COMPRESSED_RGBA_S3TC_DXT5_EXT;return e&&f}catch(p){}return!1}();g=WALK.urlHashContains("nopvr")?
!1:b("WEBGL_compressed_texture_pvrtc");this.pvrtcTextures=g;g=WALK.urlHashContains("noetc1")?!1:b("WEBGL_compressed_texture_etc1")&&this.mobile;this.etc1Textures=g;this.firefox=e("firefox");this.opera=e("opera")||e("OPR/");this.ie=e("msie")||(navigator&&navigator.appVersion?d(navigator.appVersion,"trident/"):!1);this.edge=e("edge/");this.cubeMaps=(this.textureLod=b("EXT_shader_texture_lod")&&(!this.firefox||!this.android))&&!this.ie;this.mirrorCubeMaps=!this.mobile;this.debugEnabled=WALK.DEBUG||WALK.urlHashContains("debug");
this.debugSharedBuffers=WALK.DEBUG_SHARED_BUFFERS||WALK.urlHashContains("debugbuffers");this.reportToConsole=function(){WALK.log("Using "+this.fragmentPrecision+" fragment precision.");this.dxt1Textures||WALK.log("DXT textures not supported.");this.textureLod||WALK.log("Texture fetch level of detail not supported.");this.floatTextures?(this.floatTexturesInterpolate||WALK.log("Float textures interpolation not supported."),this.floatTargets||WALK.log("Float render targets not supported")):WALK.log("Float textures not supported.");
this.halfFloatTextures?(this.halfFloatTexturesInterpolate||WALK.log("Half float textures interpolation not supported."),this.halfFloatTargets||WALK.log("Half float render targets not supported")):WALK.log("Half float textures not supported");this.antialiasNative?WALK.log("Native anti-aliasing supported with "+this.antialiasSamples+" samples."):WALK.log("Native anti-aliasing not supported")}}})();WALK.SHADERS={};WALK.SHADERS["aabb_query_fragment.glsl"]="//AUTO GENERATED\nvarying vec3 vPositionW;\nuniform int axis;\nvec4 encodeFloat(in float x) {\nfloat xabs = abs(x);\nfloat r = floor(xabs);\nfloat g = fract(xabs);\nreturn vec4(r / 255.0, g, 0.0, 0.0);\n}\nvoid main() {\nvec3 viewW = cameraPosition - vPositionW;\nif (axis == 0) {\ngl_FragColor = encodeFloat(viewW.x);\n} else if (axis == 1) {\ngl_FragColor = encodeFloat(viewW.y);\n} else if (axis == 2) {\ngl_FragColor = encodeFloat(viewW.z);\n}\n}\n";
WALK.SHADERS["aabb_query_vertex.glsl"]="//AUTO GENERATED\nvarying vec3 vPositionW;\nvoid main() {\nvPositionW = (modelMatrix * vec4(position, 1.0)).xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n";WALK.SHADERS["accumulate_fragment.glsl"]="//AUTO GENERATED\nuniform float weight;\nuniform sampler2D inputBuffer;\nvarying vec2 vUv;\nvoid main() {\nvec3 inputColor = texture2D(inputBuffer, vUv).rgb;\ngl_FragColor = vec4(inputColor, weight);\n}\n";
WALK.SHADERS["accumulate_vertex.glsl"]="//AUTO GENERATED\nvarying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n";WALK.SHADERS["cubemap_filter_fragment.glsl"]="//AUTO GENERATED\nvec3 hdrDecode(in vec4 rgbm) {\nconst float rgbmScale = 2.82842712;  // sqrt(8)\nvec3 r = rgbm.rgb * (rgbmScale * (1.0 - rgbm.a));\nreturn r * r;\n}\nvec4 hdrEncode(in vec3 rgb) {\nconst float rgbmScale = 2.82842712;  // sqrt(8)\nvec3 r = sqrt(rgb) / rgbmScale;\nfloat m = max(max(r.r, r.g), r.b);\nm = clamp(m, 1.0 / 255.0, 1.0);\nm = ceil(m * 255.0) / 255.0;\nr /= m;\nreturn vec4(r.r, r.g, r.b, (1.0 - m));\n}\nconst float PI = 3.14159265358979;\nconst float RECIPROCAL_PI2 = 0.15915494;\nfloat saturate(in float a) {\nreturn clamp(a, 0.0, 1.0);\n}\nvec3 inverseTransformDirection(in vec3 normal, in mat4 matrix) {\nreturn normalize((vec4(normal, 0.0) * matrix).xyz);\n}\nfloat rnd(vec2 uv) {\nreturn fract(sin(dot(uv, vec2(12.9898, 78.233) * 2.0)) * 43758.5453);\n}\nvec3 hemisphereSample_cos(vec2 uv, mat3 vecSpace, vec3 cubeDir, float gloss) {\nfloat phi = uv.y * 2.0 * PI;\nfloat cosTheta = sqrt(1.0 - uv.x);\nfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\nvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\nreturn normalize(mix(vecSpace * sampleDir, cubeDir, gloss));\n}\nmat3 matrixFromVector(vec3 n) { // frisvad\nfloat a = 1.0 / (1.0 + n.z);\nfloat b = -n.x * n.y * a;\nvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\nvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\nreturn mat3(b1, b2, n);\n}\nuniform samplerCube envMap;\nuniform float mipSize;\nuniform float face;\nuniform float gloss;\nvoid main(void) {\nvec2 st = 2.0 * floor(gl_FragCoord.xy) / (mipSize - 1.0) - 1.0;\nvec3 vec;\nif (face == 0.0) {\nvec = vec3(1, -st.y, -st.x);\n} else if (face == 1.0) {\nvec = vec3(-1, -st.y, st.x);\n} else if (face == 2.0) {\nvec = vec3(st.x, 1, st.y);\n} else if (face == 3.0) {\nvec = vec3(st.x, -1, -st.y);\n} else if (face == 4.0) {\nvec = vec3(st.x, -st.y, 1);\n} else {\nvec = vec3(-st.x, -st.y, -1);\n}\nmat3 vecSpace = matrixFromVector(normalize(vec));\nvec3 color = vec3(0.0);\nconst int samples = 200;\nvec3 vect;\nfor(int i = 0; i < samples; i++) {\nfloat sini = sin(float(i));\nfloat cosi = cos(float(i));\nfloat rand = rnd(vec2(sini, cosi));\nvect = hemisphereSample_cos(\nvec2(float(i) / float(samples), rand), vecSpace, vec, gloss);\ncolor += hdrDecode(textureCube(envMap, vect));\n}\ncolor /= float(samples);\ngl_FragColor = hdrEncode(color);\n}\n";
WALK.SHADERS["cubemap_filter_vertex.glsl"]="//AUTO GENERATED\nvoid main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n";WALK.SHADERS["editor_light_fragment.glsl"]="//AUTO GENERATED\nfloat _l2g(in float x) {\nreturn (x <= 0.0031308) ? x * 12.92 : pow(x, 1.0 / 2.4) * 1.055 - 0.055;\n}\nvec3 linearToGamma(in vec3 rgb) {\nreturn vec3(_l2g(rgb.r), _l2g(rgb.g), _l2g(rgb.b));\n}\nvec3 linearToGammaUnreal(in vec3 rgb) {\nreturn rgb / (rgb + 0.187) * 1.035;\n}\nuniform vec3 color;\nuniform vec3 highlight;\nuniform float highlightMix;\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\nvoid main() {\nvec3 lVector = normalize(vViewPosition.xyz);\nfloat pointDiffuse = max(dot(normalize(vNormal), lVector), 0.0);\nvec3 lightColor = color * pointDiffuse;\nlightColor = mix(lightColor, highlight, highlightMix);\ngl_FragColor.xyz = min(linearToGamma(lightColor), 1.0);\n}\n";
WALK.SHADERS["editor_light_vertex.glsl"]="//AUTO GENERATED\nconst float PI = 3.14159265358979;\nconst float RECIPROCAL_PI2 = 0.15915494;\nfloat saturate(in float a) {\nreturn clamp(a, 0.0, 1.0);\n}\nvec3 inverseTransformDirection(in vec3 normal, in mat4 matrix) {\nreturn normalize((vec4(normal, 0.0) * matrix).xyz);\n}\nvec3 sphericalDecode(in vec2 spNormal) {\nfloat theta = (spNormal.x / 254.0 + 0.5) * PI;\nfloat phi = spNormal.y * (PI / 127.0);\nfloat sinTheta = sin(theta);\nreturn vec3(sinTheta * cos(phi), sinTheta * sin(phi), cos(theta));\n}\nvarying vec3 vNormal;\nvarying vec3 vViewPosition;\nvoid main() {\nvec3 normal = sphericalDecode(sphericalNormal);\nvNormal = normalize(normalMatrix * normal);\nvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\nvViewPosition = -mvPosition.xyz;\ngl_Position = projectionMatrix * mvPosition;\n}\n";
WALK.SHADERS["equirect_sky_fragment.glsl"]="//AUTO GENERATED\nconst float PI = 3.14159265358979;\nconst float RECIPROCAL_PI2 = 0.15915494;\nfloat saturate(in float a) {\nreturn clamp(a, 0.0, 1.0);\n}\nvec3 inverseTransformDirection(in vec3 normal, in mat4 matrix) {\nreturn normalize((vec4(normal, 0.0) * matrix).xyz);\n}\nfloat _g2l(in float x) {\nreturn (x <= 0.04045) ? x / 12.92 : pow((x + 0.055) / 1.055, 2.4);\n}\nvec3 gammaToLinear(in vec3 rgb) {\nreturn vec3(_g2l(rgb.r), _g2l(rgb.g), _g2l(rgb.b));\n}\nvec4 hdrEncode(in vec3 rgb) {\nconst float rgbmScale = 2.82842712;  // sqrt(8)\nvec3 r = sqrt(rgb) / rgbmScale;\nfloat m = max(max(r.r, r.g), r.b);\nm = clamp(m, 1.0 / 255.0, 1.0);\nm = ceil(m * 255.0) / 255.0;\nr /= m;\nreturn vec4(r.r, r.g, r.b, (1.0 - m));\n}\nuniform sampler2D map;\nvarying vec2 vUv;\n#ifdef USE_COLORMAP\nvec3 colormap(in sampler2D texture, in vec3 color) {\nconst float resolution = 16.0;\nconst float maxValueIndex = resolution - 1.0;\nconst float sliceWidth = 1.0 / resolution;\nconst float slicePixelWidth = sliceWidth / resolution;\nconst float sliceMarginWidth = 0.5 * slicePixelWidth;\nconst float sliceInnerWidth = sliceWidth - slicePixelWidth;\nconst float slicePixelHeight = 1.0 / resolution;\nconst float sliceMarginHeight = 0.5 * slicePixelHeight;\nconst float sliceInnerHeight = 1.0 - slicePixelHeight;\nfloat bSlice0 = min(floor(color.b * maxValueIndex), maxValueIndex - 1.0);\nfloat bSlice1 = bSlice0 + 1.0;\nfloat bOffset = color.b * maxValueIndex - bSlice0;\nfloat rSlicePos = sliceMarginWidth + color.r * sliceInnerWidth;\nfloat gSlicePos = sliceMarginHeight + color.g * sliceInnerHeight;\nfloat rPos0 = rSlicePos + (bSlice0 * sliceWidth);\nfloat rPos1 = rSlicePos + (bSlice1 * sliceWidth);\nvec3 color0 = texture2D(texture, vec2(rPos0, gSlicePos)).rgb;\nvec3 color1 = texture2D(texture, vec2(rPos1, gSlicePos)).rgb;\nreturn mix(color0, color1, bOffset);\n}\nuniform sampler2D colorMap;\n#endif\nvoid main() {\nvec3 colorGamma = texture2D(map, vUv).xyz;\n#ifdef HDR_OUTPUT\nvec3 colorLinear = gammaToLinear(colorGamma);\ngl_FragColor = hdrEncode(10.0 * colorLinear);\n#else\n#ifdef USE_COLORMAP\ngl_FragColor.xyz = colormap(colorMap, colorGamma);\n#else\ngl_FragColor.xyz = colorGamma;\n#endif\n#endif\n}\n";
WALK.SHADERS["equirect_sky_vertex.glsl"]="//AUTO GENERATED\nvarying vec2 vUv;\nvoid main() {\nvUv = uv;\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n";WALK.SHADERS["light_visibility_dilate_fragment.glsl"]="//AUTO GENERATED\nuniform sampler2D lightVisibilityMap;\nvarying vec2 vUv;\nuniform vec2 sizeInv;\nvoid main() {\nvec4 zero = vec4(0.0);\nvec4 visibility = texture2D(lightVisibilityMap, vUv);\nif (!all(equal(visibility, zero))) {\ngl_FragColor = visibility;\nreturn;\n}\nvisibility = texture2D(lightVisibilityMap, vUv - vec2(sizeInv.x, 0.0));\nif (!all(equal(visibility, zero))) {\ngl_FragColor = visibility;\nreturn;\n}\nvisibility = texture2D(lightVisibilityMap, vUv - vec2(0.0, sizeInv.y));\nif (!all(equal(visibility, zero))) {\ngl_FragColor = visibility;\nreturn;\n}\nvisibility = texture2D(lightVisibilityMap, vUv + vec2(sizeInv.x, 0.0));\nif (!all(equal(visibility, zero))) {\ngl_FragColor = visibility;\nreturn;\n}\nvisibility = texture2D(lightVisibilityMap, vUv + vec2(0.0, sizeInv.y));\nif (!all(equal(visibility, zero))) {\ngl_FragColor = visibility;\nreturn;\n}\nvisibility = texture2D(lightVisibilityMap, vUv + sizeInv);\nif (!all(equal(visibility, zero))) {\ngl_FragColor = visibility;\nreturn;\n}\nvisibility = texture2D(lightVisibilityMap, vUv - sizeInv);\nif (!all(equal(visibility, zero))) {\ngl_FragColor = visibility;\nreturn;\n}\nvisibility = texture2D(lightVisibilityMap, vUv + vec2(sizeInv.x, -sizeInv.y));\nif (!all(equal(visibility, zero))) {\ngl_FragColor = visibility;\nreturn;\n}\nvisibility = texture2D(lightVisibilityMap, vUv + vec2(-sizeInv.x, sizeInv.y));\ngl_FragColor = visibility;\n}\n";
WALK.SHADERS["light_visibility_fragment.glsl"]="//AUTO GENERATED\nconst float PI = 3.14159265358979;\nconst float RECIPROCAL_PI2 = 0.15915494;\nfloat saturate(in float a) {\nreturn clamp(a, 0.0, 1.0);\n}\nvec3 inverseTransformDirection(in vec3 normal, in mat4 matrix) {\nreturn normalize((vec4(normal, 0.0) * matrix).xyz);\n}\nfloat rnd(vec2 uv) {\nreturn fract(sin(dot(uv, vec2(12.9898, 78.233) * 2.0)) * 43758.5453);\n}\nvec3 hemisphereSample_cos(vec2 uv, mat3 vecSpace, vec3 cubeDir, float gloss) {\nfloat phi = uv.y * 2.0 * PI;\nfloat cosTheta = sqrt(1.0 - uv.x);\nfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\nvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\nreturn normalize(mix(vecSpace * sampleDir, cubeDir, gloss));\n}\nmat3 matrixFromVector(vec3 n) { // frisvad\nfloat a = 1.0 / (1.0 + n.z);\nfloat b = -n.x * n.y * a;\nvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\nvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\nreturn mat3(b1, b2, n);\n}\n#define SPOT_PROPERTIES_NEEDED\n#define POINT_LIGHT_TYPE 0.0\n#define SPOT_LIGHT_TYPE 1.0\nuniform sampler2D lightAttrMap;\nuniform float lightsCount;\nstruct Light {\nvec3 positionW;\nfloat strength; // TODO: rename to intensity\nfloat size; // radius\nvec3 color;\n#ifdef SPOT_PROPERTIES_NEEDED\nfloat type; // POINT_LIGHT_TYPE or SPOT_LIGHT_TYPE\nvec3 spotDirectionW;\nfloat spotHalfAngle;\n#endif\n};\nconst float lightAttrFragments = 4.0;\nvoid readLightProperties(in float lightId, out Light light) {\nfloat lightAttrFragmentOffset = 1.0 / (lightAttrFragments * lightsCount);\nvec2 offset = vec2(lightId / lightsCount + 0.5 * lightAttrFragmentOffset,\n0.0);\nvec4 lightAttr = texture2D(lightAttrMap, offset);\nlight.positionW.xyz = lightAttr.xyz;\nlight.size = lightAttr.w;\noffset.x += lightAttrFragmentOffset;\nlightAttr = texture2D(lightAttrMap, offset);\nlight.color.xyz = lightAttr.xyz;\nlight.strength = lightAttr.w;\n#ifdef SPOT_PROPERTIES_NEEDED\noffset.x += lightAttrFragmentOffset;\nlightAttr = texture2D(lightAttrMap, offset);\nlight.type = lightAttr.x;\nlight.spotDirectionW.xyz = lightAttr.yzw;\noffset.x += lightAttrFragmentOffset;\nlightAttr = texture2D(lightAttrMap, offset);\nlight.spotHalfAngle = lightAttr.x;\n#endif\n}\n#define LENGTH_EPSILON 0.001\nuniform samplerCube objectDistanceMap;\nuniform sampler2D combineWithMap;\nuniform float objectId;\nuniform float lightId;\nvarying vec3 vNormalW;\nvarying vec3 vPositionW;\nvarying vec2 vUv2;\nvoid markAsReached(vec4 currentVisibility) {\nconst float fragmentReached = 0.01;\ngl_FragColor = max(currentVisibility, fragmentReached);\n}\nvoid main(void){\nvec4 currentVisibility = texture2D(combineWithMap, vUv2);\nLight light;\nreadLightProperties(lightId, light);\nvec3 normalW = normalize(vNormalW);\nvec3 toLightW = light.positionW - vPositionW;\nvec3 toLastVisiblePointW = toLightW + normalW * light.size;\nif (dot(normalW, toLastVisiblePointW) <= 0.0) {\nmarkAsReached(currentVisibility);\nreturn;\n}\nfloat lightDistance = length(toLightW);\nfloat spotStrengthFactor = 1.0;\nif (lightDistance >= LENGTH_EPSILON && light.type == SPOT_LIGHT_TYPE) {\nfloat spotHeight = dot(light.spotDirectionW, -toLightW);\nif (spotHeight < LENGTH_EPSILON) {\nmarkAsReached(currentVisibility);\nreturn;\n}\nfloat cosPointDir = spotHeight / lightDistance;\nfloat spotSlantHeight = spotHeight / cos(light.spotHalfAngle);\nfloat spotSinHalfFalloffRange = light.size / spotSlantHeight;\nfloat pointDirAngle = acos(cosPointDir);\nfloat spotHalfFalloffRange;\nif (spotSinHalfFalloffRange > 1.0) {\nspotHalfFalloffRange = light.spotHalfAngle / 6.0;\n} else {\nspotHalfFalloffRange =\nmin(asin(spotSinHalfFalloffRange), light.spotHalfAngle / 6.0);\n}\nfloat spotFalloffBegin = light.spotHalfAngle - spotHalfFalloffRange;\nif (pointDirAngle < spotFalloffBegin) {\nspotStrengthFactor = cos(pointDirAngle);\n} else {\nfloat linearFalloffWeight =\n(pointDirAngle - spotFalloffBegin) / (2.0 * spotHalfFalloffRange);\nspotStrengthFactor = mix(cos(spotFalloffBegin), 0.0, linearFalloffWeight);\n}\nif (spotStrengthFactor <= 0.0) {\nmarkAsReached(currentVisibility);\nreturn;\n}\n}\nvec3 cubeDir = -toLightW / lightDistance;\nfloat bias = 0.05;\nfloat visibility = 0.0;\nfloat diskRadius = 1.0 - light.size / (2.0 * lightDistance);\ndiskRadius = 0.97;\nmat3 cubeDirSpace = matrixFromVector(cubeDir);\nconst int samples = 50;\nvec3 newCubeDir;\nfor(int i = 0; i < samples; i++) {\nfloat sini = sin(float(i));\nfloat cosi = cos(float(i));\nfloat rand = rnd(vec2(sini, cosi));\nnewCubeDir = hemisphereSample_cos(vec2(float(i) / float(samples), rand),\ncubeDirSpace, cubeDir, diskRadius);\nvec4 objectDistance = textureCube(objectDistanceMap, newCubeDir);\nfloat collisionObjectId = objectDistance.x;\nfloat collisionDistance = objectDistance.y;\nif (objectId == collisionObjectId ||\ncollisionDistance > lightDistance - bias) {\nvisibility += 1.0;\n}\n}\nvisibility /= float(samples);\nvisibility *= spotStrengthFactor;\nif (visibility != 0.0) {\nconst float channelTaken = 1025.0;\nvec4 outputVisibility = min(channelTaken * currentVisibility, channelTaken);\nfloat visibilityChannel = float(lightId) + clamp(visibility, 0.001, 0.999);\ngl_FragColor = max(outputVisibility, visibilityChannel);\n} else {\nmarkAsReached(currentVisibility);\n}\n}\n";
WALK.SHADERS["light_visibility_free_channel_fragment.glsl"]="//AUTO GENERATED\nuniform sampler2D lightVisibilityMap;\nvarying vec2 vUv;\nuniform vec2 sizeInv;\nuniform float threshold;\nvoid main() {\nvec2 corner = vUv - sizeInv;\nvec2 uv = corner + 0.5 * sizeInv;\nvec4 visibility0 = texture2D(lightVisibilityMap, uv);\nvec4 visibility1 = texture2D(lightVisibilityMap, uv + vec2(0.0, sizeInv.y));\nvec4 visibility2 = texture2D(lightVisibilityMap, uv + vec2(sizeInv.x, 0.0));\nvec4 visibility3 = texture2D(lightVisibilityMap,\nuv + vec2(sizeInv.x, sizeInv.y));\ngl_FragColor = step(threshold, visibility0) + step(threshold, visibility1) +\nstep(threshold, visibility2) + step(threshold, visibility3);\n}\n";
WALK.SHADERS["light_visibility_vertex.glsl"]="//AUTO GENERATED\nvarying vec3 vNormalW;\nvarying vec3 vPositionW;\nvarying vec2 vUv2;\nvoid main() {\nvNormalW = mat3(modelMatrix[0].xyz,\nmodelMatrix[1].xyz,\nmodelMatrix[2].xyz) * normal;\nvNormalW = normalize(vNormalW);\nvPositionW = (modelMatrix * vec4(position, 1.0)).xyz;\nvUv2 = uv2;\ngl_Position = vec4(2.0 * uv2.x - 1.0, 2.0 * uv2.y - 1.0, 1.0, 1.0);\n}\n";WALK.SHADERS["mirror_fragment.glsl"]="//AUTO GENERATED\nuniform vec3 mirrorColor;\nuniform sampler2D mirrorSampler;\nvarying vec4 mirrorCoord;\nfloat blendOverlay(float base, float blend) {\nreturn (base < 0.5 ? (2.0 * base * blend) :\n(1.0 - 2.0 * (1.0 - base) * (1.0 - blend)));\n}\nvoid main() {\nvec4 color = texture2DProj(mirrorSampler, mirrorCoord);\ncolor = vec4(blendOverlay(mirrorColor.r, color.r),\nblendOverlay(mirrorColor.g, color.g),\nblendOverlay(mirrorColor.b, color.b), 1.0);\ngl_FragColor = color;\n}\n";
WALK.SHADERS["mirror_vertex.glsl"]="//AUTO GENERATED\nuniform mat4 textureMatrix;\nvarying vec4 mirrorCoord;\nvoid main() {\nvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\nvec4 worldPosition = modelMatrix * vec4(position, 1.0);\nmirrorCoord = textureMatrix * worldPosition;\ngl_Position = projectionMatrix * mvPosition;\n}\n";WALK.SHADERS["object_distance_byte_fragment.glsl"]="//AUTO GENERATED\nuniform int objectId;\nvarying vec3 vPositionW;\nvoid main(void) {\nfloat cameraDistance = min(distance(cameraPosition, vPositionW), 255.0);\nint x = objectId / 256;\nint y = objectId - 256 * x;\nfloat z = floor(cameraDistance);\nfloat a = fract(cameraDistance);\ngl_FragColor = vec4(float(x) / 255.0, float(y) / 255.0,\nz / 255.0, a);\n}\n";
WALK.SHADERS["object_distance_float_fragment.glsl"]="//AUTO GENERATED\nuniform int objectId;\nvarying vec3 vPositionW;\nvoid main(void){\nfloat cameraDistance = distance(cameraPosition, vPositionW);\ngl_FragColor = vec4(objectId, cameraDistance, 0.0, 1.0);\n}\n";WALK.SHADERS["object_distance_vertex.glsl"]="//AUTO GENERATED\nvarying vec3 vPositionW;\nvoid main() {\nvPositionW = (modelMatrix * vec4(position, 1.0)).xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n";
WALK.SHADERS["procedural_sky_fragment.glsl"]="//AUTO GENERATED\nconst float PI = 3.14159265358979;\nconst float RECIPROCAL_PI2 = 0.15915494;\nfloat saturate(in float a) {\nreturn clamp(a, 0.0, 1.0);\n}\nvec3 inverseTransformDirection(in vec3 normal, in mat4 matrix) {\nreturn normalize((vec4(normal, 0.0) * matrix).xyz);\n}\nuniform vec3 topColor;\nuniform vec3 bottomColor;\nuniform float sinBottomAngle;\nuniform float exponent;\nvarying vec3 vWorldDirection;\n#ifdef HDR_OUTPUT\nfloat _g2l(in float x) {\nreturn (x <= 0.04045) ? x / 12.92 : pow((x + 0.055) / 1.055, 2.4);\n}\nvec3 gammaToLinear(in vec3 rgb) {\nreturn vec3(_g2l(rgb.r), _g2l(rgb.g), _g2l(rgb.b));\n}\nvec4 hdrEncode(in vec3 rgb) {\nconst float rgbmScale = 2.82842712;  // sqrt(8)\nvec3 r = sqrt(rgb) / rgbmScale;\nfloat m = max(max(r.r, r.g), r.b);\nm = clamp(m, 1.0 / 255.0, 1.0);\nm = ceil(m * 255.0) / 255.0;\nr /= m;\nreturn vec4(r.r, r.g, r.b, (1.0 - m));\n}\n#endif\n#ifdef USE_COLORMAP\nvec3 colormap(in sampler2D texture, in vec3 color) {\nconst float resolution = 16.0;\nconst float maxValueIndex = resolution - 1.0;\nconst float sliceWidth = 1.0 / resolution;\nconst float slicePixelWidth = sliceWidth / resolution;\nconst float sliceMarginWidth = 0.5 * slicePixelWidth;\nconst float sliceInnerWidth = sliceWidth - slicePixelWidth;\nconst float slicePixelHeight = 1.0 / resolution;\nconst float sliceMarginHeight = 0.5 * slicePixelHeight;\nconst float sliceInnerHeight = 1.0 - slicePixelHeight;\nfloat bSlice0 = min(floor(color.b * maxValueIndex), maxValueIndex - 1.0);\nfloat bSlice1 = bSlice0 + 1.0;\nfloat bOffset = color.b * maxValueIndex - bSlice0;\nfloat rSlicePos = sliceMarginWidth + color.r * sliceInnerWidth;\nfloat gSlicePos = sliceMarginHeight + color.g * sliceInnerHeight;\nfloat rPos0 = rSlicePos + (bSlice0 * sliceWidth);\nfloat rPos1 = rSlicePos + (bSlice1 * sliceWidth);\nvec3 color0 = texture2D(texture, vec2(rPos0, gSlicePos)).rgb;\nvec3 color1 = texture2D(texture, vec2(rPos1, gSlicePos)).rgb;\nreturn mix(color0, color1, bOffset);\n}\nuniform sampler2D colorMap;\n#endif\nvoid main() {\nfloat sinDirection = normalize(vWorldDirection).z;\nfloat w = max(0.0, (sinDirection - sinBottomAngle) / (1.0 - sinBottomAngle));\nvec3 colorGamma = mix(bottomColor, topColor, pow(w, exponent));\n#ifdef HDR_OUTPUT\nvec3 colorLinear = gammaToLinear(colorGamma);\ngl_FragColor = hdrEncode(10.0 * colorLinear);\n#else\n#ifdef USE_COLORMAP\ngl_FragColor.xyz = colormap(colorMap, colorGamma);\n#else\ngl_FragColor.xyz = colorGamma;\n#endif\n#endif\n}\n";
WALK.SHADERS["procedural_sky_vertex.glsl"]="//AUTO GENERATED\nvarying vec3 vWorldDirection;\nvoid main() {\nvec3 positionW = (modelMatrix * vec4(position, 1.0)).xyz;\nvWorldDirection = positionW - cameraPosition;\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n";WALK.SHADERS["vr_pointer_fragment.glsl"]="//AUTO GENERATED\nconst float PI = 3.14159265358979;\nconst float RECIPROCAL_PI2 = 0.15915494;\nfloat saturate(in float a) {\nreturn clamp(a, 0.0, 1.0);\n}\nvec3 inverseTransformDirection(in vec3 normal, in mat4 matrix) {\nreturn normalize((vec4(normal, 0.0) * matrix).xyz);\n}\nconst float pointRadius = 0.2;\nconst float pointBorder = 0.1;\nconst float timerRadius = 0.7;\nconst float timerBorder = 0.3;\nconst vec3 timerColor =  vec3(0.298, 0.619, 0.851);\nvarying vec2 coords;\nuniform float circleSpan;\nvoid main() {\nfloat dist =  sqrt(dot(coords, coords));\nif (dist < pointRadius) {\nfloat a = 1.0 - smoothstep(pointRadius - pointBorder, pointRadius, dist);\ngl_FragColor= vec4(1.0, 1.0, 1.0, a);\n} else if (-atan(coords.x, -coords.y) < circleSpan) {\nfloat a2 = smoothstep(timerRadius - timerBorder, timerRadius, dist) -\nsmoothstep(timerRadius, timerRadius + timerBorder, dist);\ngl_FragColor = vec4(timerColor, a2);\n} else {\ndiscard;\n}\n}\n";
WALK.SHADERS["vr_pointer_vertex.glsl"]="//AUTO GENERATED\nvarying vec2 coords;\nvoid main() {\ncoords = vec2(position.x, position.y);\nvec4 outPosition = projectionMatrix *  modelViewMatrix * vec4(position, 1.0);\noutPosition.z = -0.1;\ngl_Position = outPosition;\n}\n";WALK.SHADERS["walk_material_fragment.glsl"]="//AUTO GENERATED\nconst float PI = 3.14159265358979;\nconst float RECIPROCAL_PI2 = 0.15915494;\nfloat saturate(in float a) {\nreturn clamp(a, 0.0, 1.0);\n}\nvec3 inverseTransformDirection(in vec3 normal, in mat4 matrix) {\nreturn normalize((vec4(normal, 0.0) * matrix).xyz);\n}\nfloat _g2l(in float x) {\nreturn (x <= 0.04045) ? x / 12.92 : pow((x + 0.055) / 1.055, 2.4);\n}\nvec3 gammaToLinear(in vec3 rgb) {\nreturn vec3(_g2l(rgb.r), _g2l(rgb.g), _g2l(rgb.b));\n}\nfloat _l2g(in float x) {\nreturn (x <= 0.0031308) ? x * 12.92 : pow(x, 1.0 / 2.4) * 1.055 - 0.055;\n}\nvec3 linearToGamma(in vec3 rgb) {\nreturn vec3(_l2g(rgb.r), _l2g(rgb.g), _l2g(rgb.b));\n}\nvec3 linearToGammaUnreal(in vec3 rgb) {\nreturn rgb / (rgb + 0.187) * 1.035;\n}\nvec3 hdrDecode(in vec4 rgbm) {\nconst float rgbmScale = 2.82842712;  // sqrt(8)\nvec3 r = rgbm.rgb * (rgbmScale * (1.0 - rgbm.a));\nreturn r * r;\n}\n#if defined(USE_ENVMAP) || defined(USE_HEADLIGHT) || defined(USE_DYNAMIC_LIGHT)\nvarying vec3 vNormalW;\nvarying vec3 vPositionW;\n#endif\n#if defined(USE_MAP) || defined(USE_ROUGHNESSMAP) || defined(USE_METALLICMAP) || defined(USE_BUMPMAP)\nvarying vec2 vUv;\n#endif\n#if defined(USE_BUMPMAP)\nvarying vec3 vPositionV;\nvarying vec3 vNormalV;\nuniform float bumpScale;\nuniform sampler2D bumpMap;\nvec2 dBumpdxy() {\nvec2 texdx = dFdx(vUv);\nvec2 texdy = dFdy(vUv);\nfloat Hll = bumpScale * texture2D(bumpMap, vUv).x;\nfloat dBx = bumpScale * texture2D(bumpMap, vUv + texdx).x - Hll;\nfloat dBy = bumpScale * texture2D(bumpMap, vUv + texdy).x - Hll;\nreturn vec2(dBx, dBy);\n}\nvec3 perturbNormal(in vec3 surfPos, in vec3 surfNorm) {\nvec2 dBdxy = dBumpdxy();\nvec3 vSigmaX = dFdx(surfPos);\nvec3 vSigmaY = dFdy(surfPos);\nvec3 R1 = cross(vSigmaY, surfNorm);\nvec3 R2 = cross(surfNorm, vSigmaX);\nfloat fDet = dot(vSigmaX, R1);\nvec3 vGrad = sign(fDet) * (dBdxy.x * R1 + dBdxy.y * R2);\nreturn normalize(abs(fDet) * surfNorm - vGrad);\n}\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\nuniform vec4 mapUvMod;\n#ifdef USE_PARALLAX_CORRECTION\n#endif\n#else\nuniform vec3 diffuseColor;\n#endif\nuniform float opacity;\nuniform vec4 diffuseCorrection;\nvec3 getDiffuseColor(out float alpha) {\n#ifdef USE_MAP\n#ifdef USE_PARALLAX_CORRECTION\n#else\nvec2 mapUv = vUv;\n#endif\nmapUv = mapUv * mapUvMod.zw + mapUvMod.xy;\nvec4 diffuseGamma = texture2D(map, mapUv);\nvec3 diffuse = gammaToLinear(diffuseGamma.rgb);\nalpha = opacity * diffuseGamma.a;\n#else // NOT USE_MAP\nvec3 diffuse = diffuseColor;\nalpha = opacity;\n#endif\ndiffuse = diffuseCorrection.a * diffuse + diffuseCorrection.rgb;\nreturn clamp(diffuse, vec3(0.0, 0.0, 0.0), vec3(1.0, 1.0, 1.0));\n}\n#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\nvec3 getLightIntensity() {\nreturn hdrDecode(texture2D(lightMap, vUv2));\n}\n#else // NOT USE_LIGHTMAP\nvec3 getLightIntensity() {\nreturn vec3(1.0);\n}\n#endif\n#ifdef USE_ROUGHNESSMAP\nuniform sampler2D roughnessMap;\n#else\nuniform float roughness;\n#endif\n#ifdef USE_METALLICMAP\nuniform sampler2D metallicMap;\n#else\nuniform float metallic;\n#endif\n#if defined(USE_DYNAMIC_LIGHT) || defined(USE_ENVMAP)\nconst float DLT = 0.001;\n#ifdef USE_ENVMAP\nuniform samplerCube envMap;\nuniform float envMipsCount;\n#endif\nstruct Roughness {\n#ifdef USE_DYNAMIC_LIGHT\n#endif\n#ifdef USE_ENVMAP\nfloat envFresnel; // (1.0 - roughness)^2, used for Fresnel with env map\nfloat envMipLevel0;\nfloat envMipLevel1;\nfloat envMipMixFactor;\n#endif\n};\nRoughness getRoughnessFactors() {\nRoughness r;\n#ifdef USE_ROUGHNESSMAP\nfloat roughness = texture2D(roughnessMap, vUv).x;\n#endif // else roughness is a uniform\nfloat roughness2 = roughness * roughness;\n#ifdef USE_DYNAMIC_LIGHT\n#endif\n#ifdef USE_ENVMAP\nfloat maxMipLevel = envMipsCount - 1.0;\nfloat mipSelector = roughness * maxMipLevel;\nr.envMipLevel0 = floor(mipSelector);\nr.envMipLevel1 = min(r.envMipLevel0 + 1.0, maxMipLevel);\nr.envMipMixFactor = fract(mipSelector);\nr.envFresnel = (roughness2 - 2.0 * roughness + 1.0);\n#endif\nreturn r;\n}\n#ifdef USE_ENVMAP\n#ifdef USE_ENVMAP_PROJECT\nuniform vec3 envBoxMin;\nuniform vec3 envBoxMax;\nuniform vec3 envMapPosW;\nconst vec3 infBox = vec3(1000.0);\nvec3 cubeMapProject(vec3 reflectionW) {\nvec3 firstPlaneIntersect = (envBoxMax - vPositionW) / reflectionW;\nvec3 secondPlaneIntersect = (envBoxMin - vPositionW) / reflectionW;\nvec3 furthestPlane = max(firstPlaneIntersect, secondPlaneIntersect);\nvec3 furthestPlaneNonNeg =\nstep(0.0, -furthestPlane) * infBox + abs(furthestPlane);\nfloat distance = min(min(furthestPlaneNonNeg.x, furthestPlaneNonNeg.y),\nfurthestPlaneNonNeg.z);\n/*if (furthestPlane.x > 0.0){\ndistance = furthestPlane.x;\n}\nif (furthestPlane.y > 0.0) {\ndistance = min(distance, furthestPlane.y);\n}\nif (furthestPlane.z > 0.0) {\ndistance = min(distance, furthestPlane.z);\n}*/\nvec3 intersectionPosW = vPositionW + reflectionW * distance;\nreturn intersectionPosW - envMapPosW;\n}\n#endif // USE_ENVMAP_PROJECT\nvec3 fixSeams(vec3 vec, float mipLevel) {\nfloat scale = 1.0 - exp2(mipLevel) / 128.0;\nfloat M = max(max(abs(vec.x), abs(vec.y)), abs(vec.z));\nif (abs(vec.x) != M) vec.x *= scale;\nif (abs(vec.y) != M) vec.y *= scale;\nif (abs(vec.z) != M) vec.z *= scale;\nreturn vec;\n}\nvec3 getEnvColor(in samplerCube envMap, in Roughness roughness,\nin vec3 reflectionW) {\nvec3 reflectionNormW = normalize(reflectionW);\n#ifdef USE_ENVMAP_PROJECT\nif (envBoxMin.x != envBoxMax.x) {\nreflectionNormW = cubeMapProject(reflectionNormW);\n}\n#endif\nvec3 reflectionNormFixedW = fixSeams(reflectionNormW,\nroughness.envMipLevel0);\nvec4 cubeColorRaw0 = textureCubeLodEXT(envMap, reflectionNormFixedW,\nroughness.envMipLevel0);\n#ifdef USE_HDR_ENVMAP\nvec3 cubeColor0 = hdrDecode(cubeColorRaw0);\n#else\nvec3 cubeColor0 = gammaToLinear(cubeColorRaw0.xyz);\n#endif\nvec4 cubeColorRaw1 = textureCubeLodEXT(envMap, reflectionNormFixedW,\nroughness.envMipLevel1);\n#ifdef USE_HDR_ENVMAP\nvec3 cubeColor1 = hdrDecode(cubeColorRaw1);\n#else\nvec3 cubeColor1 = gammaToLinear(cubeColorRaw1.xyz);\n#endif\nreturn mix(cubeColor0, cubeColor1, roughness.envMipMixFactor);\n}\nvec3 fresnelSchlickEnv(in vec3 specularColor, in Roughness roughness,\nin float clampCosnv, inout float opacity) {\nfloat fresnel = 1.0 - clampCosnv;\nfloat fresnel2 = fresnel * fresnel;\nfresnel *= fresnel2 * fresnel2;\nfresnel *= roughness.envFresnel;\nopacity = opacity + (1.0 - opacity) * fresnel;\nreturn specularColor + (1.0 - specularColor) * fresnel;\n}\n#endif // USE_ENV_MAP\n#ifdef USE_DYNAMIC_LIGHT\n#endif // USE_DYNAMIC_LIGHT\nvec3 getSpecularColor(in vec3 diffuseColor, float metalic) {\nconst float dielectricF0 = 0.04;\nreturn mix(vec3(dielectricF0), diffuseColor, metalic);\n}\nfloat getLuminance(in vec3 color) {\nreturn 0.2126 * color.r + 0.7152 * color.g + 0.0722 * color.b;\n}\nvec4 lerpLightVisibility(in sampler2D map, in vec2 uv, in vec2 size) {\nvec2 fragAddress = uv * size + 0.5;\nvec2 weight = fract(fragAddress);\nvec2 sizeInv = 1.0 / size;\nvec2 uvlb = floor(fragAddress) * sizeInv;\nvec4 lb = texture2D(map, uvlb);\nvec4 lt = texture2D(map, uvlb + vec2(0.0, sizeInv.y));\nvec4 rb = texture2D(map, uvlb + vec2(sizeInv.x, 0.0));\nvec4 rt = texture2D(map, uvlb + vec2(sizeInv.x, sizeInv.y));\nvec4 lb_idx = floor(lb);\nvec4 lt_idx = floor(lt);\nvec4 rb_idx = floor(rb);\nvec4 rt_idx = floor(rt);\nvec4 lt_idx_smaller_eq = step(lt_idx, lb_idx);\nvec4 rb_idx_smaller_eq = step(rb_idx, lb_idx);\nvec4 rt_idx_smaller_eq = step(rt_idx, lb_idx);\nlt = clamp(lt, lb_idx, lb_idx + 0.999 * lt_idx_smaller_eq);\nrb = clamp(rb, lb_idx, lb_idx + 0.999 * rb_idx_smaller_eq);\nrt = clamp(rt, lb_idx, lb_idx + 0.999 * rt_idx_smaller_eq);\nvec4 a = mix(lb, lt, weight.y);\nvec4 b = mix(rb, rt, weight.y);\nreturn mix(a, b, weight.x);\n}\nvec3 addSpecular(in vec3 diffuse, in vec3 totalIntensity,\ninout float opacity) {\nvec3 totalSpec = vec3(0.0, 0.0, 0.0);\n#ifdef USE_METALLICMAP\nfloat metallic = texture2D(metallicMap, vUv).x;\n#endif // else metallic is a uniform\nvec3 diffuseIntensity = totalIntensity * (1.0 - mix(0.04, 1.0, metallic));\n#ifdef USE_BUMPMAP\nvec3 normalPerturbedV = perturbNormal(-vPositionV, normalize(vNormalV));\nvec3 normalW = normalize(\ninverseTransformDirection(normalPerturbedV, viewMatrix));\n#else\nvec3 normalW = normalize(vNormalW);\n#endif\nvec3 viewW = normalize(cameraPosition - vPositionW);\nfloat clampCosnv = saturate(dot(normalW, viewW));\nvec3 reflectionW = reflect(-viewW, normalW);\nvec3 specularColor = getSpecularColor(diffuse, metallic);\nRoughness roughness = getRoughnessFactors();\n#ifdef USE_ENVMAP\nvec3 envColor = getEnvColor(envMap, roughness, reflectionW);\nvec3 fresnel = fresnelSchlickEnv(specularColor, roughness,\nclampCosnv, opacity);\ntotalSpec = envColor * fresnel;\n#endif\n#ifdef USE_DYNAMIC_LIGHT\n#endif\nfloat luminance = getLuminance(totalIntensity);\nreturn (diffuse * diffuseIntensity +\ntotalSpec * mix(0.4, 1.0, luminance));\n}\n#else // NOT (USE_DYNAMIC_LIGHT or USE_ENVMAP)\nvec3 addSpecular(vec3 diffuse, in vec3 lightIntensity, in float opacity) {\nreturn diffuse * lightIntensity;\n}\n#endif\n#ifdef USE_HIGHLIGTH\nuniform vec3 highlight;\nuniform float highlightMix;\n#endif\n#if defined(HDR_OUTPUT)\nvec4 hdrEncode(in vec3 rgb) {\nconst float rgbmScale = 2.82842712;  // sqrt(8)\nvec3 r = sqrt(rgb) / rgbmScale;\nfloat m = max(max(r.r, r.g), r.b);\nm = clamp(m, 1.0 / 255.0, 1.0);\nm = ceil(m * 255.0) / 255.0;\nr /= m;\nreturn vec4(r.r, r.g, r.b, (1.0 - m));\n}\n#endif\n#ifdef USE_COLORMAP\nvec3 colormap(in sampler2D texture, in vec3 color) {\nconst float resolution = 16.0;\nconst float maxValueIndex = resolution - 1.0;\nconst float sliceWidth = 1.0 / resolution;\nconst float slicePixelWidth = sliceWidth / resolution;\nconst float sliceMarginWidth = 0.5 * slicePixelWidth;\nconst float sliceInnerWidth = sliceWidth - slicePixelWidth;\nconst float slicePixelHeight = 1.0 / resolution;\nconst float sliceMarginHeight = 0.5 * slicePixelHeight;\nconst float sliceInnerHeight = 1.0 - slicePixelHeight;\nfloat bSlice0 = min(floor(color.b * maxValueIndex), maxValueIndex - 1.0);\nfloat bSlice1 = bSlice0 + 1.0;\nfloat bOffset = color.b * maxValueIndex - bSlice0;\nfloat rSlicePos = sliceMarginWidth + color.r * sliceInnerWidth;\nfloat gSlicePos = sliceMarginHeight + color.g * sliceInnerHeight;\nfloat rPos0 = rSlicePos + (bSlice0 * sliceWidth);\nfloat rPos1 = rSlicePos + (bSlice1 * sliceWidth);\nvec3 color0 = texture2D(texture, vec2(rPos0, gSlicePos)).rgb;\nvec3 color1 = texture2D(texture, vec2(rPos1, gSlicePos)).rgb;\nreturn mix(color0, color1, bOffset);\n}\nuniform sampler2D colorMap;\n#endif\nuniform float emissionStrength;\nuniform float exposure;\nuniform float cameraGamma;\nvoid main() {\nfloat alpha;\nvec3 diffuse = getDiffuseColor(alpha);\nvec3 lightIntensity = getLightIntensity();\n#ifdef USE_HIGHLIGTH\ndiffuse = mix(diffuse, highlight, highlightMix);\nalpha = mix(alpha, 1.0, highlightMix);\n#endif\nvec3 diffuseSpecular = addSpecular(diffuse, lightIntensity, alpha);\n#ifdef USE_HEADLIGHT\nvec3 lightW = normalize(cameraPosition - vPositionW.xyz);\nfloat pointDiffuse = max(dot(normalize(vNormalW), lightW), 0.0);\ndiffuseSpecular *= pointDiffuse;\n#endif\nvec3 diffuseSpecularEmissive = diffuseSpecular + diffuse * emissionStrength;\n#ifdef HDR_OUTPUT\ngl_FragColor = hdrEncode(diffuseSpecularEmissive);\n#else // no HDR_OUTPUT\nvec3 exposedColor = pow(exposure * diffuseSpecularEmissive.xyz,\nvec3(cameraGamma));\nvec3 gammaColor =  linearToGammaUnreal(exposedColor);\n#ifdef USE_COLORMAP\ngl_FragColor.rgb = colormap(colorMap, min(gammaColor, 1.0));\n#else\ngl_FragColor.rgb = gammaColor;\n#endif\ngl_FragColor.a = alpha;\n#endif // no HDR_OUTPUT\n}\n";
WALK.SHADERS["walk_material_vertex.glsl"]="//AUTO GENERATED\nconst float PI = 3.14159265358979;\nconst float RECIPROCAL_PI2 = 0.15915494;\nfloat saturate(in float a) {\nreturn clamp(a, 0.0, 1.0);\n}\nvec3 inverseTransformDirection(in vec3 normal, in mat4 matrix) {\nreturn normalize((vec4(normal, 0.0) * matrix).xyz);\n}\nvec3 sphericalDecode(in vec2 spNormal) {\nfloat theta = (spNormal.x / 254.0 + 0.5) * PI;\nfloat phi = spNormal.y * (PI / 127.0);\nfloat sinTheta = sin(theta);\nreturn vec3(sinTheta * cos(phi), sinTheta * sin(phi), cos(theta));\n}\n#if defined(USE_MAP) || defined(USE_ROUGHNESSMAP) || defined(USE_METALLICMAP) || defined(USE_BUMPMAP)\nvarying vec2 vUv;\n#endif\n#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif\n#ifdef USE_BUMPMAP\nvarying vec3 vPositionV;\nvarying vec3 vNormalV;\n#endif\n#if defined(USE_ENVMAP) || defined(USE_HEADLIGHT) || defined(USE_DYNAMIC_LIGHT)\nvarying vec3 vNormalW;\nvarying vec3 vPositionW;\n#endif\nvoid main() {\n#if defined(USE_MAP) || defined(USE_ROUGHNESSMAP) || defined(USE_METALLICMAP) || defined(USE_BUMPMAP)\nvUv = uv;\n#endif\nvec4 mvPosition = modelViewMatrix * vec4(position, 1.0);\n#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif\n#if defined(USE_BUMPMAP) || defined(USE_ENVMAP) || defined(USE_HEADLIGHT) || defined(USE_DYNAMIC_LIGHT)\nvec3 normal = sphericalDecode(sphericalNormal);\n#endif\n#if defined(USE_BUMPMAP)\nvPositionV = -mvPosition.xyz;\nvNormalV = normalize(normalMatrix * normal);\n#endif\n#if defined(USE_ENVMAP) || defined(USE_HEADLIGHT) || defined(USE_DYNAMIC_LIGHT)\nvNormalW = mat3(modelMatrix[0].xyz,\nmodelMatrix[1].xyz,\nmodelMatrix[2].xyz) * normal;\nvNormalW = normalize(vNormalW);\nvPositionW = (modelMatrix * vec4(position, 1.0)).xyz;\n#endif\ngl_Position = projectionMatrix * mvPosition;\n}\n";
WALK.SHADERS["wireframe_fragment.glsl"]="//AUTO GENERATED\nuniform vec3 lineColor;\nuniform float lineMaxAlpha;\nuniform vec3 highlight;\nuniform float highlightMix;\nvarying vec3 vBaryCentric;\nfloat edgeFactor(){\nvec3 d = fwidth(vBaryCentric);\nvec3 r = smoothstep(vec3(0.0), d * 1.5, vBaryCentric);\nreturn min(min(r.x, r.y), r.z);\n}\nvoid main(void){\nfloat edge = edgeFactor();\nif (edge < 1.0) {\ngl_FragColor.rgb = lineColor;\ngl_FragColor.w = (1.0 - edge) * lineMaxAlpha;\n} else {\ngl_FragColor.rgb = highlight;\ngl_FragColor.w = highlightMix;\n}\n}\n";
WALK.SHADERS["wireframe_vertex.glsl"]="//AUTO GENERATED\nattribute float order;\nvarying vec3 vBaryCentric;\nvoid main() {\nif (order == 0.0) {\nvBaryCentric = vec3(1.0, 0.0, 0.0);\n} else if (order == 1.0) {\nvBaryCentric = vec3(0.0, 1.0, 0.0);\n} else {\nvBaryCentric = vec3(0.0, 0.0, 1.0);\n}\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n";(function(){WALK.getShader=function(a){return WALK.SHADERS[a]}})();(function(){function a(a){var b,c=0;for(b=0;b<a.length;b+=1)a[b].id>=c&&(c=a[b].id+1);return c}function b(a,b){var c;for(c=0;c<a.length;c+=1)if(a[c].name===b)return!1;return!0}function c(a,c){var d,e=a;for(d=2;!b(c,e);d+=1)e=a+d.toString();return e}WALK.EditorHooks=function(b,e,f,g,h,k,m){function d(a){console.assert("diffuse"===a||"roughness"===a||"metallic"===a||"bump"===a);return"diffuse"===a?"map":a+"Map"}var n,p,q;q={geometryGpuSize:e.gpuIndexedBuffersSize,geometryFacesCnt:e.nodes.reduce(function(a,
b){return a+b.facesInSubtree()},0)};n=new WALK.TextureLoader("./img/",b,function(a){m.requestFrame()},function(){WALK.USER_MSG.info("Failed to load texture")},!0);p=new WALK.SkyLoader(n);this.getCameraPosition=function(){var a=g.cameraWorldPosition();return[a.x,a.y,a.z]};this.getCameraRotation=function(){return[THREE.Math.radToDeg(g.getYawAngle()),THREE.Math.radToDeg(g.getPitchAngle())]};this.getCameraExposure=function(){return e.cameraExposure};this.setCameraExposure=function(a){e.cameraExposure=
a;m.requestFrame()};this.getCameraGamma=function(){return e.cameraGamma};this.setCameraGamma=function(a){e.cameraGamma=a;m.requestFrame()};this.getCameraFov=function(){return e.camera.fov};this.setCameraFov=function(a){e.camera.fov=a;e.camera.updateProjectionMatrix();m.requestFrame()};this.getCameraAutoClimb=function(){return e.camera.autoClimb};this.setCameraAutoClimb=function(a){e.camera.autoClimb=a};this.getCameraMoveMaxSpeed=function(){return e.camera.moveMaxSpeed};this.setCameraMoveMaxSpeed=
function(a){e.camera.moveMaxSpeed=a};this.getSceneStats=function(){return q};this.getMaterials=function(){return e.sortedMaterials()};this.getLights=function(){return e.lights};this.getLightProbes=function(){return e.lightProbes};this.getNodes=function(){return e.sortedNodes()};this.addLight=function(a,b,d){a=new WALK.Light({name:c(a,e.lights),type:b,doNotImport:!0});a.addInstance(d,[0,-90,0]);e.addLight(a)};this.removeLight=function(a){e.removeLight(a)};this.addLightInstance=function(a,b){a.addInstance(b,
[0,-90,0])};this.removeLightInstance=function(a,b){a.removeInstance(b)};this.addLightProbe=function(b){var c=a(e.lightProbes);e.addLightProbe(new WALK.LightProbe({id:c,position:b,box:{min:[0,0,0],max:[0,0,0]}}));1===e.lightProbes.length&&e.enableLightProbesForMaterials()};this.removeLightProbe=function(a){e.removeLightProbe(a);0===e.lightProbes.length&&e.disableLightProbesForMaterials()};this.getViews=function(){return e.views.filter(function(a){return!a.internal})};this.addViewFromCamera=function(b,
d){var f,h;f=[];var k;console.assert("fps"===d||"top"===d||"orbit"===d);h=g.cameraWorldPosition();f[0]=THREE.Math.radToDeg(g.getYawAngle());f[1]=THREE.Math.radToDeg(g.getPitchAngle());f={id:a(e.views),name:c(b.trim()||"view",e.views),rotation:f};"fps"===d?(f.mode="fps",f.sky=WALK.EDITOR_CONTROLLED_SKY_NAME,f.position=h.toArray()):"top"===d?(f.mode="orbit",f.sky=WALK.DEFAULT_SKY_NAME,f.rotation[1]=-90,f.panPrimary=!0,f.noPitchRotate=!0,f.target=[h.x,h.y,e.boundingBox.min.z],f.distance=Math.max(h.z-
e.boundingBox.min.z,1)):(f.mode="orbit",f.sky=WALK.DEFAULT_SKY_NAME,k=e.boundingBox.center(),f.target=k.toArray(),k.sub(h),f.distance=k.length(),k.normalize(),h=[THREE.Math.radToDeg(Math.atan2(-k.x,k.y)),THREE.Math.radToDeg(Math.asin(k.z))],f.rotation=h,f.panPrimary=!1,f.noPitchRotate=!1);f=new WALK.View(f);e.addView(f);return f};this.resetViewFromCamera=function(a){var b=g.cameraWorldPosition();"fps"===a.mode?(a.position.copy(b),a.rotation.yaw=g.getYawAngle(),a.rotation.pitch=g.getPitchAngle()):
(a.target.copy(g.orbit.target),a.distance=b.distanceTo(a.target),a.rotation.yaw=g.getYawAngle(),a.isTop()||(a.rotation.pitch=g.getPitchAngle()))};this.removeView=function(a){e.removeView(a)};this.changeViewPosition=function(a,b){e.changeViewPosition(a,b)};this.switchSkyForView=function(a){a.usesDefaultSky()?a.sky=WALK.EDITOR_CONTROLLED_SKY_NAME:a.sky=WALK.DEFAULT_SKY_NAME;h.activateSky(a)};this.switchToView=function(a){h.switchToView(a,!1);$("walk-canvas").focus()};this.renameView=function(a,b){b=
b.trim()||"view";a.name="";a.name=c(b,e.views);f.refresh()};this.updateHiddenMeshes=function(a){h.updateHiddenMeshes(a)};this.getSky=function(){return e.findSkyMesh(WALK.EDITOR_CONTROLLED_SKY_NAME)};this.changeTexture=function(a,b,c){var f,g,h,k,l;f=d(b);h=n.load(WALK.LOAD_PRIORITY.CORE_RESOURCE,c,!0,!0,WALK.DEFAULT_ANISOTROPY);h.fromEditor=!0;if(g=a.map)h.wrapS=g.wrapS,h.wrapT=g.wrapT,h.anisotropy=g.anisotropy;a.setTexture(f,h);"diffuse"===b?(a.mapName=h.name,a.color.fromArray(c.avgColor),a.resetDiffuseMapProperties()):
"bump"===b&&a.resetBumpMapProperties();k=new Set;l="";e.visitMeshesWithMaterial(a,function(a){0===a.geometry.vertexCnt||a.uv0InBuffers()||k.has(a.node.name)||(k.add(a.node.name),""!==l&&(l+=", "),l+="'"+a.node.name+"'")});return 0<k.size?l+(1<k.size?" do not":" does not")+" have diffuse UVs. Texture "+b+" won't be correctly mapped.":null};this.removeTexture=function(a,b){var c=d(b);a.removeTexture(c);"diffuse"===b?a.resetDiffuseMapProperties():"bump"===b&&a.resetBumpMapProperties();this.materialModified(a)};
this.changeSkyTexture=function(a){var b=e.findSkyMesh(WALK.EDITOR_CONTROLLED_SKY_NAME);b.isEquirect?p.loadSkyTexture(b,a):(e.removeSkyMesh(b),a={name:WALK.EDITOR_CONTROLLED_SKY_NAME,type:"equirect",texture:a},p.loadSingleSky(a,e));e.setSkyRadiusAndCameraFarToSpanWholeScene()};this.removeSkyTexture=function(){var a=e.findSkyMesh(WALK.EDITOR_CONTROLLED_SKY_NAME);a.isEquirect&&(e.removeSkyMesh(a),a={name:WALK.EDITOR_CONTROLLED_SKY_NAME,type:"procedural"},p.loadSingleSky(a,e));e.setSkyRadiusAndCameraFarToSpanWholeScene()};
this.getColorMapName=function(){return e.colorMap?e.colorMap.name:null};this.changeColorMap=function(a){e.colorMap=n.load(WALK.LOAD_PRIORITY.CORE_RESOURCE,a,!1,!1,WALK.NO_ANISOTROPY);e.colorMap.flipY=!1};this.removeColorMap=function(){e.colorMap=null;m.requestFrame()};this.getSceneJson=function(){return WALK.sceneToJson(e)};this.getCoverJson=function(){return f.cover};this.disableSelection=function(){k.setSelectionMode(k.SELECTION_MODE.OFF)};this.enableMaterialSelection=function(){k.setSelectionMode(k.SELECTION_MODE.MATERIAL)};
this.enableLightSelection=function(){k.setSelectionMode(k.SELECTION_MODE.LIGHT)};this.enableLightProbeSelection=function(){k.setSelectionMode(k.SELECTION_MODE.LIGHT_PROBE)};this.enableNodeSelection=function(){k.setSelectionMode(k.SELECTION_MODE.NODE)};this.selectMaterial=function(a){k.selectMaterial(a,!1)};this.selectLight=function(a){k.selectLight(a)};this.selectLightInstance=function(a){k.selectLightInstance(a,!1)};this.selectLightProbe=function(a){k.selectLightProbe(a,!1)};this.selectNodes=function(a,
b){k.selectNodes(a,b)};this.setMaterialSelectedCallback=function(a){k.setMaterialSelectedCallback(a)};this.setLightInstanceSelectedCallback=function(a){k.setLightInstanceSelectedCallback(a)};this.setLightProbeSelectedCallback=function(a){k.setLightProbeSelectedCallback(a)};this.setNodeSelectedCallback=function(a){k.setNodeSelectedCallback(a)};this.setViewSelectedCallback=function(a){h.addEventListener("teleportStarted",function(b){console.assert(null!==b.view);a(b.view)})};this.materialModified=function(a){a.setUniforms();
m.requestFrame()};this.lightModified=function(a){m.requestFrame()};this.lightInstanceModified=function(a){m.requestFrame()};this.lightProbeModified=function(a){m.requestFrame()};this.nodeModified=function(a){};this.skyModified=function(a){a.updateMatrixWorld();m.requestFrame()};this.coverModified=function(a){f.updateCover(a)};this.autoTourModified=function(){f.refresh()};this.hasLightMap=function(){return e.hasLightMap()};this.getAutoTour=function(){return e.autoTour};this.getDisableProgressiveLoader=
function(){return e.disableProgressiveLoader};this.setDisableProgressiveLoader=function(a){e.disableProgressiveLoader=a};this.getSceneScaleHtmlWarning=function(){var a=e.boundingBox;return!a.empty()&&(a=a.size(),200<a.x||200<a.y||200<a.z)?"The scene has unusually large dimensions: <strong>"+Math.round(a.x)+"m x "+Math.round(a.y)+"m x "+Math.round(a.z)+'m</strong>.</br></br>Shapespark assumes real-world scale, 1 meter in the scene should correspond to 1 meter in the real world. If the scale of the scene is invalid, either re-scale the model or change the scale in the import dialog, otherwise you can disable this message.</br></br>For more information consult <a href="/assets/help.html#importing-the-scene">Importing the scene</a> section of the help.':
null}};WALK.SceneLoadConfig=function(){this.assetsUrl="./";this.onSceneLoaded=null;this.enableCollisions=!0;this.editMode=!1;this.forcedInitialCameraRotation=this.forcedInitialCameraPosition=null;this._meshHoverListeners=[];this._meshClickListeners=[]};WALK.SceneLoadConfig.prototype={constructor:WALK.SceneLoadConfig,onMaterialHoverChange:function(a){this._meshHoverListeners.push(function(b,c){return a(b.material,c)})},onNodeClicked:function(a){this._meshClickListeners.push(function(b,c,d){return a(b.node,
c,d)})},onMaterialClicked:function(a){this._meshClickListeners.push(function(b,c,d){return a(b.material,c,d)})},hasMouseListeners:function(){return 0<this._meshHoverListeners.length||0<this._meshClickListeners.length}}})();(function(){function a(){var a,b,e;a=new THREE.BufferGeometry;b=new Float32Array(288);a.addAttribute("position",new THREE.BufferAttribute(b,3));e=0;[[[-1,-1,-1],[-1,-.6,-1],[-.6,-1,-1]],[[-1,-1,-1],[-1,-1,-.6],[-1,-.6,-1]],[[-1,-1,-1],[-.6,-1,-1],[-1,-1,-.6]],[[-.6,-1,-1],[-1,-.6,-1],[-1,-1,-.6]],[[-1,-1,1],[-.6,-1,1],[-1,-.6,1]],[[-1,-1,1],[-1,-.6,1],[-1,-1,.6]],[[-1,-1,1],[-1,-1,.6],[-.6,-1,1]],[[-.6,-1,1],[-1,-1,.6],[-1,-.6,1]],[[1,-1,-1],[.6,-1,-1],[1,-.6,-1]],[[1,-1,-1],[1,-.6,-1],[1,-1,-.6]],
[[1,-1,-1],[1,-1,-.6],[.6,-1,-1]],[[.6,-1,-1],[1,-1,-.6],[1,-.6,-1]],[[-1,1,-1],[-.6,1,-1],[-1,.6,-1]],[[-1,1,-1],[-1,.6,-1],[-1,1,-.6]],[[-1,1,-1],[-1,1,-.6],[-.6,1,-1]],[[-.6,1,-1],[-1,1,-.6],[-1,.6,-1]],[[1,1,1],[.6,1,1],[1,.6,1]],[[1,1,1],[1,.6,1],[1,1,.6]],[[1,1,1],[1,1,.6],[.6,1,1]],[[.6,1,1],[1,1,.6],[1,.6,1]],[[1,-1,1],[1,-.6,1],[.6,-1,1]],[[1,-1,1],[1,-1,.6],[1,-.6,1]],[[1,-1,1],[.6,-1,1],[1,-1,.6]],[[.6,-1,1],[1,-.6,1],[1,-1,.6]],[[1,1,-1],[1,.6,-1],[.6,1,-1]],[[1,1,-1],[1,1,-.6],[1,.6,
-1]],[[1,1,-1],[.6,1,-1],[1,1,-.6]],[[.6,1,-1],[1,.6,-1],[1,1,-.6]],[[-1,1,1],[-1,.6,1],[-.6,1,1]],[[-1,1,1],[-1,1,.6],[-1,.6,1]],[[-1,1,1],[-.6,1,1],[-1,1,.6]],[[-.6,1,1],[-1,.6,1],[-1,1,.6]]].forEach(function(a){var c,d;for(c=0;3>c;c+=1)for(d=0;3>d;d+=1)b[e]=a[c][d],e+=1});a.computeVertexNormals();a.convertNormalsToSpherical();return a}function b(){var a=new WALK.Material;a.disableLightProbe=!0;a.headLight=!0;a.color=WALK.EDITOR_SELECTION_COLOR;a.setUniforms();return a}WALK.LightControls=function(c,
d){function e(a){var b;"spot"===a.type?(b=THREE.Math.degToRad(a.angle),a=1*Math.cos(b/2),b=1*Math.sin(b/2),b=new THREE.CylinderBufferGeometry(0,b,a,32,2),x.makeTranslation(0,-a/2,0),b.applyMatrix(x),b.convertNormalsToSpherical()):b=r;return b}function f(a,b,d){var e,f;e=new WALK.LightMaterial(a);d=new THREE.Mesh(d,e);d.visibilityId=null;e=new THREE.Mesh(t,v);d.add(e);"sun"!==a.type?(d.rotateZ(Math.PI),e=b.rotation.toQuaternion().multiply(d.quaternion),d.setRotationFromQuaternion(e),d.position.copy(b.position),
d.scale.set(a.size,a.size,a.size)):(a=c.findSkyMesh(WALK.EDITOR_CONTROLLED_SKY_NAME),e=a.scale.x,f=1*Math.PI*e*1.5/360,d.position.set(0,-e,0),d.position.applyEuler(b.rotation),d.position.add(a.position),d.scale.set(f,f,f));d.userData.lightInstance=b;d.updateMatrixWorld();q.lightInstanceMeshes.push(d);u&&c.threeScene.add(d)}function g(a){var b;b=e(a);a.forEachLightInstance(function(c){f(a,c,b)})}function h(a){var b,c;for(b=0;b<q.lightInstanceMeshes.length;b+=1)if(c=q.lightInstanceMeshes[b],c.userData.lightInstance===
a)return c;return null}function k(a){var b,d,e=[];for(b=0;b<q.lightInstanceMeshes.length;b+=1)d=q.lightInstanceMeshes[b],d.userData.lightInstance.light===a?(u&&c.threeScene.remove(d),d.geometry!==r&&d.geometry.dispose(),d.material.dispose()):e.push(d);q.lightInstanceMeshes=e}function m(a){a=a.light;k(a);g(a);d.requestFrame()}function l(a){var b,c;a=a.instance;b=a.light;c=b.instances[0]!==a?h(b.instances[0]).geometry:e(b);f(b,a,c);d.requestFrame()}function n(a){a=a.instance.light;k(a);g(a);d.requestFrame()}
function p(a){g(a);a.addEventListener("lightUpdated",m);a.addEventListener("lightInstanceAdded",l);a.addEventListener("lightInstanceRemoved",n)}var q=this,u=!1,r,t,v,x;r=new THREE.SphereBufferGeometry(1,32,16);r.convertNormalsToSpherical();t=a();v=b();this.lightInstanceMeshes=[];x=new THREE.Matrix4;this.getLightInstanceMaterial=function(a){return h(a).material};this.showLights=function(){var a;if(!u){u=!0;for(a=0;a<this.lightInstanceMeshes.length;a+=1)c.threeScene.add(this.lightInstanceMeshes[a]);
d.requestFrame()}};this.showSelectionMesh=function(a){this.lightInstanceMeshes.forEach(function(b){b.children[0].visible=b.userData.lightInstance.light===a?!0:!1})};this.hideLights=function(){var a;if(u){u=!1;for(a=0;a<this.lightInstanceMeshes.length;a+=1)c.threeScene.remove(this.lightInstanceMeshes[a]);d.requestFrame()}};c.lights.forEach(p);c.addEventListener("lightAdded",function(a){p(a.light);d.requestFrame()});c.addEventListener("lightRemoved",function(a){k(a.light);d.requestFrame()})}})();(function(){function a(){var a=new WALK.WireframeMaterial(WALK.EDITOR_SELECTION_COLOR);a.depthTest=!0;a.depthWrite=!1;a.side=THREE.DoubleSide;return a}WALK.LightProbeControls=function(b,c){function d(a,b){b.position.addVectors(a.boxMin,a.boxMax).multiplyScalar(.5).sub(a.position);b.scale.subVectors(a.boxMax,a.boxMin);b.scale.subScalar(.005)}function e(a){var c,e;c=new WALK.Material;c.disableLightProbe=!1;c.highlight=WALK.EDITOR_SELECTION_COLOR;c.metallic=1;c.roughness=0;c.setUniforms();c=new THREE.Mesh(p,
c);c.visibilityId=null;c.userData.hideFromLightProbes=!0;c.lightProbe=a;c.position.copy(a.position);e=new THREE.Mesh(u,q);e.userData.hideFromLightProbes=!0;e.visible=!1;c.add(e);a.hasBoundingBox()&&d(a,e);c.updateMatrixWorld(!0);c.visible=n;l.lightProbeMeshes.push(c);b.threeScene.add(c)}function f(a){var b,c;for(b=0;b<l.lightProbeMeshes.length;b+=1)if(c=l.lightProbeMeshes[b],c.lightProbe===a)return b;console.assert(!1);return null}function g(a){var b,c;c=a.lightProbe;a=l.lightProbeMeshes[f(c)];a.position.copy(c.position);
b=a.children[0];c.hasBoundingBox()?(d(c,b),b.visible=!0):b.visible=!1;a.updateMatrixWorld()}function h(a){a=a.lightProbe;e(a);l.showLightProbeBoundingBox(a);c.requestFrame();a.addEventListener("lightProbePositionUpdated",g);a.addEventListener("lightProbeBoundsUpdated",g)}function k(a){a=f(a.lightProbe);var d;d=l.lightProbeMeshes[a];n&&b.threeScene.remove(d);d.material.dispose();l.lightProbeMeshes.splice(a,1);c.requestFrame()}function m(a){var b,c;for(b=0;b<l.lightProbeMeshes.length;b+=1)if(c=l.lightProbeMeshes[b],
c.lightProbe===a)return c;return null}var l=this,n=!1,p,q,u,r=null;this.lightProbeMeshes=[];p=new THREE.SphereBufferGeometry(.2,32,16);p.convertNormalsToSpherical();q=a();u=new THREE.BoxBufferGeometry(1,1,1);u.addTriangleOrderAttribute();u.convertNormalsToSpherical();this.getLightProbeMaterial=function(a){return(a=m(a))?a.material:null};this.showLightProbeBoundingBox=function(a){r&&(r.visible=!1,r=null);a.hasBoundingBox()&&(a=m(a),r=a.children[0],r.visible=!0)};this.showLightProbes=function(){var a;
if(!n)for(n=!0,a=0;a<this.lightProbeMeshes.length;a+=1)this.lightProbeMeshes[a].visible=!0;c.requestFrame()};this.hideLightProbes=function(){var a;if(n)for(n=!1,a=0;a<this.lightProbeMeshes.length;a+=1)this.lightProbeMeshes[a].visible=!1;c.requestFrame()};(function(){var a,c;for(a=0;a<b.lightProbes.length;a+=1)c=b.lightProbes[a],e(c),c.addEventListener("lightProbePositionUpdated",g),c.addEventListener("lightProbeBoundsUpdated",g);b.addEventListener("lightProbeAdded",h);b.addEventListener("lightProbeRemoved",
k)})()}})();(function(){function a(a){var b=a.touches;return(b?b[0].clientX:a.clientX)/window.innerWidth*2-1}function b(a){var b=a.touches;return 2*-((b?b[0].clientY:a.clientY)/window.innerHeight)+1}WALK.PointerEventHelper=function(){this.clipY=this.clipX=this._downClipY=this._downClipX=null;this._handleClick=!1};WALK.PointerEventHelper.prototype={constructor:WALK.PointerEventHelper,pointerDown:function(c){c=c||window.event;this._downClipX=this.clipX=a(c);this._downClipY=this.clipY=b(c);this._handleClick=void 0!==
c.touches||0===c.button},pointerMove:function(c){c=c||window.event;this.clipX=a(c);this.clipY=b(c);this._handleClick&&(.03<Math.abs(this._downClipY-this.clipY)||.03<Math.abs(this._downClipX-this.clipX))&&(this._handleClick=!1)},pointerUp:function(a){if(document.pointerLockElement||document.mozPointerLockElement||document.webkitPointerLockElement)return this.clipY=this.clipX=0,!0;a=this._handleClick;this._handleClick=!1;return a}}})();(function(){var a=function(a,c){this._nodesPrimary=a;this._nodesSecondary=c};a.prototype.constructor=a;Object.defineProperty(a.prototype,"highlightMix",{set:function(a){this._nodesPrimary.forEach(function(b){b.highlightMix=a});this._nodesSecondary.forEach(function(b){b.highlightMix=a})}});Object.defineProperty(a.prototype,"selected",{set:function(a){this._nodesPrimary.forEach(function(b){b.selected=a});this._nodesSecondary.forEach(function(b){b.selectedSecondary=a})}});WALK.EditorSelector=function(b,
c,d,e,f,g){function h(){}function k(){u.highlightMix=.8*Math.pow(r/q.selectionTimeSec,2)}function m(a){u&&(u.highlightMix=0);a&&(u=a,r=q.selectionTimeSec,k());g.requestFrame()}function l(){x.set(!0,!1,!1);w.set(E);b.threeScene.overrideMaterial=C;b.gpuMeshes.forEach(function(a){a.geometry.addTriangleOrderAttribute();a.highlightMix=0;a.selected=!1;c.uploadNewBuffers(a)});b.skyMeshes.forEach(function(a){a.visible=!1})}function n(){x.restore();w.restore();b.threeScene.overrideMaterial=null;b.gpuMeshes.forEach(function(a){a.highlightMix=
null;a.selected=null;a.selectedSecondary=!1});y=null;b.skyMeshes.forEach(function(a){a.visible=!0})}function p(){var a=new WALK.PointerEventHelper;c.domElement.addEventListener("mousedown",function(b){v!==q.SELECTION_MODE.OFF&&a.pointerDown(b)},!1);c.domElement.addEventListener("mousemove",function(b){a.pointerMove(b)},!1);c.domElement.addEventListener("mouseup",function(b){a.pointerUp(b)&&(v===q.SELECTION_MODE.MATERIAL?(b=(b=d.findObstacleMeshAtPosition(a.clipX,a.clipY))?b.material:null,q.selectMaterial(b,
!0)):v===q.SELECTION_MODE.LIGHT?(b=(b=d.findMeshFromListAtPosition(e.lightInstanceMeshes,a.clipX,a.clipY))?b.userData.lightInstance:null,q.selectLightInstance(b,!0)):v===q.SELECTION_MODE.LIGHT_PROBE?(b=(b=d.findMeshFromListAtPosition(f.lightProbeMeshes,a.clipX,a.clipY))?b.lightProbe:null,q.selectLightProbe(b,!0)):v===q.SELECTION_MODE.NODE?(b=d.findObstacleMeshAtPosition(a.clipX,a.clipY),b=null!==b?b.node:null,q._selectNode(b)):console.error("Invalid editor selector selection mode "+v))},!1)}var q=
this,u=null,r,t,v,x,w,E,C,y=null;t={materialSelected:h,lightInstanceSelected:h,lightProbeSelected:h,nodeSelected:h};this.SELECTION_MODE={OFF:0,MATERIAL:1,LIGHT:2,LIGHT_PROBE:3,NODE:4};v=this.SELECTION_MODE.OFF;this.selectionTimeSec=1;this.selectMaterial=function(a,b){console.assert(v===this.SELECTION_MODE.MATERIAL);m(a);a&&b&&t.materialSelected(a)};this.selectLight=function(a){console.assert(v===this.SELECTION_MODE.LIGHT);e.showSelectionMesh(a);g.requestFrame()};this.selectLightInstance=function(a,
b){var c=null;console.assert(v===this.SELECTION_MODE.LIGHT);a&&(c=e.getLightInstanceMaterial(a));m(c);a&&b&&t.lightInstanceSelected(a)};this.selectLightProbe=function(a,b){var c=null;console.assert(v===this.SELECTION_MODE.LIGHT_PROBE);a&&(f.showLightProbeBoundingBox(a),c=f.getLightProbeMaterial(a));m(c);a&&b&&t.lightProbeSelected(a)};this.selectNodes=function(b,c){console.assert(v===this.SELECTION_MODE.NODE);y&&(y.selected=!1);b.length||c.length?(y=new a(b,c),y.selected=!0):y=null;m(y)};this._selectNode=
function(a){null!==a?this.selectNodes([a],[]):this.selectNodes([],[]);a&&t.nodeSelected(a)};this.update=function(a){u&&(r-=a,0<r?k():(u.highlightMix=0,u=null),g.requestFrame())};this.setSelectionMode=function(a){if(a!==v){v===this.SELECTION_MODE.NODE&&n();switch(a){case this.SELECTION_MODE.OFF:case this.SELECTION_MODE.MATERIAL:e.hideLights();f.hideLightProbes();break;case this.SELECTION_MODE.LIGHT:e.showLights();f.hideLightProbes();break;case this.SELECTION_MODE.LIGHT_PROBE:e.hideLights();f.showLightProbes();
break;case this.SELECTION_MODE.NODE:e.hideLights(),f.hideLightProbes(),l()}v=a}};this.setMaterialSelectedCallback=function(a){console.assert(t.materialSelected===h);t.materialSelected=a};this.setLightInstanceSelectedCallback=function(a){console.assert(t.lightInstanceSelected===h);t.lightInstanceSelected=a};this.setLightProbeSelectedCallback=function(a){console.assert(t.lightProbeSelected===h);t.lightProbeSelected=a};this.setNodeSelectedCallback=function(a){console.assert(t.nodeSelected===h);t.nodeSelected=
a};(function(){p();b.materials.forEach(function(a){a.highlight=WALK.EDITOR_SELECTION_COLOR;a.highlightMix=0;a.setUniforms()});x=new WALK.AutoClearAlter(c);w=new WALK.ClearColorAlter(c);E=new THREE.Color(16777215);C=new WALK.WireframeMaterial(new THREE.Color(0));C.highlight=C.meshSelectedLineColor})()}})();(function(){WALK.ScreenshotTaker=function(a,b){function c(c,d){var e,f,k,m;f=new THREE.WebGLRenderTarget(c,d,{format:THREE.RGBAFormat,magFilter:THREE.NearestFilter,minFilter:THREE.NearestFilter,stencilBuffer:!1});f.generateMipmaps=!1;k=new THREE.WebGLRenderTarget(c,d,{format:THREE.RGBAFormat,magFilter:THREE.NearestFilter,minFilter:THREE.NearestFilter,stencilBuffer:!1,depthBuffer:!1});k.generateMipmaps=!1;e=new WALK.SsaaRenderer(a,b);for(e.setTargets(f,k);!e.allSamplesRendered();)e.renderSample();
m=e.copyAccumulatedSamplesToBuffer();f.dispose();k.dispose();e.dispose();return m}function d(a){var b,d,e,k,m,l,n,p,q;if(80===a.keyCode){a.preventDefault();a=window.innerWidth;b=window.innerHeight;d=c(a,b);e=document.createElement("canvas");e.height=b;e.width=a;k=e.getContext("2d");m=k.createImageData(a,b);for(n=0;n<b;++n)for(l=0;l<a;++l)q=4*((b-n-1)*a+l),p=4*(n*a+l),m.data[p]=d[q],m.data[p+1]=d[q+1],m.data[p+2]=d[q+2],m.data[p+3]=255;k.putImageData(m,0,0);window.open(e.toDataURL("image/png","Image"),
"_blank")}}this.screenToServer=function(){var a=c(WALK.EDITOR_SCREENSHOT_WIDTH,WALK.EDITOR_SCREENSHOT_HEIGHT);WALK.ajaxPost("cover-image","application/binary",a)};this.registerKeyHandler=function(){document.addEventListener("keydown",d)}}})();(function(){WALK.VRManager=function(a,b,c){function d(a){0<a.length?(f.vrDisplay=a[0],WALK.log("VR device detected "+f.vrDisplay.displayName),g=new VRFrameData,b.setVrDisplayAndFrameData(f.vrDisplay,g),c()):f.vrDisplay=null}function e(){try{navigator.getVRDisplays().then(d)}catch(h){}}var f=this,g;this.enableVr=function(a){void 0===navigator.getVRDisplays?WALK.USER_MSG.info('You need a <a href="https://mozvr.com/#start" target="_blank">VR ready browser</a>.'):this.vrDisplay?this.vrDisplay.requestPresent([{source:a}]).then(function(){f.resetPose()},
function(){WALK.USER_MSG.info("Failed to enable VR mode")}):WALK.USER_MSG.info("VR device not connected")};this.disableVr=function(){this.vrDisplay.exitPresent().then(function(){WALK.USER_MSG.hideInfo()},function(){WALK.USER_MSG.info("Failed to exit VR mode")})};this.vrEnabled=function(){return this.vrDisplay&&this.vrDisplay.isPresenting};this.resetPose=function(){};this.update=function(){return function(){var b;this.vrDisplay.getFrameData(g);b=g.pose;if(b.position)a.onHmdUpdate(b.orientation,b.position);
else a.onHmdUpdate(b.orientation,null)}}();void 0!==navigator.getVRDisplays&&(e(),window.addEventListener("vrdisplayconnect",e,!1))}})();(function(){WALK.VREffect=function(a,b){var c,d,e,f,g,h,k;this.preLeftRender=function(a){};this.preRightRender=function(a){};this._updateRenderTargetSize=function(){var a,b;a=e.getEyeParameters("left");b=e.getEyeParameters("right");a&&b&&(c=2*Math.max(a.renderWidth,b.renderWidth),d=Math.max(a.renderHeight,b.renderHeight))};this.renderTargetWidth=function(){c||this._updateRenderTargetSize();return c};this.renderTargetHeight=function(){d||this._updateRenderTargetSize();return d};this.setVrDisplayAndFrameData=
function(c,d){e=c;h=d;f||(f=new THREE.PerspectiveCamera,g=new THREE.PerspectiveCamera,k=new WALK.AutoClearAlter(a));e.depthNear=WALK.CAMERA_NEAR;e.depthFar=b;this._updateRenderTargetSize()};this.render=function(b,c){var d=this.renderTargetWidth()/2,e=this.renderTargetHeight();k.set(!1,!0,!1);f.projectionMatrix.elements=h.leftProjectionMatrix;g.projectionMatrix.elements=h.rightProjectionMatrix;c.matrixWorld.decompose(f.position,f.quaternion,f.scale);g.position.copy(f.position);g.quaternion.copy(f.quaternion);
g.scale.copy(f.scale);this.preLeftRender(f);a.enableScissorTest(!0);a.setViewport(0,0,d,e);a.setScissor(0,0,d,e);a.render(b,f);a.enableScissorTest(!1);this.preRightRender(g);a.enableScissorTest(!0);a.setViewport(d,0,d,e);a.setScissor(d,0,d,e);a.render(b,g);a.enableScissorTest(!1);k.restore()}}})();(function(){WALK.RaycasterConfig=function(a,b,c){this.ray=new THREE.Ray(a,b);this.far=c||Infinity;this.disableBoundsTests=this.onlyGroundCollisions=this.respectColliderSettings=!1};WALK.RayIntersection=function(){this.distance=Infinity;this.point=new THREE.Vector3;this.object=null};WALK.GpuRaycaster=function(a){function b(a,b){var c,d;if((c=a.node)&&(c.disableCollisions&&b.respectColliderSettings||!c.ground&&b.onlyGroundCollisions))return!1;if(b.disableBoundsTests)return!0;c=b.ray;d=a.geometry.boundingSphere;
if(d.distanceToPoint(c.origin)>b.far||!1===c.isIntersectionSphere(d))return!1;d=a.geometry.boundingBox;return d.distanceToPoint(c.origin)>b.far||!c.isIntersectionBox(d)?!1:!0}var c,d,e,f,g,h;c=a.context;d=new THREE.WebGLRenderTarget(1,1,{format:THREE.RGBAFormat,magFilter:THREE.NearestFilter,minFilter:THREE.NearestFilter,stencilBuffer:!1,depthBuffer:!0});d.generateMipmaps=!1;e=new Uint8Array(4);f=new WALK.AutoClearAlter(a);g=new WALK.ObjectDistanceMaterial(!1);h=new THREE.PerspectiveCamera(1,1,WALK.CAMERA_NEAR,
WALK.CAMERA_FAR);this.closestIntersection=function(k,m,l){var n,p,q,u=[];for(n=0;n<k.length;n+=1)p=k[n],console.assert(null===p.visibilityId),b(p,m)&&(q=u.length,u.push(p),p.visibilityId=q+1);if(0===u.length)return!1;h.position.set(0,0,0);h.lookAt(m.ray.direction);h.position.copy(m.ray.origin);f.set(!0,!0,!1);a.renderMeshesWithMaterial(u,g,h,d);f.restore();c.readPixels(0,0,1,1,c.RGBA,c.UNSIGNED_BYTE,e);k=256*e[0]+e[1];p=e[2]+e[3]/255;for(n=0;n<u.length;n+=1)u[n].visibilityId=null;if(0===k||p>m.far)return!1;
console.assert(k-1<u.length);l.object=u[k-1];l.distance=p;l.point.copy(m.ray.direction).multiplyScalar(p).add(m.ray.origin);return!0}}})();(function(){WALK.Collider=function(a,b,c){function d(a){a=f(a);return null!==a?a.distance:Infinity}var e=new THREE.Octree({scene:null,undeferred:!1,depthMax:Infinity,objectsThreshold:8,overlapPct:.15}),f,g=c.cameraWorldPosition();this.getMinDistanceToObstacles=function(){return.1};this.addObstacles=function(a){var b;for(b=0;b<a.length;b+=1)e.add(a[b]);e.update()};(function(){return function(a){var c=new THREE.Mesh(void 0,void 0);c.position.copy(a);b.threeScene.add(c);c.updateMatrixWorld()}})();f=
function(){var b=new WALK.RayIntersection,c=new WALK.GpuRaycaster(a);return function(a){var d=e.search(a.ray.origin,a.far,a.ray.direction);return c.closestIntersection(d,a,b)?b:null}}();this.distanceToGround=function(){var a=new WALK.RaycasterConfig(g);a.ray.direction.set(0,0,-1);a.respectColliderSettings=!0;a.onlyGroundCollisions=!0;return function(b){a.far=b;return d(a)}}();this.objectBelowCamera=function(){var a=new WALK.RaycasterConfig(g);a.ray.direction.set(0,0,-1);a.respectColliderSettings=
!0;return function(b){a.far=b;b=f(a);return null!==b?b.object:null}}();this.distanceToCeiling=function(){var a=new WALK.RaycasterConfig(g);a.ray.direction.set(0,0,1);a.respectColliderSettings=!0;return function(b){a.far=b;return d(a)}}();this.findIntersectionAtPosition=function(){var a=new WALK.RaycasterConfig(g),b=a.ray.direction;return function(d,e){b.set(d,e,1).unproject(c.camera());b.sub(g).normalize();return f(a)}}();this.findObstacleMeshAtPosition=function(a,b){var c=this.findIntersectionAtPosition(a,
b);return null!==c?c.object:null};this.findMeshFromListAtPosition=function(){var b=new WALK.RaycasterConfig(g),d=new WALK.RayIntersection,e=new WALK.GpuRaycaster(a),f=b.ray.direction;b.disableBoundsTests=!0;return function(a,h,k){f.set(h,k,1).unproject(c.camera());f.sub(g).normalize();return e.closestIntersection(a,b,d)?d.object:null}}();this.clickedPointToMoveTarget=function(){var a=new WALK.RaycasterConfig(g),b=a.ray.direction;return function(c){var d;c.z=g.z;d=g.distanceTo(c);if(d<WALK.CLICK_MOVE_MIN_DISTANCE_TO_OBSTACLE)c.x=
g.x,c.y=g.y;else if(a.far=d+WALK.CLICK_MOVE_MIN_DISTANCE_TO_OBSTACLE,b.set(c.x,c.y,c.z),b.sub(g).normalize(),d=f(a))b.multiplyScalar(d.distance-WALK.CLICK_MOVE_MIN_DISTANCE_TO_OBSTACLE),c.x=g.x+b.x,c.y=g.y+b.y}}();this.handleCollisions=function(){function a(a){var h;c.applyCameraYaw(e);e.normalize();var k;h=f.start.distanceTo(g);k=f.end.distanceTo(g);if(p-.02<h+k&&h+k<p+.02&&k>=a&&n.equals(e))return!1;h=d(b);Infinity===h&&(h=b.far);n.copy(e);f.start.copy(g);f.end.copy(e).multiplyScalar(h).add(g);
p=f.distance();return h<a}var b=new WALK.RaycasterConfig(g),e=b.ray.direction,f=new THREE.Line3,n=new THREE.Vector3,p=0;b.respectColliderSettings=!0;b.far=5;console.assert(b.far>c.maxPerFrameDistance);return function(b){b=c.maxFrameMoveDistance(b)+.1;c.movesForward()&&(e.set(0,1,0),a(b)&&c.stopForward());c.movesBackward()&&(e.set(0,-1,0),a(b)&&c.stopBackward());c.movesLeft()&&(e.set(-1,0,0),a(b)&&c.stopLeft());c.movesRight()&&(e.set(1,0,0),a(b)&&c.stopRight());c.movesDown()&&(e.set(0,0,-1),a(b)&&
c.stopDown());c.movesUp()&&(e.set(0,0,1),a(b)&&c.stopUp())}}()}})();(function(){WALK.OrbitControls=function(a,b,c,d){function e(){var a=b.getYawAngle(),c=b.getPitchAngle(),e=b.cameraWorldPosition();w.copy(e).sub(l.target);l.autoRotate&&H===F.NONE&&l.rotateLeft(2*Math.PI/60/60*l.autoRotateSpeed);var a=a+G,c=c+L,a=THREE.Math.clamp(a,l.minYawAngle,l.maxYawAngle),c=THREE.Math.clamp(c,l.minPitchAngle,l.maxPitchAngle),f=w.length()*M,f=THREE.Math.clamp(f,l.minDistance,l.maxDistance);l.target.add(N);WALK.OrbitControls.computeCameraPosition(e,l.target,a,c,f);b.cameraPositionUpdated();
b.setYawAngle(a);b.setPitchAngle(c);L=G=0;M=1;N.set(0,0,0);d.requestFrame()}function f(a){if(!1!==n){a.preventDefault();var b=c===document?c.body:c;if(H===F.ROTATE){if(!0===l.noRotate)return;q.set(a.clientX,a.clientY);u.subVectors(q,p);l.rotateLeft(u.x/b.clientWidth*l.mouseRotateSpeed);!1===l.noPitchRotate&&l.rotateUp(u.y/b.clientHeight*l.mouseRotateSpeed);p.copy(q)}else if(H===F.DOLLY){if(!0===l.noZoom)return;C.set(a.clientX,a.clientY);y.subVectors(C,E);0<y.y?l.dollyIn():0>y.y&&l.dollyOut();E.copy(C)}else if(H===
F.PAN){if(!0===l.noPan)return;t.set(a.clientX,a.clientY);v.subVectors(t,r);l.pan(v.x/b.clientHeight,v.y/b.clientWidth);r.copy(t)}H!==F.NONE&&e()}}function g(){!1!==n&&(document.removeEventListener("mousemove",f,!1),document.removeEventListener("mouseup",g,!1),H=F.NONE)}function h(a){if(!1!==n&&!0!==l.noZoom&&H===F.NONE){a.preventDefault();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);0<b?l.dollyOut():0>b&&l.dollyIn();e()}}function k(a,b,c){return!0===c?b:a===b?0:a}
function m(a,b){var c=!1,e=a.keyCode;if(!1!==n){if(!0===D&&!1===l.noPan)if(38===e||87===e)P=k(P,1,b),c=!0;else if(40===e||83===e)P=k(P,-1,b),c=!0;else if(37===e||65===e)O=k(O,1,b),c=!0;else{if(39===e||68===e)O=k(O,-1,b),c=!0}else if(!1===D&&!1===l.noRotate)if((38===e||87===e)&&!1===l.noPitchRotate)B=k(B,1,b),c=!0;else if((40===e||83===e)&&!1===l.noPitchRotate)B=k(B,-1,b),c=!0;else if(37===e||65===e)z=k(z,1,b),c=!0;else if(39===e||68===e)z=k(z,-1,b),c=!0;switch(e){case l.dollyKeys.IN1:case l.dollyKeys.IN2:case l.dollyKeys.IN3:!1===
l.noZoom&&(J=k(J,1,b),c=!0);break;case l.dollyKeys.OUT1:case l.dollyKeys.OUT2:case l.dollyKeys.OUT3:!1===l.noZoom&&(J=k(J,-1,b),c=!0)}c&&(a.preventDefault(),d.requestFrame())}}this.target=new THREE.Vector3;this.noZoom=!1;this.mouseZoomSpeed=.98;this.keyZoomSpeed=.7;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.noPitchRotate=this.noRotate=!1;this.mouseRotateSpeed=2*Math.PI;this.keyYawRotateSpeed=Math.PI/4;this.keyPitchRotateSpeed=this.keyYawRotateSpeed/2;this.autoRotate=
!1;this.autoRotateSpeed=2;this.minPitchAngle=-Math.PI;this.maxPitchAngle=Math.PI;this.minYawAngle=-Infinity;this.maxYawAngle=Infinity;this.noPan=!1;this.keyPanSpeed=.25;this.dollyKeys={IN1:61,IN2:187,IN3:69,OUT1:173,OUT2:189,OUT3:81};this.primaryMouseButton=THREE.MOUSE.LEFT;this.secondaryMouseButton=THREE.MOUSE.RIGHT;this.mouseButtons={ROTATE:this.primaryMouseButton,ZOOM:THREE.MOUSE.MIDDLE,PAN:this.secondaryMouseButton};var l=this,n=!1,p=new THREE.Vector2,q=new THREE.Vector2,u=new THREE.Vector2,r=
new THREE.Vector2,t=new THREE.Vector2,v=new THREE.Vector2,x=new THREE.Vector3,w=new THREE.Vector3,E=new THREE.Vector2,C=new THREE.Vector2,y=new THREE.Vector2,G=0,L=0,M=1,N=new THREE.Vector3,D=!1,J=0,z=0,B=0,O=0,P=0,F={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},H=F.NONE;this.enable=function(){n=!0;e()};this.disable=function(){n=!1;O=P=z=B=J=0};this.isEnabled=function(){return n};this.setPanPrimary=function(a){D=a;!0===D?(this.mouseButtons.PAN=this.primaryMouseButton,this.mouseButtons.ROTATE=
this.secondaryMouseButton):(this.mouseButtons.ROTATE=this.primaryMouseButton,this.mouseButtons.PAN=this.secondaryMouseButton)};this.getCameraDistance=function(){var a=new THREE.Vector3;return function(){a.copy(b.cameraWorldPosition()).sub(this.target);return a.length()}}();this.rotateLeft=function(a){void 0===a&&(a=2*Math.PI/60/60*l.autoRotateSpeed);G-=a};this.rotateUp=function(a){void 0===a&&(a=2*Math.PI/60/60*l.autoRotateSpeed);L-=a};this.panLeft=function(b){var c=a.matrixWorld.elements;x.set(c[0],
c[1],c[2]);x.multiplyScalar(-b);N.add(x)};this.panUp=function(b){var c=a.matrixWorld.elements;x.set(c[4],c[5],c[6]);x.multiplyScalar(b);N.add(x)};this.pan=function(c,d){if(a instanceof THREE.PerspectiveCamera){var e=b.cameraWorldPosition().clone().sub(l.target).length(),e=e*Math.tan(a.fov/2*Math.PI/180);l.panLeft(2*c*e);l.panUp(2*d*e)}else a instanceof THREE.OrthographicCamera&&(l.panLeft(c*(a.right-a.left)),l.panUp(d*(a.top-a.bottom)))};this.dollyIn=function(b){void 0===b&&(b=this.mouseZoomSpeed);
a instanceof THREE.PerspectiveCamera?M/=b:a instanceof THREE.OrthographicCamera&&(a.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,a.zoom*b)),a.updateProjectionMatrix())};this.dollyOut=function(b){void 0===b&&(b=this.mouseZoomSpeed);a instanceof THREE.PerspectiveCamera?M*=b:a instanceof THREE.OrthographicCamera&&(a.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,a.zoom/b)),a.updateProjectionMatrix())};this.update=function(a){if(n&&a){var b=!1;0!==z&&(l.rotateLeft(z*l.keyYawRotateSpeed*a),b=!0);
0!==B&&(l.rotateUp(B*l.keyPitchRotateSpeed*a),b=!0);if(0!==O||0!==P)l.pan(O*l.keyPanSpeed*a,P*l.keyPanSpeed*a),b=!0;0!==J&&(a=Math.pow(l.keyZoomSpeed,a),-1===J?l.dollyIn(a):l.dollyOut(a),b=!0);b&&e()}};c.addEventListener("mousedown",function(a){if(!1!==n){c.focus();a.preventDefault();if(a.button===l.mouseButtons.ROTATE){if(!0===l.noRotate)return;H=F.ROTATE;p.set(a.clientX,a.clientY)}else if(a.button===l.mouseButtons.ZOOM){if(!0===l.noZoom)return;H=F.DOLLY;E.set(a.clientX,a.clientY)}else if(a.button===
l.mouseButtons.PAN){if(!0===l.noPan)return;H=F.PAN;r.set(a.clientX,a.clientY)}H!==F.NONE&&(document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",g,!1))}},!1);c.addEventListener("mousewheel",h,!1);c.addEventListener("DOMMouseScroll",h,!1);c.addEventListener("touchstart",function(a){var b=a.touches.length;!1!==n&&(a.preventDefault(),!l.noPan&&(D&&1===b||!D&&3===b)?(H=F.TOUCH_PAN,r.set(a.touches[0].clientX,a.touches[0].clientY)):l.noRotate||D||1!==b?l.noZoom||2!==b?H=F.NONE:
(H=F.TOUCH_DOLLY,b=a.touches[0].clientX-a.touches[1].clientX,a=a.touches[0].clientY-a.touches[1].clientY,a=Math.sqrt(b*b+a*a),E.set(0,a)):(H=F.TOUCH_ROTATE,p.set(a.touches[0].clientX,a.touches[0].clientY)))},!1);c.addEventListener("touchend",function(){!1!==n&&(H=F.NONE)},!1);c.addEventListener("touchmove",function(a){var b=a.touches.length,d;!1!==n&&(a.preventDefault(),d=c===document?c.body:c,!l.noPan&&(D&&1===b||!D&&3===b)&&H===F.TOUCH_PAN?(t.set(a.touches[0].clientX,a.touches[0].clientY),v.subVectors(t,
r),l.pan(v.x/d.clientHeight,v.y/d.clientWidth),r.copy(t),e()):l.noRotate||D||1!==b||H!==F.TOUCH_ROTATE?l.noZoom||2!==b||H!==F.TOUCH_DOLLY?H=F.NONE:(b=a.touches[0].clientX-a.touches[1].clientX,a=a.touches[0].clientY-a.touches[1].clientY,a=Math.sqrt(b*b+a*a),C.set(0,a),y.subVectors(C,E),0<y.y?l.dollyOut():0>y.y&&l.dollyIn(),E.copy(C),e()):(q.set(a.touches[0].clientX,a.touches[0].clientY),u.subVectors(q,p),l.rotateLeft(u.x/d.clientWidth*l.mouseRotateSpeed),l.rotateUp(u.y/d.clientHeight*l.mouseRotateSpeed),
p.copy(q),e()))},!1);c.addEventListener("blur",function(a){O=P=z=B=J=0},!1);window.addEventListener("keydown",function(a){WALK.isModifierPressed(a)||m(a,!0)},!1);window.addEventListener("keyup",function(a){m(a,!1)},!1);a instanceof THREE.PerspectiveCamera||a instanceof THREE.OrthographicCamera||console.warn("WARNING: OrbitControls.js requires perspective or orthographic camers")};WALK.OrbitControls.prototype.constructor=WALK.OrbitControls;WALK.OrbitControls.computeCameraPosition=function(){var a=
new THREE.Vector3;return function(b,c,d,e,f){d-=Math.PI/2;e+=Math.PI/2;a.x=f*Math.sin(e)*Math.cos(d);a.y=f*Math.sin(e)*Math.sin(d);a.z=f*Math.cos(e);b.copy(c).add(a)}}()})();(function(){WALK.Controls=function(a,b,c){function d(){D.rotation.z=WALK.normalizeRotation(B.z+z.z)}function e(){d();N.rotation.x=WALK.normalizeRotation(B.x+z.x);M.rotation.y=B.y;D.updateMatrixWorld(!0)}function f(a){C=w;y=E;a.touches?(w=a.touches[0].clientX,E=a.touches[0].clientY):(w=a.clientX,E=a.clientY)}function g(a){if(p&&(a.preventDefault(),f(a),a.touches||!n.mousePressLook||L)){var b=a.movementX||a.mozMovementX||a.webkitMovementX;void 0===b&&(b=w-C);a=a.movementY||a.mozMovementY||a.webkitMovementY;
void 0===a&&(a=E-y);var d=n.reverseLook?1:-1;z.z+=d*b*n.fpsLookSpeed;n.mouseControlsPitch&&(z.x+=d*a*n.fpsLookSpeed);n.restrictVerticalAngle&&(b=z,b.x>n.verticalAngleMax?b.x=n.verticalAngleMax:b.x<n.verticalAngleMin&&(b.x=n.verticalAngleMin));e();c.requestFrame()}}function h(a){p&&(b.focus(),a.preventDefault(),f(a),L=!0,c.requestFrame())}function k(a){p&&(a.preventDefault(),L=!1)}function m(a){var d=0,e;(e=!p)||(e=void 0!==document.hasFocus?document.hasFocus():document.activeElement===b,e=!e);e||
(a||(a=window.event),a.preventDefault(),a.wheelDelta?d=a.wheelDelta/120:a.detail&&(d=-a.detail/3),G+=d*n.scrollSpeed,G=0<=G?Math.min(G,n.maxScrollDelta):Math.max(G,-n.maxScrollDelta),c.requestFrame())}function l(){n.stopForward();n.stopBackward();n.stopLeft();n.stopRight();n.stopUp();n.stopDown();x=v=!1}var n=this,p=!0,q=function(){this.speed=this.activeDirection=0;this.moves=function(){return this.activeDirection||this.speed};this.movesInDirection=function(a){return this.activeDirection===a||Math.sign(this.speed)===
a};this.activateDirection=function(a){this.activeDirection=a};this.deactivateDirection=function(a){this.activeDirection===a&&(this.activeDirection=0)};this.stopInDirection=function(a){this.deactivateDirection(a);Math.sign(this.speed)===a&&(this.speed=0)};this.update=function(b){var c,d,e;if(!this.moves())return 0;c=Math.sign(this.speed);d=this.activeDirection||-c;e=a.moveMaxSpeed;d=b*d*(c===d?e/WALK.CAMERA_FULL_ACCELERATION_TIME:e/WALK.CAMERA_FULL_DECELERATION_TIME);b*=this.speed+d/2;this.speed=THREE.Math.clamp(this.speed+
d,-e,e);this.activeDirection||Math.sign(this.speed)===c||(this.speed=0);return THREE.Math.clamp(b,-n.maxPerFrameDistance,n.maxPerFrameDistance)}},u=new q,r=new q,t=new q,v=!1,x=!1,w=0,E=0,C=0,y=0,G=0,L=!1,M=new THREE.Object3D,N=new THREE.Object3D,D=new THREE.Object3D,J=!1,z=new THREE.Vector3(0,0,0),B=new THREE.Euler(0,0,0);M.add(a);N.add(M);D.add(N);this.reverseLook=this.mousePressLook=!1;this.mouseControlsPitch=!0;this.scrollSpeed=.2;this.maxScrollDelta=.5;this.maxPerFrameDistance=1;this.fpsLookSpeed=
Math.PI/1500;this.restrictVerticalAngle=!0;this.verticalAngleMin=-Math.PI/2;this.verticalAngleMax=Math.PI/3;this.arrowsTurn=!0;this.arrowsTurnSpeed=Math.PI/4;this.orbit=new WALK.OrbitControls(a,this,b,c);this.orbit.keyYawRotateSpeed=this.arrowsTurnSpeed;this.orbit.keyPitchRotateSpeed=this.arrowsTurnSpeed/2;this.isFpsEnabled=function(){return p};this.isOrbitEnabled=function(){return this.orbit.isEnabled()};this.orbitModeEnable=function(){p=!1;this.orbit.enable()};this.camera=function(){return a};this.applyCameraYaw=
function(a){a.applyEuler(D.rotation)};this.cameraWorldPosition=function(){return D.position};this.cameraPositionUpdated=function(){D.updateMatrixWorld(!0)};this.resetRollAngle=function(){0!==M.rotation.y&&(B.y=0,e())};this.getPitchAngle=function(){return N.rotation.x};this.setPitchAngle=function(a){a!==N.rotation.x&&(z.x=a,B.x=0,e())};this.resetPitchAngle=function(){this.setPitchAngle(0)};this.getYawAngle=function(){return D.rotation.z};this.setYawAngle=function(a){a!==D.rotation.z&&(z.z=a,B.z=0,
e())};this.resetYawAngle=function(){this.setYawAngle(0)};this.onHmdResetPose=function(){J=!0};this.onHmdUpdate=function(){var a=new THREE.Quaternion,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector3(0,0,0),f=new THREE.Vector3;return function(g,h){if(p){a.fromArray(g);B.setFromQuaternion(a,"YXZ");var k=B.y;B.y=-B.z;B.z=k;e();h&&(b.set(Math.cos(z.z),Math.sin(z.z),0),c.set(-Math.sin(z.z),Math.cos(z.z),0),f.copy(b.multiplyScalar(h[0])),f.add(c.multiplyScalar(-h[2])),f.z=h[1],J?J=!1:(D.position.sub(d),
D.position.add(f)),d.copy(f))}}}();this.maxFrameMoveDistance=function(b){return Math.min(b*a.moveMaxSpeed,this.maxPerFrameDistance)};this.movesForward=function(){return r.movesInDirection(1)||0<G};this.stopForward=function(){0<G&&(G=0);r.stopInDirection(1)};this.movesBackward=function(){return r.movesInDirection(-1)||0>G};this.stopBackward=function(){0>G&&(G=0);r.stopInDirection(-1)};this.movesLeft=function(){return u.movesInDirection(-1)};this.stopLeft=function(){u.stopInDirection(-1)};this.movesRight=
function(){return u.movesInDirection(1)};this.stopRight=function(){u.stopInDirection(1)};this.movesUp=function(){return t.movesInDirection(1)};this.stopUp=function(){t.stopInDirection(1)};this.movesDown=function(){return t.movesInDirection(-1)};this.stopDown=function(){t.stopInDirection(-1)};this.enable=function(){this.orbit.disable();p=!0;L=0};this.disable=function(){this.orbit.disable();p=!1;l()};this.update=function(a){var b,e,f;if(p){b=u.update(a);e=r.update(a);f=t.update(a);var g=0;e?G=0:(G&&
(e=n.maxFrameMoveDistance(a),g=THREE.Math.clamp(G,-e,e),G-=g),e=1*g);D.translateX(b);D.translateY(e);D.translateZ(f);if(v||x)b=v?1:-1,z.z+=b*this.arrowsTurnSpeed*a,d();(u.moves()||r.moves()||t.moves()||v||x||G)&&c.requestFrame();D.updateMatrixWorld(!0)}else this.orbit.update(a)};a.rotation.set(0,0,0);a.up.set(0,0,1);a.lookAt(new THREE.Vector3(0,1,0));b.setAttribute("tabindex",-1);b.addEventListener("contextmenu",function(a){a.preventDefault()},!1);b.addEventListener("mousedown",h,!1);b.addEventListener("touchstart",
function(a){p&&(a.preventDefault(),f(a))},!1);b.addEventListener("mousemove",g,!1);b.addEventListener("touchmove",g,!1);b.addEventListener("mouseup",k,!1);b.addEventListener("keydown",function(a){var b=!0;if(p&&!WALK.isModifierPressed(a)){switch(a.keyCode){case 38:case 32:case 87:r.activateDirection(1);break;case 37:n.arrowsTurn?v=!0:u.activateDirection(-1);break;case 65:u.activateDirection(-1);break;case 40:case 83:r.activateDirection(-1);break;case 39:n.arrowsTurn?x=!0:u.activateDirection(1);break;
case 68:u.activateDirection(1);break;case 33:case 81:t.activateDirection(1);break;case 34:case 69:t.activateDirection(-1);break;default:b=!1}b&&(a.preventDefault(),c.requestFrame())}},!1);b.addEventListener("keyup",function(a){var b=!0;if(p){switch(a.keyCode){case 38:case 32:case 87:r.deactivateDirection(1);break;case 37:case 65:v=!1;u.deactivateDirection(-1);break;case 40:case 83:r.deactivateDirection(-1);break;case 39:case 68:x=!1;u.deactivateDirection(1);break;case 33:case 81:t.deactivateDirection(1);
break;case 34:case 69:t.deactivateDirection(-1);break;default:b=!1}b&&a.preventDefault()}},!1);b.addEventListener("mouseout",function(a){k(a)},!1);b.addEventListener("mouseenter",function(a){0<a.buttons&&h(a)},!1);b.addEventListener("DOMMouseScroll",m,!1);b.addEventListener("mousewheel",m,!1);b.addEventListener("blur",function(a){l()},!1)}})();(function(){WALK.ClickNavigator=function(a,b,c){function d(){c.teleportingToPoint&&c.cancelSwitchToPoint()}this.onMeshClicked=function(d,f){b.isOrbitEnabled()||(a.clickedPointToMoveTarget(f),c.switchToPoint(f))};document.addEventListener("keydown",d,!1);document.addEventListener("mousedown",d,!1);document.addEventListener("mousemove",function(){!b.mousePressLook&&c.teleportingToPoint&&c.cancelSwitchToPoint()},!1);document.addEventListener("touchstart",d,!1);document.addEventListener("DOMMouseScroll",
d,!1);document.addEventListener("mousewheel",d,!1)}})();(function(){WALK.StepsClimber=function(a,b,c){var d,e,f,g,h,k;e=a.getMinDistanceToObstacles();g=b.cameraWorldPosition();h=new THREE.Vector3;this.speed=1.5;this.updateCameraHeight=function(b){var l;d&&(l=g.z-h.z,null!==f&&(f+=l),g.x!==h.x||g.y!==h.y?k=a.distanceToGround(5.5):Infinity!==k&&(k+=l),Infinity!==k&&(null===f&&(f=k),k<f-.005||k>f+.005)&&(b=Math.min(this.speed*b,Math.abs(k-f)),k>f&&(b=-b),0>b||Infinity===a.distanceToCeiling(b+e))&&(g.z+=b,k+=b,c.requestFrame()),h.copy(g))};this.enable=function(){d=
!0;f=null;k=Infinity;h.copy(g)};this.disable=function(){d=!1};this.enable()}})();(function(){var a,b;a=function(a){var b=null;this.activateSky=function(c){var d=a.findSkyMesh(c);if(b){if(b.name===c)return;a.threeScene.remove(b)}(c=d.material.map)&&!c.loaded?(this.activateSky(WALK.DEFAULT_SKY_NAME),b=d,c.addLoadedListener(function(){b===d&&(a.threeScene.add(d),d.updateMatrixWorld(!0))})):(a.threeScene.add(d),d.updateMatrixWorld(!0),b=d)};this.activeSkyName=function(){return b.name}};b=function(a,b){this.position=a||new THREE.Vector3;this.rotation=b||new THREE.Vector2};b.prototype=
{length:function(){return Math.sqrt(this.position.lengthSq()+this.rotation.lengthSq())},multiplyScalar:function(a){this.position.multiplyScalar(a);this.rotation.multiplyScalar(a);return this},zero:function(){this.position.set(0,0,0);this.rotation.set(0,0);return this},divideScalar:function(a){this.position.divideScalar(a);this.rotation.divideScalar(a);return this},normalize:function(){return this.divideScalar(this.length())},normalizeRotation:function(){this.rotation.x=WALK.normalizeRotation(this.rotation.x);
this.rotation.y=WALK.normalizeRotation(this.rotation.y);return this},distanceTo:function(a){var b,c,f,g;b=this.position.x-a.position.x;c=this.position.y-a.position.y;f=this.position.z-a.position.z;g=WALK.normalizeRotation(this.rotation.x-a.rotation.x);a=WALK.normalizeRotation(this.rotation.y-a.rotation.y);return Math.sqrt(b*b+c*c+f*f+g*g+a*a)},subVectors:function(a,b){this.position.subVectors(a.position,b.position);this.rotation.subVectors(a.rotation,b.rotation);return this.normalizeRotation()},copy:function(a){this.position.copy(a.position);
this.rotation.copy(a.rotation);return this}};WALK.Teleport=function(c,d,e){function f(){var a,b,d,e;p=[];for(a=0;a<c.views.length;a+=1)p[c.views[a].id]=[];for(a=0;a<c.gpuMeshes.length;a+=1)if(e=c.gpuMeshes[a],d=e.hideInViews)for(b=0;b<d.length;b+=1)p[d[b]]?p[d[b]].push(e):console.warn("Invalid view id in hideInViews list: '"+d[a]+"'")}function g(a){var b;for(b=0;b<a.length;b+=1)a[b].visible=!1}function h(){var a;for(a=0;a<c.gpuMeshes.length;a+=1)c.gpuMeshes[a].visible=!0}function k(){n.copy(q.position);
d.setYawAngle(q.rotation.x);d.setPitchAngle(q.rotation.y);d.cameraPositionUpdated()}var m=this,l=new a(c),n=d.cameraWorldPosition(),p,q=new b,u=new b,r=new THREE.Vector3,t=0,v=0,x=0,w,E,C,y={type:"teleportStarted",view:null},G={type:"teleportDone",view:null},L;this.lastDestinationView=null;this.teleportingToPoint=this.teleportingToView=!1;this.maxTeleportToViewTime=3;this.teleportToViewAcceleration=4;this.teleportToPointSpeed=2*WALK.CAMERA_DEFAULT_MOVE_MAX_SPEED;this.instant=!1;L=function(){var a=
new b(d.cameraWorldPosition());return function(){a.rotation.set(d.getYawAngle(),d.getPitchAngle());a.normalizeRotation();return a}}();this.update=function(){var a=new b;return function(b){var c,f=!0;if(m.teleportingToView||m.teleportingToPoint){b=Math.min(b,.067);c=L().distanceTo(q);this.teleportingToPoint&&(q.position.z=n.z);if(0!==c){var y=0;v*v/(2*x)>=c?(y=v/x,y=2*(v*y-c)/(y*y),y*=-b):v<t&&(y=b*x);a.copy(u);v=THREE.Math.clamp(v+.5*y,0,t);a.multiplyScalar(v*b);v=THREE.Math.clamp(v+.5*y,0,t);n.add(a.position);
d.setYawAngle(d.getYawAngle()+a.rotation.x);d.setPitchAngle(d.getPitchAngle()+a.rotation.y);L().distanceTo(q)>c||0===v?k():f=!1;d.cameraPositionUpdated()}f&&(this.teleportingToView&&(c=C.mode,"orbit"===c?(d.orbit.minDistance=w,d.orbit.maxDistance=E,d.orbit.setPanPrimary(C.panPrimary||!1),d.orbit.noRotate=C.noRotate||!1,d.orbit.noPitchRotate=C.noPitchRotate||!1,d.orbit.target.copy(r),d.orbitModeEnable()):d.enable(),l.activateSky(C.sky),c=p[C.id],h(),g(c)),this.teleportingToView=this.teleportingToPoint=
!1,G.view=C,this.dispatchEvent(G));e.requestFrame()}}}();this.cancelSwitchToPoint=function(){console.assert(this.teleportingToPoint);this.teleportingToPoint=!1;G.view=null;this.dispatchEvent(G)};this.switchToPoint=function(a,b){var c;if(a.x!==n.x||a.y!==n.y)C=null,this.teleportingToPoint=!0,this.teleportingToView=!1,y.view=null,this.dispatchEvent(y),q.position.set(a.x,a.y,n.z),c=Math.atan2(-(a.x-n.x),a.y-n.y),c=WALK.normalizeRotation(c),q.rotation.set(c,0),b?(k(),this.update(0)):(u.subVectors(q,L()).normalize(),
t=m.teleportToPointSpeed,v=0,x=t/WALK.CAMERA_FULL_ACCELERATION_TIME,e.requestFrame())};this.switchToView=function(a,b){var c,f;void 0===b&&(b=this.instant);this.lastDestinationView=C=a;this.teleportingToView=!0;this.teleportingToPoint=!1;y.view=C;this.dispatchEvent(y);d.disable();d.resetRollAngle();g(p[C.id]);void 0!==C.rotation?q.rotation.set(C.rotation.yaw,C.rotation.pitch):q.rotation.set(0,0);"orbit"===C.mode?(void 0!==C.target?r.set(C.target.x,C.target.y,C.target.z):r.set(0,0,0),w=C.minDistance||
0,E=C.maxDistance||100,c=THREE.Math.clamp(C.distance||10,w,E),WALK.OrbitControls.computeCameraPosition(q.position,r,q.rotation.x,q.rotation.y,c)):void 0!==C.position?q.position.set(C.position.x,C.position.y,C.position.z):q.position.set(0,0,0);b?(k(),this.update(0)):(C.sky!==l.activeSkyName()&&l.activateSky(WALK.DEFAULT_SKY_NAME),u.subVectors(q,L()),c=u.length(),f=Math.sqrt(c/m.teleportToViewAcceleration),f>m.maxTeleportToViewTime/2?(f=m.maxTeleportToViewTime/2,x=c/(f*f)):x=m.teleportToViewAcceleration,
t=x*f,u.normalize(),v=0);e.requestFrame()};this.updateHiddenMeshes=function(a){f();a?(a=p[a.id],h(),g(a)):h();e.requestFrame()};this.activateSky=function(a){l.activateSky(a.sky);e.requestFrame()};f();c.addEventListener("viewAdded",f);c.addEventListener("viewRemoved",f);c.addEventListener("skyMeshAdded",function(a){l.activateSky(a.skyMesh.name);e.requestFrame()});c.addEventListener("skyMeshRemoved",function(a){l.activeSkyName()===a.skyMesh.name&&(l.activateSky(WALK.DEFAULT_SKY_NAME),e.requestFrame())})};
THREE.EventDispatcher.prototype.apply(WALK.Teleport.prototype)})();(function(){WALK.AutoTour=function(a,b){function c(){var c;e&&(c=a.visibleViews(),d.viewIdx=(d.viewIdx+1)%c.length,b.switchToView(c[d.viewIdx]))}var d=this,e=!1,f,g={type:"tourStarted"},h={type:"tourStopped"};this.viewIdx=0;f={maxTeleportToViewTime:null,teleportToViewAcceleration:null,save:function(){this.maxTeleportToViewTime=b.maxTeleportToViewTime;this.teleportToViewAcceleration=b.teleportToViewAcceleration},restore:function(){b.maxTeleportToViewTime=this.maxTeleportToViewTime;b.teleportToViewAcceleration=
this.teleportToViewAcceleration}};b.addEventListener("teleportDone",function(){e&&setTimeout(c,WALK.AUTO_TOUR_IN_VIEW_STILL_TIME_MS)});this.isRunning=function(){return e};this.start=function(){console.assert(!e);f.save();b.maxTeleportToViewTime=4;b.teleportToViewAcceleration=4;e=!0;this.dispatchEvent(g);c()};this.stop=function(){var c=a.visibleViews();console.assert(e);f.restore();e=!1;this.viewIdx<c.length&&b.switchToView(c[this.viewIdx],!0);this.dispatchEvent(h)}};THREE.EventDispatcher.prototype.apply(WALK.AutoTour.prototype)})();(function(){WALK.GamepadManager=function(){function a(){function a(a){var b;for(b=0;b<k.length;++b)if(k[b]&&k[b].id===a)return b;return null}function g(){var a;for(a=0;a<k.length;++a)if(k[a])return a;return null}var h,k,m;m=null;k=navigator.getGamepads();for(h=0;h<e.length&&(m=a(e[h]),null===m);++h);null===m&&(m=g());if(null!==m){if(m!==b)for(b=m,m=k[m],WALK.log("Gamepad change. Active gamepad: "+m.id),c=Array(m.buttons.length),d=Array(m.buttons.length),h=0;h<m.buttons.length;++h)c[h]=d[h]=!1}else WALK.log("Gamepad disconnected."),
d=c=b=null}var b=null,c=null,d=null,e=["Oculus Remote"];this.update=function(){if(null!==b){var a,e;a=c;c=d;d=a;a=navigator.getGamepads()[b];for(e=0;e<d.length;++e)d[e]=0<a.buttons[e].value}};this.anyButtonChangedToPressed=function(){var a;if(null!==b)for(a=0;a<d.length;++a)if(d[a]&&!c[a])return!0;return!1};navigator.getGamepads&&(a(),window.addEventListener("gamepadconnected",a),window.addEventListener("gamepaddisconnected",a))}})();(function(){var a=Math.PI/60;WALK.GazeTeleport=function(b,c,d,e){function f(){var a=$("walk-canvas");a.addEventListener("mousedown",function(a){t=!1},!1);a.addEventListener("mouseup",function(a){t=!0},!1)}function g(){q=!1;u=r=null;k=0;m.circleSpan=0;t=!1}function h(a){var b=e.findIntersectionAtPosition(0,0);if(!b)return!1;a.copy(b.point);e.clickedPointToMoveTarget(a);return!0}var k=0,m,l,n=null,p,q,u=null,r=null,t=!1;this.update=function(b){var e,f;if(d.isFpsEnabled())if(l.visible||(g(),l.visible=
!0),n.update(),(t||n.anyButtonChangedToPressed())&&h(p))g(),c.switchToPoint(p,!0);else if(e=d.getPitchAngle(),f=d.getYawAngle(),l.matrixWorld.copy(d.camera().matrixWorld),null===u)u=e,r=f;else if(Math.abs(u-e)>a||Math.abs(r-f)>a)g();else{k+=b;if(2.5<k)if(q)m.circleSpan=Math.min((k-2.5)/2,1);else if(q=h(p),!q){g();return}4.5<k&&(g(),c.switchToPoint(p,!0))}else l.visible=!1};window.addEventListener("vrdisplaypresentchange",function(a){if((a.display||a.detail.display).isPresenting){if(!l){m=new WALK.VRPointerMaterial;
a=THREE.Mesh;var c,d;c=new THREE.BufferGeometry;d=new Float32Array(18);c.addAttribute("position",new THREE.BufferAttribute(d,3));d[0]=1;d[1]=-1;d[2]=-50;d[3]=1;d[4]=1;d[5]=-50;d[6]=-1;d[7]=-1;d[8]=-50;d[9]=1;d[10]=1;d[11]=-50;d[12]=-1;d[13]=1;d[14]=-50;d[15]=-1;d[16]=-1;d[17]=-50;c.computeBoundingSphere();l=new a(c,m);l.frustumCulled=!1;l.visible=!1;l.renderOrder=1;b.threeScene.add(l);n=new WALK.GamepadManager;p=new THREE.Vector3;f()}}else l&&(l.visible=!1)},!1)}})();(function(){WALK.TriggersHandler=function(a,b,c){var d=!0;this.handleTriggers=function(){var e;d&&(e=b.objectBelowCamera(3))&&(e=e.node.triggers)&&0<e.length&&(e=a.findTrigger(e[0]),c.switchToView(a.findView(e.viewId)))};this.enable=function(){d=!0};this.disable=function(){d=!1}}})();(function(){WALK.AutoClearAlter=function(a){var b,c,d,e;this.set=function(f,g,h){console.assert(void 0===b&&void 0===c&&void 0===d&&void 0===e);b=a.autoClear;c=a.autoClearColor;d=a.autoClearDepth;e=a.autoClearStencil;a.autoClear=f||g||h;a.autoClearColor=f;a.autoClearDepth=g;a.autoClearStencil=h};this.restore=function(){console.assert(void 0!==b&&void 0!==c&&void 0!==d&&void 0!==e);a.autoClear=b;a.autoClearColor=c;a.autoClearDepth=d;a.autoClearStencil=e;e=d=c=b=void 0}}})();(function(){WALK.ClearColorAlter=function(a){var b=null;this.set=function(c){console.assert(null===b);b=a.getClearColor();a.setClearColor(c)};this.restore=function(){console.assert(null!==b);a.setClearColor(b);b=null}}})();(function(){function a(a,b,c,d){a[b]={type:c,value:d}}function b(a){return a.disableLightProbe||a.disableLightProbeTmp||a.specularOff||1===a.roughness&&!a.roughnessMap||a.transparent&&a.doubleSided}var c,d,e,f;c=WALK.getShader("walk_material_vertex.glsl");d=WALK.getShader("walk_material_fragment.glsl");e=new THREE.Color;f=new THREE.Vector3(0,0,0);WALK.ParallaxModes={basic:"USE_BASIC_PARALLAX",steep:"USE_STEEP_PARALLAX",occlusion:"USE_OCLUSION_PARALLAX",relief:"USE_RELIEF_PARALLAX"};WALK.Material=
function(){WALK.BaseMaterial.call(this,c,d);this._opacity=1;Object.defineProperty(this,"opacity",{get:function(){return this._opacity},set:function(a){this._opacity=a;this._updateTransparency()}});this.color=new THREE.Color(16777215);this.mapName=this.map=null;this._mapUvOffsetScale=new THREE.Vector4(0,0,1,1);this.mapColorCorrection=this.planarReflector=!1;this.mapContrast=0;this.mapHslOffset={h:0,s:0,l:0};this._diffuseCorrectionUniform=new THREE.Vector4;this.lightMapped=!1;this.lightVisibilityMap=
null;this._lightVisibilityMapSize=new THREE.Vector2;this.lightAttrMap=null;this.lightsCount=0;this.emissive=!1;this.roughness=this.emissionStrength=1;this.metallic=0;this._lastUsedLightProbeId=this.cubeCameraIndex=this.metallicMap=this.roughnessMap=null;this.disableLightProbeTmp=this.disableLightProbe=!1;this.envMapProject=!0;this._hdrOutput=!1;this.bumpMap=null;this.bumpScale=.001;this.parallaxCorrection=!1;this.parallaxMode="basic";this.parallaxScale=-.03;this.parallaxMinLayers=10;this.parallaxMaxLayers=
15;this.colorMap=null;this.cameraExposure=0;this.cameraGamma=1;this.headLight=!1;this.highlight=null;this._highlightMix=0;this._specularOff=!1;this.fragmentShaderExtensions="";this.doNotImport={baseColor:!1,baseColorTexture:!1,opacity:!1}};WALK.Material.prototype=Object.create(WALK.BaseMaterial.prototype);WALK.Material.prototype.constructor=WALK.Material;WALK.Material.prototype._updateTransparency=function(){var a=this.map?this.map.hasAlpha:!1;this.transparent=1>this.opacity||a;this.depthWrite=!this.transparent};
Object.defineProperty(WALK.Material.prototype,"doubleSided",{get:function(){return this.side===THREE.DoubleSide},set:function(a){this.side=a?THREE.DoubleSide:THREE.FrontSide}});Object.defineProperty(WALK.Material.prototype,"envMapMirror",{get:function(){return 0===this.roughness&&!this.roughnessMap}});Object.defineProperty(WALK.Material.prototype,"hdrOutput",{get:function(){return this._hdrOutput},set:function(a){a!==this._hdrOutput&&(this._hdrOutput=a,this.setUniforms())}});Object.defineProperty(WALK.Material.prototype,
"specularOff",{get:function(){return this._specularOff},set:function(a){a!==this._specularOff&&(this._specularOff=a,this.setUniforms())}});Object.defineProperty(WALK.Material.prototype,"highlightMix",{get:function(){return this._highlightMix},set:function(a){a!==this._highlightMix&&(this._highlightMix=a,this.uniforms.highlightMix.value=a)}});WALK.Material.prototype._declareLightProbeUniforms=function(b,c){this.envMapMirror?(a(b,"envMap","t",null),a(b,"envMipsCount","f",1)):(a(b,"envMap","t",null),
a(b,"envMipsCount","f",0));this.envMapProject&&(a(b,"envMapPosW","v3",f),a(b,"envBoxMin","v3",f),a(b,"envBoxMax","v3",f),c.USE_ENVMAP_PROJECT="");this._lastUsedLightProbeId=null;c.USE_ENVMAP="";c.USE_HDR_ENVMAP=""};WALK.Material.prototype.setMapUvOffsetAndScale=function(a,b,c,d){this._mapUvOffsetScale.set(a,b,c,d)};WALK.Material.prototype.setTexture=function(a,b){var c=this;c[a]=b;b.addLoadedListener(function(){c._updateTransparency();c.setUniforms()})};WALK.Material.prototype.removeTexture=function(a){this[a]=
null;this._updateTransparency()};WALK.Material.prototype.resetDiffuseMapProperties=function(){this.mapColorCorrection=!1;this.mapContrast=0;this.mapHslOffset.h=0;this.mapHslOffset.s=0;this.mapHslOffset.l=0};WALK.Material.prototype.resetBumpMapProperties=function(){this.bumpScale=.001};WALK.Material.prototype.setUniforms=function(){var c,d={},f={},m="";a(d,"opacity","f",this.opacity);(c=this.roughnessMap)&&c.loaded?(a(d,"roughnessMap","t",c),f.USE_ROUGHNESSMAP=""):a(d,"roughness","f",this.roughness);
(c=this.metallicMap)&&c.loaded?(a(d,"metallicMap","t",c),f.USE_METALLICMAP=""):a(d,"metallic","f",this.metallic);a(d,"emissionStrength","f",this.emissive?this.emissionStrength:0);this.map&&this.mapColorCorrection?(e.set(this.color),e.offsetHSL(this.mapHslOffset.h,this.mapHslOffset.s,this.mapHslOffset.l),c=Math.max(1+this.mapContrast,0),this._diffuseCorrectionUniform.set(c*(e.r-this.color.r-.5)+.5,c*(e.g-this.color.g-.5)+.5,c*(e.b-this.color.b-.5)+.5,c)):this._diffuseCorrectionUniform.set(0,0,0,1);
a(d,"diffuseCorrection","v4",this._diffuseCorrectionUniform);(c=this.map)&&c.loaded?(a(d,"map","t",c),a(d,"mapUvMod","v4",this._mapUvOffsetScale),f.USE_MAP=""):a(d,"diffuseColor","c",this.color);(c=this.bumpMap)&&c.loaded&&(m+="#extension GL_OES_standard_derivatives : enable\n",a(d,"bumpMap","t",c),a(d,"bumpScale","f",this.bumpScale),f.USE_BUMPMAP="",this.parallaxCorrection&&(f.USE_PARALLAX_CORRECTION="",f[WALK.ParallaxModes[this.parallaxMode]]="",a(d,"parallaxScale","f",this.parallaxScale),a(d,"parallaxMinLayers",
"f",this.parallaxMinLayers),a(d,"parallaxMaxLayers","f",this.parallaxMaxLayers)));this.lightMapped&&(a(d,"lightMap","t",null),f.USE_LIGHTMAP="");this.lightAttrMap&&!this.specularOff&&(console.assert(this.lightVisibilityMap),console.assert(this.lightsCount),console.assert(this.lightVisibilityMap.width),console.assert(this.lightVisibilityMap.height),a(d,"lightVisibilityMap","t",this.lightVisibilityMap),a(d,"lightAttrMap","t",this.lightAttrMap),a(d,"lightsCount","f",this.lightsCount),this._lightVisibilityMapSize.set(this.lightVisibilityMap.width,
this.lightVisibilityMap.height),a(d,"lightVisibilityMapSize","v2",this._lightVisibilityMapSize),f.USE_DYNAMIC_LIGHT="");b(this)||(m+="#extension GL_EXT_shader_texture_lod : require\n",this._declareLightProbeUniforms(d,f));this.highlight&&(f.USE_HIGHLIGTH="",a(d,"highlight","c",this.highlight),a(d,"highlightMix","f",this.highlightMix));this.hdrOutput?f.HDR_OUTPUT="":this.colorMap&&(f.USE_COLORMAP="",a(d,"colorMap","t",this.colorMap));a(d,"exposure","f",Math.pow(2,this.cameraExposure));a(d,"cameraGamma",
"f",this.cameraGamma);!this.headLight&&this.lightMapped||this.specularOff||(f.USE_HEADLIGHT="");this.uniforms=d;this.defines=f;this.fragmentShaderExtensions=m;this.programNeedsUpdate=!0};WALK.Material.prototype.forceObjectUniformsRefresh=function(){this._lastUsedLightProbeId=null};WALK.Material.prototype.refreshPerObjectUniforms=function(a,c){var d,e,g=!1;b(this)||(d=a.lightProbe,this._lastUsedLightProbeId!==d.id&&(g=!0,this._lastUsedLightProbeId=d.id,e=this.envMapMirror?d.getMirrorTexture():d.getFilteredTexture(),
c.envMap.value=e,this.envMapMirror||(c.envMipsCount.value=d.filteredMipsCount),this.envMapProject&&(d.hasBoundingBox()?(c.envMapPosW.value=d.position,c.envBoxMin.value=d.boxMin,c.envBoxMax.value=d.boxMax):(c.envBoxMin.value=f,c.envBoxMax.value=f))));d=a.lightMap;this.lightMapped&&c.lightMap.value!==d&&(g=!0,c.lightMap.value=d);return g}})();(function(){WALK.DebugMaterial=function(){WALK.Material.call(this);this.noSharedBuffers=new THREE.Color(16777215);this.sharedBuffersMaster=new THREE.Color(255);this.sharedBuffersCopy=new THREE.Color(65280);this.addUniform("diffuseColor","c",this.noSharedBuffers);this.headLight=!0;this.setUniforms();this.defaultAttributeValues.sphericalNormal=[0,0]};WALK.DebugMaterial.prototype=Object.create(WALK.Material.prototype);WALK.DebugMaterial.prototype.refreshPerObjectUniforms=function(a,b){b.diffuseColor.value=
0===a.sharedBuffersDebug?this.noSharedBuffers:1===a.sharedBuffersDebug?this.sharedBuffersMaster:this.sharedBuffersCopy;return!0}})();(function(){var a,b;a=WALK.getShader("equirect_sky_vertex.glsl");b=WALK.getShader("equirect_sky_fragment.glsl");WALK.EquirectSkyMaterial=function(){WALK.BaseMaterial.call(this,a,b);this.depthWrite=!1;this.side=THREE.FrontSide;this.uniforms={map:{type:"t",value:null},colorMap:{type:"t",value:null}};this.defines={}};WALK.EquirectSkyMaterial.prototype=Object.create(WALK.BaseMaterial.prototype);WALK.EquirectSkyMaterial.prototype.constructor=WALK.EquirectSkyMaterial;Object.defineProperty(WALK.EquirectSkyMaterial.prototype,
"map",{get:function(){return this.uniforms.map.value},set:function(a){this.uniforms.map.value=a}});Object.defineProperty(WALK.EquirectSkyMaterial.prototype,"hdrOutput",{get:function(){return this.defines.hasOwnProperty("HDR_OUTPUT")},set:function(a){a?this.defines.HDR_OUTPUT="":delete this.defines.HDR_OUTPUT;this.programNeedsUpdate=!0}});Object.defineProperty(WALK.EquirectSkyMaterial.prototype,"colorMap",{get:function(){return this.uniforms.colorMap.value},set:function(a){(this.uniforms.colorMap.value=
a)?this.defines.USE_COLORMAP="":delete this.defines.USE_COLORMAP;this.programNeedsUpdate=!0}})})();(function(){WALK.ProceduralSkyMaterial=function(){WALK.BaseMaterial.call(this,WALK.getShader("procedural_sky_vertex.glsl"),WALK.getShader("procedural_sky_fragment.glsl"));this.depthWrite=!1;this.side=THREE.BackSide;this.uniforms={topColor:{type:"c",value:new THREE.Color(15135487)},bottomColor:{type:"c",value:new THREE.Color(16777215)},sinBottomAngle:{type:"f",value:Math.sin(THREE.Math.degToRad(-30))},exponent:{type:"f",value:.9},colorMap:{type:"t",value:null}};this.defines={}};WALK.ProceduralSkyMaterial.prototype=
Object.create(WALK.BaseMaterial.prototype);WALK.ProceduralSkyMaterial.prototype.constructor=WALK.ProceduralSkyMaterial;Object.defineProperty(WALK.ProceduralSkyMaterial.prototype,"hdrOutput",{get:function(){return this.defines.hasOwnProperty("HDR_OUTPUT")},set:function(a){a?this.defines.HDR_OUTPUT="":delete this.defines.HDR_OUTPUT;this.programNeedsUpdate=!0}});Object.defineProperty(WALK.ProceduralSkyMaterial.prototype,"colorMap",{get:function(){return this.uniforms.colorMap.value},set:function(a){(this.uniforms.colorMap.value=
a)?this.defines.USE_COLORMAP="":delete this.defines.USE_COLORMAP;this.programNeedsUpdate=!0}})})();(function(){var a,b,c;a=WALK.getShader("object_distance_vertex.glsl");b=WALK.getShader("object_distance_float_fragment.glsl");c=WALK.getShader("object_distance_byte_fragment.glsl");WALK.ObjectDistanceMaterial=function(d){WALK.BaseMaterial.call(this,a,d?b:c);this.uniforms={objectId:{type:"i",value:null}}};WALK.ObjectDistanceMaterial.prototype=Object.create(WALK.BaseMaterial.prototype);WALK.ObjectDistanceMaterial.prototype.constructor=WALK.ObjectDistanceMaterial;WALK.ObjectDistanceMaterial.prototype.refreshPerObjectUniforms=
function(a,b){b.objectId.value=a.visibilityId;return!0}})();(function(){var a,b;a=WALK.getShader("wireframe_vertex.glsl");b=WALK.getShader("wireframe_fragment.glsl");WALK.WireframeMaterial=function(c){WALK.BaseMaterial.call(this,a,b);this.lineColor=c;this.addUniform("lineColor","c",c);this.addUniform("lineMaxAlpha","f",.65);this.addUniform("highlight","c",WALK.EDITOR_SELECTION_COLOR);this.addUniform("highlightMix","f",0);this.customLightmapResolutionLineColor=new THREE.Color(170);this.meshSelectedLineColor=new THREE.Color(47872);this.meshSelectedSecondaryLineColor=
new THREE.Color(13404160);this.transparent=!0;this.depthWrite=this.depthTest=!1;this.attributes={order:{type:"f",value:0}};this.fragmentShaderExtensions="#extension GL_OES_standard_derivatives : enable\n"};WALK.WireframeMaterial.prototype=Object.create(WALK.BaseMaterial.prototype);WALK.WireframeMaterial.prototype.constructor=WALK.WireframeMaterial;WALK.WireframeMaterial.prototype.propertyFromUniform("lineMaxAlpha");WALK.WireframeMaterial.prototype.propertyFromUniform("highlight");WALK.WireframeMaterial.prototype.propertyFromUniform("highlightMix");
WALK.WireframeMaterial.prototype.refreshPerObjectUniforms=function(a,b){var c=!1,d;null!==a.highlightMix&&void 0!==a.highlightMix&&a.highlightMix!==b.highlightMix.value&&(b.highlightMix.value=a.highlightMix,c=!0);return null!==a.selected&&void 0!==a.selected&&(d=!0===a.selected?this.meshSelectedLineColor:!0===a.selectedSecondary?this.meshSelectedSecondaryLineColor:null!==a.node.lightmapResolution?this.customLightmapResolutionLineColor:this.lineColor,b.lineColor.value!==d)?(b.lineColor.value=d,!0):
c}})();(function(){WALK.ObjectDistanceReader=function(a,b){var c,d,e,f=[],g=[],h,k,m,l,n;h=3*b;k=2*b;this.readCubeMapToBuffer=function(b){var f=a.context;e.uniforms.envMap.value=b;n.set(!0,!1,!1);a.render(d,c,m);f.readPixels(0,0,h,k,f.RGBA,f.UNSIGNED_BYTE,l);n.restore();return l};this.dispose=function(){var a;for(a=0;6>a;a+=1)f[a].geometry.dispose();e.dispose();m.dispose();l=null};c=new THREE.OrthographicCamera(-1,1,1,-1,0,1);d=new THREE.Scene;m=new THREE.WebGLRenderTarget(h,k,{format:THREE.RGBAFormat,magFilter:THREE.NearestFilter,
minFilter:THREE.NearestFilter,stencilBuffer:!1,depthBuffer:!1});m.generateMipmaps=!0;l=new Uint8Array(4*h*k);n=new WALK.AutoClearAlter(a);e=new WALK.BaseMaterial("attribute vec3 envLookup;\nvarying vec3 vEnvLookup;\nvoid main() {\nvEnvLookup = envLookup;\ngl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}","uniform samplerCube envMap;\nvarying vec3 vEnvLookup;\nvoid main() {\nint objectId = int(textureCube(envMap, vEnvLookup).x);\nint x = objectId / (256 * 256);\nint y = (objectId - 256 * 256 * x) / 256;\nint z = (objectId - 256 * 256 * x - 256 * y);\ngl_FragColor = vec4(float(x) / 255.0, float(y) / 255.0,\nfloat(z) / 255.0, 1.0);\n}");
e.uniforms={envMap:{type:"t",value:null}};e.attributes={envLookup:{type:"v3",value:null}};(function(){var a,c,h,k,l;k=[[[1,1,1],[1,1,-1],[1,-1,1],[1,-1,-1]],[[-1,1,-1],[-1,1,1],[-1,-1,-1],[-1,-1,1]],[[-1,1,-1],[1,1,-1],[-1,1,1],[1,1,1]],[[-1,-1,1],[1,-1,1],[-1,-1,-1],[1,-1,-1]],[[-1,1,1],[1,1,1],[-1,-1,1],[1,-1,1]],[[1,1,-1],[-1,1,-1],[1,-1,-1],[-1,-1,-1]]];for(a=0;6>a;a+=1){c=new THREE.PlaneBufferGeometry(b,b);l=new Float32Array(12);c.addAttribute("envLookup",new THREE.BufferAttribute(l,3));for(h=
0;4>h;h+=1){var m=h,n=k[a][h],w=l;w[3*m]=n[0];w[3*m+1]=n[1];w[3*m+2]=n[2]}f[a]=new THREE.Mesh(c,e);d.add(f[a])}g[0]=[0,0];g[1]=[b,0];g[2]=[2*b,0];g[3]=[0,b];g[4]=[b,b];g[5]=[2*b,b]})();(function(a,d){var e=a/2,h=d/2;c.left=-e;c.right=e;c.top=h;c.bottom=-h;c.updateProjectionMatrix();var k,e=-e+b/2;k=h-b/2;for(h=0;h<f.length;h+=1)f[h].position.set(e+g[h][0],k-g[h][1],0)})(h,k)}})();(function(){WALK.ObjectDistanceQuery=function(a,b,c){var d,e,f,g,h;d=new WALK.ObjectDistanceMaterial(!0);e=new WALK.CubeCamera(WALK.CAMERA_NEAR,c);c=WALK.LIGHT_DISTANCE_PROBE_SIZE;f=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBAFormat,magFilter:THREE.NearestFilter,minFilter:THREE.NearestFilter,type:THREE.HalfFloatType,stencilBuffer:!1});f.generateMipmaps=!1;g=new WALK.ObjectDistanceReader(a,WALK.OBJECT_VISIBILITY_PROBE_SIZE);h=new WALK.AutoClearAlter(a);this.updateCubeMapAndFindVisibleObjects=
function(c){var k=[],l=[],n=[],p,q;e.position.copy(c);e.updateMatrixWorld();for(c=0;c<b.length;c+=1)p=b[c],console.assert(!p.visibilityId),p.material.transparent||(p.visibilityId=c+1,l.push(p));h.set(!0,!0,!1);for(c=0;6>c;c+=1)f.activeCubeFace=c,a.renderMeshesWithMaterial(l,d,e.sideCameras[c],f);h.restore();var l=g.readCubeMapToBuffer(f),u;p=l.length;for(c=0;c<p;c+=4)u=Math.round(65536*l[c]+256*l[c+1]+l[c+2]),0!==u&&(k[u-1]=!0);for(q in k)k.hasOwnProperty(q)&&n.push(b[q]);for(c=0;c<b.length;c+=1)b[c].visibilityId=
null;return n};this.objectDistanceCubeMap=function(){return f};this.dispose=function(){d.dispose();f.dispose();f=null;g.dispose()}};WALK.ObjectDistanceQuery.prototype.constructor=WALK.ObjectDistanceQuery})();(function(){WALK.LightVisibilityMaterial=function(a,b,c,d){WALK.BaseMaterial.call(this,WALK.getShader("light_visibility_vertex.glsl"),WALK.getShader("light_visibility_fragment.glsl"));this.depthWrite=this.depthTest=!1;this.uniforms={objectId:{type:"f",value:a},lightId:{type:"f",value:0},lightAttrMap:{type:"t",value:b},lightsCount:{type:"f",value:c},objectDistanceMap:{type:"t",value:d},combineWithMap:{type:"t",value:null}}};WALK.LightVisibilityMaterial.prototype=Object.create(WALK.BaseMaterial.prototype);
WALK.LightVisibilityMaterial.prototype.constructor=WALK.LightVisibilityMaterial;Object.defineProperty(WALK.LightVisibilityMaterial.prototype,"lightId",{get:function(){return this.uniforms.lightId.value},set:function(a){this.uniforms.lightId.value=a}});Object.defineProperty(WALK.LightVisibilityMaterial.prototype,"combineWithMap",{get:function(){return this.uniforms.combineWithMap.value},set:function(a){this.uniforms.combineWithMap.value=a}})})();(function(){var a,b;a=WALK.getShader("aabb_query_vertex.glsl");b=WALK.getShader("aabb_query_fragment.glsl");WALK.AabbQueryMaterial=function(){WALK.BaseMaterial.call(this,a,b);this.blending=THREE.NoBlending;this.uniforms={axis:{type:"i",value:0}}};WALK.AabbQueryMaterial.prototype=Object.create(WALK.BaseMaterial.prototype);WALK.AabbQueryMaterial.prototype.constructor=WALK.AabbQueryMaterial;Object.defineProperty(WALK.AabbQueryMaterial.prototype,"axis",{get:function(){return this.uniforms.axis.value},
set:function(a){console.assert(0===a||1===a||2===a);this.uniforms.axis.value=a}})})();(function(){var a,b;a=WALK.getShader("editor_light_vertex.glsl");b=WALK.getShader("editor_light_fragment.glsl");WALK.LightMaterial=function(c){WALK.BaseMaterial.call(this,a,b);this.addUniform("color","c",c.color);this.addUniform("highlight","c",WALK.EDITOR_SELECTION_COLOR);this.addUniform("highlightMix","f",0)};WALK.LightMaterial.prototype=Object.create(WALK.BaseMaterial.prototype);WALK.LightMaterial.prototype.propertyFromUniform("highlightMix")})();(function(){WALK.MirrorMaterial=function(a,b){WALK.BaseMaterial.call(this,WALK.getShader("mirror_vertex.glsl"),WALK.getShader("mirror_fragment.glsl"));this.uniforms={mirrorColor:{type:"c",value:a},mirrorSampler:{type:"t",value:null},textureMatrix:{type:"m4",value:b}}};WALK.MirrorMaterial.prototype=Object.create(WALK.BaseMaterial.prototype);WALK.MirrorMaterial.prototype.constructor=WALK.MirrorMaterial;Object.defineProperty(WALK.MirrorMaterial.prototype,"hdrOutput",{get:function(a){return this.defines.hasOwnProperty("HDR_OUTPUT")},
set:function(a){a?this.defines.HDR_OUTPUT="":delete this.defines.HDR_OUTPUT;this.programNeedsUpdate=!0}});Object.defineProperty(WALK.MirrorMaterial.prototype,"mirrorSampler",{get:function(){return this.uniforms.mirrorSampler.value},set:function(a){this.uniforms.mirrorSampler.value=a}})})();(function(){var a,b;a=WALK.getShader("vr_pointer_vertex.glsl");b=WALK.getShader("vr_pointer_fragment.glsl");WALK.VRPointerMaterial=function(){WALK.BaseMaterial.call(this,a,b);this.transparent=!0;this.addUniform("circleSpan","f",0)};WALK.VRPointerMaterial.prototype=Object.create(WALK.BaseMaterial.prototype);WALK.VRPointerMaterial.prototype.constructor=WALK.VRPointerMaterial;Object.defineProperty(WALK.VRPointerMaterial.prototype,"circleSpan",{set:function(a){console.assert(1>=a);this.uniforms.circleSpan.value=
2*Math.PI*a-Math.PI}})})();(function(){WALK.Mirror=function(a,b,c){THREE.Object3D.call(this);this.name="mirror_"+this.id;this.scene=a;this.mirrorCamera=b.clone();this.renderTargetParams={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1};this.texture=null;c=c||{};this.matrixNeedsUpdate=!0;this.clipBias=void 0!==c.clipBias?c.clipBias:0;a=void 0!==c.color?new THREE.Color(c.color):new THREE.Color(8355711);this.textureMatrix=new THREE.Matrix4;this.mirrorWorldPosition=new THREE.Vector3;
this.mirrorRotationMatrix=new THREE.Matrix4;this.mirrorNormal=new THREE.Vector3;this.cameraWorldPosition=new THREE.Vector3;this.cameraRotationMatrix=new THREE.Matrix4;this.mirrorToCamera=new THREE.Vector3;this.cameraFrustum=null;this.material=new WALK.MirrorMaterial(a,this.textureMatrix)};WALK.Mirror.prototype=Object.create(THREE.Object3D.prototype);WALK.Mirror.prototype.renderWithMirror=function(a){var b;this.updateTextureMatrix();this.matrixNeedsUpdate=!1;b=a.camera;a.camera=this.mirrorCamera;a.renderTemp();
a.material.uniforms.mirrorSampler.value=a.tempTexture;this.render();this.matrixNeedsUpdate=!0;a.material.uniforms.mirrorSampler.value=a.texture;a.camera=b;a.updateTextureMatrix()};WALK.Mirror.prototype.updateMatrixWorld=function(a){THREE.Object3D.prototype.updateMatrixWorld.call(this,a);this.mirrorWorldPosition.setFromMatrixPosition(this.matrixWorld);this.mirrorRotationMatrix.extractRotation(this.matrixWorld);this.mirrorNormal.set(0,0,1);this.mirrorNormal.applyMatrix4(this.mirrorRotationMatrix)};
WALK.Mirror.prototype.updateCameraPosition=function(a,b){this.cameraWorldPosition.setFromMatrixPosition(a.matrixWorld);this.cameraRotationMatrix.extractRotation(a.matrixWorld);this.matrixNeedsUpdate=!0;this.cameraFrustum=b};WALK.Mirror.prototype.inFrustum=function(){this.mirrorToCamera.subVectors(this.cameraWorldPosition,this.mirrorWorldPosition);return this.mirrorToCamera.angleTo(this.mirrorNormal)<Math.PI/2&&this.cameraFrustum.intersectsBox(this.parent.geometry.boundingBox)};WALK.Mirror.prototype.updateTextureMatrix=
function(){var a=new THREE.Vector3,b=new THREE.Vector3,c=new THREE.Vector3,d=new THREE.Vector4,e=new THREE.Plane,f=new THREE.Vector4,g=new THREE.Vector4;return function(){var h;a.copy(this.mirrorWorldPosition).sub(this.cameraWorldPosition).reflect(this.mirrorNormal).negate().add(this.mirrorWorldPosition);c.set(0,0,-1);c.applyMatrix4(this.cameraRotationMatrix);c.add(this.cameraWorldPosition);b.copy(this.mirrorWorldPosition).sub(c).reflect(this.mirrorNormal).negate().add(this.mirrorWorldPosition);this.up.set(0,
-1,0);this.up.applyMatrix4(this.cameraRotationMatrix);this.up.reflect(this.mirrorNormal).negate();this.mirrorCamera.position.copy(a);this.mirrorCamera.up=this.up;this.mirrorCamera.lookAt(b);this.mirrorCamera.updateProjectionMatrix();this.mirrorCamera.updateMatrixWorld();this.mirrorCamera.matrixWorldInverse.getInverse(this.mirrorCamera.matrixWorld);this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);this.textureMatrix.multiply(this.mirrorCamera.projectionMatrix);this.textureMatrix.multiply(this.mirrorCamera.matrixWorldInverse);
e.setFromNormalAndCoplanarPoint(this.mirrorNormal,this.mirrorWorldPosition);e.applyMatrix4(this.mirrorCamera.matrixWorldInverse);d.set(e.normal.x,e.normal.y,e.normal.z,e.constant);h=this.mirrorCamera.projectionMatrix;f.x=(Math.sign(d.x)+h.elements[8])/h.elements[0];f.y=(Math.sign(d.y)+h.elements[9])/h.elements[5];f.z=-1;f.w=(1+h.elements[10])/h.elements[14];g=d.multiplyScalar(2/d.dot(f));h.elements[2]=g.x;h.elements[6]=g.y;h.elements[10]=g.z+1-this.clipBias;h.elements[14]=g.w}}();WALK.Mirror.prototype.configure=
function(a,b,c,d){this.mirrorCamera.aspect=c;this.mirrorCamera.fov=d;this.mirrorCamera.updateProjectionMatrix();null!==this.texture&&this.texture.dispose();this.texture=new THREE.WebGLRenderTarget(a,b,this.renderTargetParams);this.material.mirrorSampler=this.texture};WALK.Mirror.prototype.render=function(a){this.material.visible&&(this.matrixNeedsUpdate&&(this.updateTextureMatrix(),this.matrixNeedsUpdate=!1),this.material.visible=!1,a.render(this.scene,this.mirrorCamera,this.texture,!0),this.material.visible=
!0)};WALK.Mirror.prototype.renderTemp=function(a){this.matrixNeedsUpdate&&this.updateTextureMatrix();a.render(this.scene,this.mirrorCamera,this.tempTexture,!0)}})();(function(){function a(a){a instanceof THREE.Mesh&&(a.frustumCulled=!1)}function b(a){a instanceof THREE.Mesh&&(a.frustumCulled=!0)}function c(a){var b=0,c;for(c=0;c<a.length;c+=1)b+=a[c].instances.length;return b+1}function d(a){var b,d,e;b=c(a);d=new Float32Array(16*b);for(e=0;16>e;e+=1)d[e]=0;WALK.Light.iterateLightInstances(a,function(a,b,c){c*=16;d[c]=b.position.x;d[c+1]=b.position.y;d[c+2]=b.position.z;d[c+3]=a.size;d[c+4]=a.color.r;d[c+5]=a.color.g;d[c+6]=a.color.b;d[c+7]=a.strength;"spot"===
a.type?(WALK.log("have spot light"),d[c+8]=1,b=b.directionW(),d[c+9]=b.x,d[c+10]=b.y,d[c+11]=b.z,d[c+12]=THREE.Math.degToRad(a.angle/2)):(WALK.log("have point light"),d[c+8]=0)});a=new WALK.DataTexture(d,16*b/4,1,THREE.RGBAFormat,THREE.FloatType,THREE.UVMapping,THREE.ClampToEdgeWrapping,THREE.ClampToEdgeWrapping,THREE.NearestFilter,THREE.NearestFilter);a.needsUpdate=!0;return a}var e,f;f=function(a,b,c){var d=[],e,f,g;this.findFreeChannel=function(b){var c,h;h=b;e.material.uniforms.threshold.value=
1024;for(b=0;b<d.length;b+=1)c=d[b],f.set(1/h.width,1/h.height),e.material.uniforms.sizeInv.value=f,e.render(a,c,h),h=c,e.material.uniforms.threshold.value=1;b=a.context;b.readPixels(0,0,1,1,b.RGBA,b.UNSIGNED_BYTE,g);for(b=0;4>b;b+=1)if(0===g[b])return b;return null};this.dispose=function(){var a;for(a=0;a<d.length;a+=1)d[a].dispose(),d[a]=null;e.material.dispose()};(function(){var a,h,k,l;h={format:THREE.RGBAFormat,magFilter:THREE.NearestFilter,minFilter:THREE.NearestFilter,stencilBuffer:!1};k=b;
for(l=c;1!==k&&1!==l;)k=Math.max(k/2,1),l=Math.max(l/2,1),a=new THREE.WebGLRenderTarget(k,l,h),a.generateMipmaps=!1,d.push(a);f=new THREE.Vector2;a={uniforms:{lightVisibilityMap:{type:"t",value:null},threshold:{type:"f",value:null},sizeInv:{type:"v2",value:null}},vertexShader:THREE.CopyShader.vertexShader,fragmentShader:WALK.getShader("light_visibility_free_channel_fragment.glsl")};e=new THREE.ShaderPass(a,"lightVisibilityMap");g=new Uint8Array(4)})()};e=function(a){var b=[],c={};this.lightMap=function(a){return b[a]};
this.lightMapId=function(a){return c[a.name]};this.lightMapsCount=function(){return b.length};this.findObjectsWithLightMap=function(a,b){var d=[],e,f,g;for(f=0;f<a.length;f+=1)g=a[f],e=g.userData.origMaterial,c[e.lightMap.name]===b&&d.push(g);return d};(function(){var d,e;for(e=0;e<a.length;e+=1)(d=a[e].lightMap)&&void 0===c[d.name]&&(c[d.name]=b.length,b.push(d))})()};WALK.LightAssigner=function(g,h,k,m,l){var n,p,q,u,r,t,v,x,w;this.assignLightLookupMaps=function(){var a,b,d;for(a=0;a<m.length;a+=
1)if(b=m[a],d=b.lightMap)d=n.lightMapId(d),b.lightVisibilityMap=w[d],b.lightAttrMap=x,b.lightsCount=c(k),b.setUniforms()};this.dispose=function(){var a;p.dispose();q.dispose();t.material.dispose();for(a=0;a<n.lightMapsCount();a+=1)r[a].dispose()};(function(){var a,b,c,G=0,L=0;n=new e(m);u=[];r=[];w=[];for(a=0;a<n.lightMapsCount();a+=1)b=n.lightMap(a),console.assert(b.width&&b.height),c=b.width/WALK.LIGHT_VISIBILITY_MAP_DOWNSAMPLE,b=b.height/WALK.LIGHT_VISIBILITY_MAP_DOWNSAMPLE,G=Math.max(G,c),L=Math.max(L,
b),u[a]=new THREE.WebGLRenderTarget(c,b,{format:THREE.RGBAFormat,magFilter:THREE.NearestFilter,minFilter:THREE.NearestFilter,type:THREE.HalfFloatType,stencilBuffer:!0}),u[a].generateMipmaps=!1,r[a]=new THREE.WebGLRenderTarget(c,b,{format:THREE.RGBAFormat,magFilter:THREE.NearestFilter,minFilter:THREE.NearestFilter,type:THREE.HalfFloatType,stencilBuffer:!0}),r[a].generateMipmaps=!1,r[a].shareDepthFrom=u[a],w[a]=u[a];p=new WALK.ObjectDistanceQuery(g,l,h);q=new f(g,G,L);x=d(k);t=new THREE.ShaderPass(THREE.CopyShader);
v=new WALK.AutoClearAlter(g)})();(function(){var a,b,d;b=c(k);d=p.objectDistanceCubeMap();for(a=0;a<l.length;a+=1)l[a].userData.origMaterial=l[a].material,l[a].material=new WALK.LightVisibilityMaterial(a+1,x,b,d)})(l);WALK.Light.iterateLightInstances(k,function(c,d,e){var f,h,k,m=[];if(0===c.strength)WALK.log("skipping light instance with strength 0");else{c=g.context;h=p.updateCubeMapAndFindVisibleObjects(d.position);WALK.log("Objects visible from light"+e+" "+h.length);c.enable(c.STENCIL_TEST);
k=!0;for(d=0;d<n.lightMapsCount();d+=1){f=n.findObjectsWithLightMap(h,d);var x=new THREE.Scene,w;for(w=0;w<f.length;w+=1)x.add(new THREE.Mesh(f[w].geometry,f[w].material));f=x;f.traverse(a);x=e;w=r[d];var E,y;for(E=0;E<l.length;E+=1)y=l[E].material,console.assert(y instanceof WALK.LightVisibilityMaterial),y.lightId=x,y.combineWithMap=w;v.set(!0,!0,!0);c.stencilOp(c.REPLACE,c.REPLACE,c.REPLACE);c.stencilFunc(c.ALWAYS,1,4294967295);g.render(f,t.camera,u[d]);v.restore();f.traverse(b);v.set(!1,!1,!1);
f=q.findFreeChannel(u[d]);v.restore();if(null===f){k=!1;break}m[d]=f}if(k){v.set(!1,!1,!1);c.stencilFunc(c.EQUAL,1,4294967295);c.stencilOp(c.KEEP,c.KEEP,c.KEEP);for(d=0;d<n.lightMapsCount();d+=1){f=m[d];e=c;switch(f){case 0:e.colorMask(!0,!1,!1,!1);break;case 1:e.colorMask(!1,!0,!1,!1);break;case 2:e.colorMask(!1,!1,!0,!1);break;case 3:e.colorMask(!1,!1,!1,!0);break;default:console.assert(!1)}t.render(g,r[d],u[d]);c.colorMask(!0,!0,!0,!0)}v.restore()}else WALK.log("Available channel not found, skipping light");
c.disable(c.STENCIL_TEST)}});(function(){var a;for(a=0;a<l.length;a+=1)l[a].material.dispose(),l[a].material=l[a].userData.origMaterial,delete l[a].userData.origMaterial})(l);(function(){var a,b,c,d;b=new THREE.Vector2;a={uniforms:{lightVisibilityMap:{type:"t",value:null},sizeInv:{type:"v2",value:null}},vertexShader:THREE.CopyShader.vertexShader,fragmentShader:WALK.getShader("light_visibility_dilate_fragment.glsl")};a=new THREE.ShaderPass(a,"lightVisibilityMap");v.set(!1,!1,!1);for(d=0;d<n.lightMapsCount();d+=
1)c=w[d],b.set(1/c.width,1/c.height),a.material.uniforms.sizeInv.value=b,a.material.programNeedsUpdate=!0,a.render(g,c,r[d]);v.restore();a.material.dispose()})()}})();(function(){WALK.LightInstance=function(a,b,c){this.light=a;this.position=b;this.rotation=c;this._directionW=new THREE.Vector3};WALK.LightInstance.prototype={constructor:WALK.LightInstance,directionW:function(){this._directionW.set(0,1,0);this._directionW.applyEuler(this.rotation);return this._directionW},get index(){var a=this.light.instances.indexOf(this);console.assert(-1!==a,"Light instance not found");return a},setPosition:function(a,b,c){this.position.set(a,b,c);this.light._instanceUpdated()},
setRotationDeg:function(a,b){this.rotation.yaw=WALK.normalizeRotation(THREE.Math.degToRad(a));this.rotation.pitch=WALK.normalizeRotation(THREE.Math.degToRad(b));this.light._instanceUpdated()}};WALK.Light=function(a){this.name=a.name;this._type=a.type||"spot";var b;if(void 0!==a.strength)b=a.strength;else a:{switch(this._type){case "point":case "spot":b=25;break a;case "sun":b=8;break a;default:console.assert(!1)}b=void 0}this.strength=b;if(void 0!==a.color)b=(new THREE.Color).fromArray(a.color);else a:{switch(this._type){case "point":case "spot":b=
new THREE.Color(1,.88,.799);break a;case "sun":b=new THREE.Color(1,.8,.638);break a;default:console.assert(!1)}b=void 0}this._color=b;if(void 0!==a.size)b=a.size;else a:{switch(this._type){case "point":case "spot":b=.1;break a;case "sun":b=.02;break a;default:console.assert(!1)}b=void 0}this._size=b;this._angle=void 0!==a.angle?a.angle:140;this.doNotImport=void 0!==a.doNotImport?a.doNotImport:!1;this.instances=[]};WALK.Light.prototype={constructor:WALK.Light,forEachLightInstance:function(a){var b;
for(b=0;b<this.instances.length;b+=1)a(this.instances[b])},get type(){return this._type},set type(a){this._type=a;this.dispatchEvent({type:"lightUpdated",light:this})},get size(){return this._size},set size(a){this._size=a;this.dispatchEvent({type:"lightUpdated",light:this})},get angle(){return this._angle},set angle(a){this._angle=a;this.dispatchEvent({type:"lightUpdated",light:this})},get color(){return this._color},addInstance:function(a,b){var c,d;c=(new THREE.Vector3).fromArray(a);d=(new WALK.Euler).setFromDegTriple(b);
c=new WALK.LightInstance(this,c,d);this.instances.push(c);this.dispatchEvent({type:"lightInstanceAdded",instance:c})},removeInstance:function(a){var b=this.instances.indexOf(a);console.assert(-1!==b);this.instances.splice(b,1);this.dispatchEvent({type:"lightInstanceRemoved",instance:a})},_instanceUpdated:function(){this.dispatchEvent({type:"lightUpdated",light:this})}};THREE.EventDispatcher.prototype.apply(WALK.Light.prototype);WALK.Light.iterateLightInstances=function(a,b){var c,d,e,f=1;for(c=0;c<
a.length;c+=1)for(e=a[c],d=0;d<e.instances.length;d+=1,f+=1)b(e,e.instances[d],f)}})();(function(){var a=WALK.mipsCount(WALK.LIGHT_PROBE_MIN_MIP_SIZE,WALK.LIGHT_PROBE_MAX_MIP_SIZE);WALK.LightProbe=function(b){this.id=b.id;this.position=(new THREE.Vector3).fromArray(b.position);this._mirrorCubeTexture=this._filteredCubeTexture=null;this.filteredMipsCount=a;b.box?(this.boxMin=(new THREE.Vector3).fromArray(b.box.min),this.boxMax=new THREE.Vector3,this._setClampedBoxMax(b.box.max[0],b.box.max[1],b.box.max[2])):this.boxMax=this.boxMin=null};WALK.LightProbe.prototype={constructor:WALK.LightProbe,
setFilteredTexture:function(a){this._filteredCubeTexture&&this._filteredCubeTexture.dispose();this._filteredCubeTexture=a},disableBoundingBox:function(){this.boxMin=this.boxMax=null;this.dispatchEvent({type:"lightProbeBoundsUpdated",lightProbe:this})},enableBoundingBox:function(){this.boxMin=new THREE.Vector3;this.boxMax=new THREE.Vector3;this.dispatchEvent({type:"lightProbeBoundsInit",lightProbe:this});this.dispatchEvent({type:"lightProbeBoundsUpdated",lightProbe:this})},getFilteredTexture:function(){return this._filteredCubeTexture},
setMirrorTexture:function(a){this._mirrorCubeTexture&&this._mirrorCubeTexture.dispose();this._mirrorCubeTexture=a},setPosition:function(a,c,d){this.position.set(a,c,d);this.dispatchEvent({type:"lightProbePositionUpdated",lightProbe:this})},getMirrorTexture:function(){return this._mirrorCubeTexture||this._filteredCubeTexture},hasBoundingBox:function(){return this.boxMin&&this.boxMax},_setClampedBoxMin:function(a,c,d){a>this.boxMax.x-.1&&(a=this.boxMax.x-.1);c>this.boxMax.y-.1&&(c=this.boxMax.y-.1);
d>this.boxMax.z-.1&&(d=this.boxMax.z-.1);this.boxMin.set(a,c,d)},isBoxMinValid:function(a,c,d){return a>this.boxMax.x-.1||c>this.boxMax.y-.1||d>this.boxMax.z-.1?!1:!0},isBoxMaxValid:function(a,c,d){return a<this.boxMin.x+.1||c<this.boxMin.y+.1||d<this.boxMin.z+.1?!1:!0},setBoxMin:function(a,c,d){this._setClampedBoxMin(a,c,d);this.dispatchEvent({type:"lightProbeBoundsUpdated",lightProbe:this})},_setClampedBoxMax:function(a,c,d){a<this.boxMin.x+.1&&(a=this.boxMin.x+.1);c<this.boxMin.y+.1&&(c=this.boxMin.y+
.1);d<this.boxMin.z+.1&&(d=this.boxMin.z+.1);this.boxMax.set(a,c,d)},setBoxMax:function(a,c,d){this._setClampedBoxMax(a,c,d);this.dispatchEvent({type:"lightProbeBoundsUpdated",lightProbe:this})},dispose:function(){this._filteredCubeTexture&&(this._filteredCubeTexture.dispose(),this._filteredCubeTexture=null);this._mirrorCubeTexture&&(this._mirrorCubeTexture.dispose(),this._mirrorCubeTexture=null)}};THREE.EventDispatcher.prototype.apply(WALK.LightProbe.prototype)})();(function(){function a(a){return null!==a&&void 0!==a}function b(a){a.configure()}function c(a){a.visitSubtree(b)}WALK.NodeConfig=function(b){this.name=b.name;this._setsDisableCollisions=a(b.disableCollisions);this._disableCollisions=b.disableCollisions||!1;this._setsHideInViews=a(b.hideInViews);this.hideInViews=b.hideInViews||null;this.setsTriggers=a(b.triggers);this.triggers=b.triggers||null;this._lightmapResolution=(this._setsLightmapResolution=a(b.lightmapResolution))?b.lightmapResolution:null;
this._ground=a(b.ground)?b.ground:null;this.nodes=[]};WALK.NodeConfig.prototype.constructor=WALK.NodeConfig;WALK.NodeConfig.prototype._configUpdated=function(){this.nodes.forEach(c)};WALK.NodeConfig.prototype.addNode=function(a){this.nodes.push(a)};WALK.NodeConfig.prototype.isOnHideInViews=function(a){return-1!==this.hideInViews.indexOf(a)};WALK.NodeConfig.prototype.addToHideInViews=function(a){console.assert(this.setsHideInViews);console.assert(!this.isOnHideInViews(a));this.hideInViews.push(a)};
WALK.NodeConfig.prototype.removeFromHideInViews=function(a){var b=0;if(this.hideInViews)for(;b<this.hideInViews.length;)this.hideInViews[b]===a?this.hideInViews.splice(b,1):b+=1};WALK.NodeConfig.prototype.removeTrigger=function(a){var b=0;if(this.setsTriggers&&this.triggers)for(;b<this.triggers.length;)this.triggers[b]===a?this.triggers.splice(b,1):b+=1};Object.defineProperty(WALK.NodeConfig.prototype,"setsDisableCollisions",{get:function(){return this._setsDisableCollisions},set:function(a){this._setsDisableCollisions=
a;this._configUpdated()}});Object.defineProperty(WALK.NodeConfig.prototype,"disableCollisions",{get:function(){return this._disableCollisions},set:function(a){console.assert(this._setsDisableCollisions);this._disableCollisions=a;this._configUpdated()}});Object.defineProperty(WALK.NodeConfig.prototype,"ground",{get:function(){return this._ground},set:function(a){this._ground=a;this._configUpdated()}});Object.defineProperty(WALK.NodeConfig.prototype,"setsLightmapResolution",{get:function(){return this._setsLightmapResolution},
set:function(a){this._setsLightmapResolution=a;this._configUpdated()}});Object.defineProperty(WALK.NodeConfig.prototype,"lightmapResolution",{get:function(){return this._lightmapResolution},set:function(a){console.assert(this._setsLightmapResolution);this._lightmapResolution=a;this._configUpdated()}});Object.defineProperty(WALK.NodeConfig.prototype,"setsHideInViews",{get:function(){return this._setsHideInViews},set:function(a){this._setsHideInViews=a;null===this.hideInViews&&(this.hideInViews=[]);
this._configUpdated()}});WALK.Node=function(a,b,c){this.id=c.id;this.initialLightProbeId=c.lightProbeId;this.parent=a;this.config=b;this.name=b.name;this.children=[];this.lightmapResolution=this.triggers=this.hideInViews=this.ground=this.disableCollisions=this._facesCnt=this.mesh=this._sortedChildren=null;b.addNode(this);this.configure()};WALK.Node.prototype.constructor=WALK.Node;WALK.Node.prototype.configure=function(){this.ground=(this.disableCollisions=this.config.setsDisableCollisions?this.config.disableCollisions:
this.parent?this.parent.disableCollisions:!1)?!1:null!==this.config.ground?this.config.ground:!1;this.hideInViews=this.config.setsHideInViews?this.config.hideInViews:this.parent?this.parent.hideInViews:null;this.triggers=this.config.setsTriggers?this.config.triggers:this.parent?this.parent.triggers:null;this.lightmapResolution=this.config.setsLightmapResolution?this.config.lightmapResolution:this.parent?this.parent.lightmapResolution:null};WALK.Node.prototype.visitSubtree=function(a){var b,c;a(this);
if(c=this.children)for(b=0;b<c.length;b+=1)c[b].visitSubtree(a)};WALK.Node.prototype.facesInSubtree=function(){var a=this;null===a._facesCnt&&(a._facesCnt=0,a.visitSubtree(function(b){b.mesh&&(a._facesCnt+=b.mesh.geometry.vertexCnt/3)}));return a._facesCnt};WALK.Node.prototype.sortedChildren=function(){null===this._sortedChildren&&(this._sortedChildren=this.children.slice(0).sort(WALK.Node.compareByFaces));return this._sortedChildren};Object.defineProperty(WALK.Node.prototype,"highlightMix",{set:function(a){this.visitSubtree(function(b){b.mesh&&
(b.mesh.highlightMix=a)})}});Object.defineProperty(WALK.Node.prototype,"selected",{set:function(a){this.visitSubtree(function(b){b.mesh&&(b.mesh.selected=a)})}});Object.defineProperty(WALK.Node.prototype,"selectedSecondary",{set:function(a){this.visitSubtree(function(b){b.mesh&&(b.mesh.selectedSecondary=a)})}});WALK.Node.compareByFaces=function(a,b){return b.facesInSubtree()-a.facesInSubtree()}})();(function(){WALK.Mesh=function(a,b,c){THREE.Mesh.call(this,b,c);this.node=a;this.useFaces16=!1;this.quantUv0Max=this.quantUv0Range=this.quantVertexMax=this.quantVertexRange=this.transformByteOffset=this.uv1CoordVOffset=this.uv1CoordUOffset=this.uv1CoordVScale=this.uv1CoordUScale=this.lightMapIdx=this.uv1ByteOffset=this.uv0ByteOffset=this.normalByteOffset=this.vertexCnt=this.vertexByteOffset=this.faceCnt=this.faceByteOffset=0;this.lightProbe=this.lightMap=null;this.matrixAutoUpdate=this.rotationAutoUpdate=
!1;this.selected=this.highlightMix=null;this.selectedSecondary=!1;this.visibilityId=null;this.cameraDistance=0;this.matrix=this.matrixWorld=null;this.sharedBuffersDebug=0};WALK.Mesh.prototype=Object.create(THREE.Mesh.prototype);WALK.Mesh.prototype.constructor=WALK.Mesh;WALK.Mesh.prototype.clone=void 0;WALK.Mesh.prototype.updateMatrixWorld=function(){};WALK.Mesh.prototype.uv0InBuffers=function(){return-1!==this.uv0ByteOffset};WALK.Mesh.prototype.uv1InBuffers=function(){return-1!==this.uv1ByteOffset};
WALK.Mesh.prototype.quantVertexFactor=function(){return this.quantVertexRange/this.quantVertexMax};WALK.Mesh.prototype.quantUv0Disabled=function(){return 0===this.quantUv0Max};WALK.Mesh.prototype.quantUv0Factor=function(){return this.quantUv0Range/this.quantUv0Max};Object.defineProperty(WALK.Mesh.prototype,"hideInViews",{get:function(){return this.node.hideInViews},set:function(a){console.assert(!1)}});WALK.MergedMesh=function(a,b){THREE.Mesh.call(this,a,b);this.anyLogicalMeshHasUvs=!1;this.lightProbe=
this.lightMap=null;this.matrixAutoUpdate=this.rotationAutoUpdate=!1;this.hideInViews=null;this.matrixAutoUpdate=this.rotationAutoUpdate=!1;this.center=null;this.cameraDistance=0;this.matrix=this.matrixWorld=null;this.logicalMeshes=[]};WALK.MergedMesh.prototype=Object.create(THREE.Mesh.prototype);WALK.MergedMesh.prototype.constructor=WALK.MergedMesh;WALK.MergedMesh.prototype.clone=void 0;WALK.MergedMesh.prototype.updateMatrixWorld=function(){}})();(function(){WALK.SkyMesh=function(a,b,c){THREE.Mesh.call(this,b,c);this.name=a};WALK.SkyMesh.prototype=Object.create(THREE.Mesh.prototype);WALK.SkyMesh.prototype.constructor=WALK.SkyMesh;WALK.SkyMesh.prototype.clone=void 0;Object.defineProperty(WALK.SkyMesh.prototype,"yawRotationDeg",{get:function(){return THREE.Math.radToDeg(this.rotation.y)},set:function(a){a=THREE.Math.degToRad(a);this.rotation.y=a}});Object.defineProperty(WALK.SkyMesh.prototype,"isEquirect",{get:function(){return this.material instanceof
WALK.EquirectSkyMaterial}})})();(function(){WALK.View=function(a){this.id=a.id;this.name=a.name;this.internal=a.internal||!1;a.position&&(this.position=new THREE.Vector3(a.position[0],a.position[1],a.position[2]));this.rotation=new WALK.Euler(WALK.normalizeRotation(THREE.Math.degToRad(a.rotation[0])),WALK.normalizeRotation(THREE.Math.degToRad(a.rotation[1])),0);this.hideFromMenu=a.hideFromMenu;this.sky=a.sky;this.mode=a.mode||"fps";this.distance=a.distance;this.minDistance=a.minDistance;this.maxDistance=a.maxDistance;this.panPrimary=
a.panPrimary;this.noRotate=a.noRotate;this.noPitchRotate=a.noPitchRotate;a.target&&(this.target=new THREE.Vector3(a.target[0],a.target[1],a.target[2]))};WALK.View.prototype={constructor:WALK.View,isTop:function(){return"orbit"===this.mode&&this.panPrimary&&this.noPitchRotate},usesDefaultSky:function(){return this.sky===WALK.DEFAULT_SKY_NAME}}})();(function(){function a(a,b,c){var d;c=c||"id";for(d=0;d<a.length;d+=1)if(a[d].hasOwnProperty(c)&&a[d][c]===b)return!1;return!0}function b(a,b,c){var d;c=c||"id";for(d=0;d<a.length;d+=1)if(a[d][c]===b)return a[d];return null}function c(a,b){var c=b.indexOf(a);console.assert(-1!==c);b.splice(c,1)}function d(a,b){var c=a.name.toUpperCase(),d=b.name.toUpperCase();return c<d?-1:c>d?1:0}WALK.Scene=function(){this._headLight=!1;this.threeScene=new THREE.Scene;this.threeScene.autoUpdate=!1;this.autoTour=
{disabled:!1,startOnLoad:!1};this.canStartAutoTour=function(){return!this.autoTour.disabled&&1<this.visibleViews().length};this.startAutoTourOnLoad=function(){return this.canStartAutoTour()&&this.autoTour.startOnLoad};this.disableProgressiveLoader=!1;this.camera=new THREE.PerspectiveCamera(WALK.CAMERA_DEFAULT_FOV,1,WALK.CAMERA_NEAR,WALK.CAMERA_MIN_FAR);this.camera.moveMaxSpeed=WALK.CAMERA_DEFAULT_MOVE_MAX_SPEED;this.camera.autoClimb=!1;this._colorMap=null;this._cameraExposure=0;this._cameraGamma=
1;this.materials=[];this._sortedMaterials=null;this.nodeConfigs=[];this._nodeConfigsLookup={};this.nodes=[];this._sortedNodes=null;this.gpuMeshes=[];this.gpuIndexedBuffersSize=0;this.mirrors=[];this.boundingBox=new THREE.Box3;this.skyMeshes=[];this.hideViewsMenu=!1;this.views=[];this.triggers=[];this.lights=[];this.lightProbes=[];this.addMaterial=function(a){this.materials.push(a);this.colorMapReady()&&void 0!==a.colorMap&&(a.colorMap=this.colorMap);void 0!==a.cameraExposure&&(a.cameraExposure=this._cameraExposure);
void 0!==a.cameraGamma&&(a.cameraGamma=this._cameraGamma);void 0!==a.headLight&&(a.headLight=this.headLight)};this.addNodeConfig=function(a){this.nodeConfigs.push(a);this._nodeConfigsLookup[a.name]=a};this.findNodeConfig=function(a){return this._nodeConfigsLookup.hasOwnProperty(a)?this._nodeConfigsLookup[a]:null};this.addNode=function(a){console.assert(null===this._sortedNodes);this.nodes.push(a)};this.visitAllNodes=function(a){var b;for(b=0;b<this.nodes.length;b+=1)this.nodes[b].visitSubtree(a)};
this.visitMeshesWithMaterial=function(a,b){this.visitAllNodes(function(c){(c=c.mesh)&&c.material===a&&b(c)})};this.sortedMaterials=function(){null===this._sortedMaterials&&(this._sortedMaterials=this.materials.slice(0).sort(d));return this._sortedMaterials};this.sortedNodes=function(){null===this._sortedNodes&&(this._sortedNodes=this.nodes.slice(0).sort(WALK.Node.compareByFaces));return this._sortedNodes};this.addGpuMesh=function(a){if(a.material.planarReflector){var b;b=new WALK.Mirror(this.threeScene,
this.camera,{clipBias:0,color:8355711,debugMode:!1});b.material.name=a.material.name;var c=a.geometry,d,e,m;c.boundingBox||c.computeBoundingBox();d=c.boundingBox;e=Math.sqrt(Math.pow(d.max.x-d.min.x,2)+Math.pow(d.max.z-d.min.z,2));m=d.max.y-d.min.y;e&&m?(e=new THREE.Mesh(new THREE.PlaneBufferGeometry(e,m),b.material),e.rotation.y=Math.atan2(c.normals[0],c.normals[2]),d.center(e.position),e.geometry.boundingBox=d,e.add(b),b=e):(WALK.log("mirror with 0 dimension"),b=null);this.mirrors.push(b.children[0]);
this.threeScene.add(b)}else this.threeScene.add(a);this.gpuMeshes.push(a);this.boundingBox.union(a.geometry.boundingBox)};this.addSkyMesh=function(a){this.skyMeshes.push(a);this.colorMapReady()&&(a.material.colorMap=this.colorMap);this.dispatchEvent({type:"skyMeshAdded",skyMesh:a})};this.removeSkyMesh=function(a){c(a,this.skyMeshes);this.dispatchEvent({type:"skyMeshRemoved",skyMesh:a});a.geometry.dispose();a.material.map&&a.material.map.dispose();a.material.dispose()};this.findSkyMesh=function(a){return b(this.skyMeshes,
a,"name")};this.addLight=function(b){console.assert(a(this.lights,b.name,"name"));this.lights.push(b);this.dispatchEvent({type:"lightAdded",light:b})};this.removeLight=function(a){c(a,this.lights);this.dispatchEvent({type:"lightRemoved",light:a})};this.addLightProbe=function(b){console.assert(a(this.lightProbes,b.id));this.lightProbes.push(b);this.dispatchEvent({type:"lightProbeAdded",lightProbe:b})};this.removeLightProbe=function(a){var b;c(a,this.lightProbes);for(b=0;b<this.gpuMeshes.length;b+=
1)this.gpuMeshes[b].lightProbe===a&&(this.gpuMeshes[b].lightProbe=null);this.dispatchEvent({type:"lightProbeRemoved",lightProbe:a});a.dispose()};this.findLightProbe=function(a){return b(this.lightProbes,a)};this.findView=function(a){return b(this.views,a)};this.visibleViews=function(){return WALK.filter(this.views,function(a){return!a.hideFromMenu})};this.findTrigger=function(a){return b(this.triggers,a)};this.addView=function(b){console.assert(a(this.views,b.id));this.views.push(b);this.dispatchEvent({type:"viewAdded",
view:b})};this.removeView=function(a){var b,d;c(a,this.views);for(b=this.triggers.length-1;0<=b;--b)d=this.triggers[b],d.viewId===a.id&&this.removeTrigger(d);this.nodeConfigs.forEach(function(b){b.removeFromHideInViews(a.id)});this.dispatchEvent({type:"viewRemoved",view:a})};this.changeViewPosition=function(a,b){var c,d;c=this.views.indexOf(a);for(d=b>c?1:-1;c!==b;c+=d)this.views[c]=this.views[c+d];this.views[b]=a;this.dispatchEvent({type:"viewShifted",view:a})};this.removeTrigger=function(a){c(a,
this.triggers);this.nodeConfig.forEach(function(b){b.removeTrigger(a.triggerId)})};this.hasLightMap=function(){return void 0!==WALK.find(this.materials,function(a){return a.lightMapped})};this.setSkyRadiusAndCameraFarToSpanWholeScene=function(){var a,b,c,d=0;for(a=0;a<this.skyMeshes.length;a+=1)b=this.skyMeshes[a],c=this.boundingBox.empty()?0:Math.max(b.position.distanceTo(this.boundingBox.min),b.position.distanceTo(this.boundingBox.max)),c+=WALK.SKY_DISTANCE_TO_SCENE,b.scale.set(c,c,c),b.updateMatrixWorld(!0),
d=Math.max(d,c);this.camera.far=Math.max(this.camera.far,2*d);this.camera.updateProjectionMatrix();WALK.log("Camera far set to "+this.camera.far)};this._assignColorMap=function(){var a=this._colorMap;this.materials.forEach(function(b){void 0!==b.colorMap&&(b.colorMap=a);b.setUniforms()});this.skyMeshes.forEach(function(b){b.material.colorMap=a})};this.disableLightProbesForMaterials=function(){var a;for(a=0;a<this.materials.length;a+=1)this.materials[a].disableLightProbeTmp=!0,this.materials[a].setUniforms()};
this.enableLightProbesForMaterials=function(){var a;for(a=0;a<this.materials.length;a+=1)this.materials[a].disableLightProbeTmp=!1,this.materials[a].setUniforms()}};WALK.Scene.prototype={constructor:WALK.Scene,get colorMap(){return this._colorMap},set colorMap(a){this._colorMap&&this._colorMap.dispose();(this._colorMap=a)?a.addLoadedListener(this._assignColorMap.bind(this)):this._assignColorMap()},colorMapReady:function(){return this._colorMap&&this._colorMap.loaded},get headLight(){return this._headLight},
set headLight(a){a!==this._headLight&&(this._headLight=a,this.materials.forEach(function(b){b.headLight=a;b.setUniforms()}))},get cameraExposure(){return this._cameraExposure},set cameraExposure(a){a!==this._cameraExposure&&(this._cameraExposure=a,this.materials.forEach(function(b){void 0!==b.cameraExposure&&(b.cameraExposure=a);b.setUniforms()}))},get cameraGamma(){return this._cameraGamma},set cameraGamma(a){a!==this._cameraGamma&&(this._cameraGamma=a,this.materials.forEach(function(b){void 0!==
b.cameraGamma&&(b.cameraGamma=a);b.setUniforms()}))}};THREE.EventDispatcher.prototype.apply(WALK.Scene.prototype)})();(function(){THREE.BufferGeometry.prototype.addTriangleOrderAttribute=function(){var a,b,c;if(void 0===this.getAttribute("order")){b=void 0!==this.vertexCnt?this.vertexCnt:this.getAttribute("position").length/3;c=new Float32Array(b);for(a=0;a<b;a+=1)c[a]=a%3;this.addAttribute("order",new THREE.BufferAttribute(c,1))}};THREE.BufferGeometry.prototype.convertNormalsToSpherical=function(){var a,b,c,d,e,f,g,h;console.assert(void 0===this.getAttribute("sphericalNormal"));a=this.getAttribute("normal");console.assert(!a.buffer);
b=a.array;a=b.length/3;c=new Int8Array(2*a);for(d=0;d<a;d+=1)e=3*d,h=2*d,f=b[e],g=b[e+1],e=b[e+2],e=2*(Math.acos(e)/Math.PI-.5),f=Math.atan2(g,f)/Math.PI,c[h]=WALK.Math.toSnorm8(e),c[h+1]=WALK.Math.toSnorm8(f);delete this.attributes.normal;this.addAttribute("sphericalNormal",new THREE.BufferAttribute(c,2))};WALK.MergedGeometry=function(){THREE.BufferGeometry.call(this);this.index=null;this.indexUint=!0;this.uvs1=this.uvs0=this.normals=this.vertices=null;this.vertexOffset=this.vertexCnt=this.indexOffset=
this.indexCnt=0;this.boundingBox=new THREE.Box3;this.boundingSphere=new THREE.Sphere};WALK.MergedGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);WALK.MergedGeometry.prototype.constructor=WALK.MergedGeometry;WALK.MergedGeometry.prototype.clone=function(){console.error("WALK.MergedGeometry cloning not supported")};WALK.MergedGeometry.prototype.allocateCoreBuffers=function(a){console.assert(!this.vertices);a&&(65536>=this.vertexCnt?(this.indexUint=!1,this.index=new Uint16Array(this.indexCnt)):
(this.indexUint=!0,this.index=new Uint32Array(this.indexCnt)));this.vertices=new Float32Array(3*this.vertexCnt);this.normals=new Int8Array(2*this.vertexCnt)};WALK.MergedGeometry.prototype.addCoreAttributes=function(){this.index&&(this.addAttribute("index",new THREE.BufferAttribute(this.index,1)),this.index=null);this.addAttribute("position",new THREE.BufferAttribute(this.vertices,3));this.vertices=null;this.addAttribute("sphericalNormal",new THREE.BufferAttribute(this.normals,2));this.normals=null};
WALK.MergedGeometry.prototype.allocateUv0=function(){console.assert(!this.uvs0);this.uvs0=new Float32Array(2*this.vertexCnt)};WALK.MergedGeometry.prototype.addUv0Attribute=function(){this.addAttribute("uv",new THREE.BufferAttribute(this.uvs0,2));this.uvs0=null};WALK.MergedGeometry.prototype.allocateUv1=function(){console.assert(!this.uvs1);this.uvs1=new Uint16Array(2*this.vertexCnt)};WALK.MergedGeometry.prototype.addUv1Attribute=function(){this.addAttribute("uv2",new THREE.BufferAttribute(this.uvs1,
2));this.uvs1=null};WALK.MergedGeometry.prototype.onLoadedToGpu=function(){var a=this.attributes;a.index&&(a.index.array=null);a.position&&(a.position.array=null);a.sphericalNormal&&(a.sphericalNormal.array=null);a.uv&&(a.uv.array=null);a.uv2&&(a.uv2.array=null);a.order&&(a.order.array=null)};WALK.MergedGeometry.prototype.computeBoundingBox=void 0;WALK.MergedGeometry.prototype.computeBoundingSphere=function(){var a=new THREE.Vector3;return function(){var b,c,d,e,f;b=this.boundingSphere.center;this.boundingBox.center(b);
c=0;d=this.attributes.position.array;e=3*this.vertexOffset;for(f=e+3*this.vertexCnt;e<f;e+=3)a.set(d[e],d[e+1],d[e+2]),c=Math.max(c,b.distanceToSquared(a));this.boundingSphere.radius=Math.sqrt(c)}}();WALK.SubGeometry=function(a,b,c,d,e,f,g){THREE.BufferGeometry.call(this);this.indexCnt=a;this.vertexCnt=b;this.parent=c;this.vertexOffset=e;this.indexOffset=d;this.boundingBox=f;this.boundingSphere=g};WALK.SubGeometry.prototype=Object.create(THREE.BufferGeometry.prototype);WALK.SubGeometry.prototype.constructor=
WALK.SubGeometry;Object.defineProperty(WALK.SubGeometry.prototype,"attributes",{get:function(){return this.parent.attributes}});Object.defineProperty(WALK.SubGeometry.prototype,"attributesKeys",{get:function(){return this.parent.attributesKeys}});Object.defineProperty(WALK.SubGeometry.prototype,"indexUint",{get:function(){return this.parent.indexUint}});WALK.SubGeometry.prototype.computeBoundingBox=void 0;WALK.SubGeometry.prototype.computeBoundingSphere=void 0;WALK.SubGeometry.prototype.addTriangleOrderAttribute=
function(){this.parent.addTriangleOrderAttribute()};WALK.SubGeometry.prototype.onLoadedToGpu=function(){this.parent.onLoadedToGpu()}})();(function(){WALK.KTXLoader=function(){this._parser=WALK.KTXLoader.parse};WALK.KTXLoader.prototype=Object.create(WALK.CompressedTextureLoader.prototype);WALK.KTXLoader.parse=function(a){var b,c,d,e,f,g,h,k,m,l,n=[],p;b=new Int32Array(a,0,16);67305985===b[3]&&console.assert("Big endian machines not supported");console.assert(0===b[4]);console.assert(1===b[5]);console.assert(0===b[6]);35842===b[7]?(console.assert(6408===b[8]),c=THREE.RGBA_PVRTC_4BPPV1_Format):36196===b[7]?(console.assert(6407===b[8]),
c=THREE.RGB_ETC1_Format):33776===b[7]?(console.assert(6407===b[8]),c=THREE.RGB_S3TC_DXT1_Format):33779===b[7]?(console.assert(6408===b[8]),c=THREE.RGBA_S3TC_DXT5_Format):console.error("Unknown KTX glInternalFormat: "+b[7]);d=b[9];e=b[10];console.assert(0===(d&d-1));console.assert(0===(e&e-1));console.assert(0===b[11]);console.assert(0===b[12]);console.assert(1===b[13]);f=b[14];b=b[15];console.assert(0===b%4);g=64+b;b=new DataView(a,0);h=d;k=e;for(p=0;p<f;++p)m=b.getUint32(g,!0),g+=4,l=new Uint8Array(a,
g,m),n.push({data:l,width:h,height:k}),l=3-(m+3)%4,g+=m+l,h=Math.max(h/2,1),k=Math.max(k/2,1);console.assert(g===a.byteLength);return{format:c,width:d,height:e,mipmapCount:f,mipmaps:n}}})();(function(){function a(a,b,f,g,h){function d(a){b.image=a;b.width=a.width;b.height=a.height;g(b)}WALK.queueImageGet(a,f,c?function(a){createImageBitmap(a,{premultiplyAlpha:"none",imageOrientation:b.flipY?"flipY":"none"}).then(d)["catch"](h)}:d,h)}var b,c=!1;(function(){"createImageBitmap"in window?fetch("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==").then(function(a){return a.blob()}).then(function(a){Promise.all([createImageBitmap(a,
{imageOrientation:"none",premultiplyAlpha:"none"}),createImageBitmap(a,{imageOrientation:"flipY",premultiplyAlpha:"none"})]).then(function(){WALK.log("createImageBitmap supported");c=!0})["catch"](function(){WALK.log("createImageBitmap not fully supported")})}):WALK.log("createImageBitmap not supported")})();b=function(){var a={};this.cacheKey=function(a,b,c,d,k){return a+"@"+b+"@"+c+"@"+d+"@"+k};this.get=function(b){return a[b]};this.insert=function(b,c){a[b]=c}};WALK.TextureLoader=function(c,e,
f,g,h){function d(a){var b,d,f;b=a.id;d=a.webFormats;if(e.pvrtcTextures&&-1<d.indexOf("small/pvr"))return c+"small/pvr/"+b+".ktx";if(e.etc1Textures&&-1<d.indexOf("small/etc1"))return c+"small/etc1/"+b+".ktx";if(e.dxtTextures&&-1<d.indexOf("large/dxt"))return c+"large/dxt/"+b+".ktx";f=-1<d.indexOf("small/std");return!(-1<d.indexOf("large/std"))||e.mobile&&f?c+"small/std/"+b+"."+a.stdExt:c+"large/std/"+b+"."+a.stdExt}function m(a){a.needsUpdate=!0;a.notifyLoaded();--p.texturesToLoad;f(a)}function l(){--p.texturesToLoad;
g()}function n(a,b,c,d,e){var f=new WALK.DataTexture;WALK.queueAjaxGet(a,b,!0,function(a){a=new Uint8Array(a,0,a.byteLength);var b=a[1];f.image.width=Math.pow(2,a[0]);f.image.height=Math.pow(2,b);f.format=c;f.type=THREE.UnsignedByteType;f.image.data=a.subarray(2);d&&d(f);f=null},e);return f}var p=this,q=new b,u=new WALK.KTXLoader;h&&(q.insert=function(){});this.texturesToLoad=0;this.clearCache=function(){q=null};this.load=function(b,c,e,f,g){var h=c.alpha?THREE.RGBAFormat:THREE.RGBFormat,k=d(c),t=
/\.ktx$/.test(k),r=/\.buf$/.test(k),v=!(t||r),x,w;x=q.cacheKey(k,e,f,g,h);if(w=q.get(x))return w;p.texturesToLoad+=1;w=r?n(b,k,h,m,l):t?u.load(b,k,m,l):new WALK.Texture;w.hasAlpha=!!c.alpha;e&&(w.wrapS=THREE.RepeatWrapping,w.wrapT=THREE.RepeatWrapping);f?(w.minFilter=THREE.LinearMipMapLinearFilter,w.generateMipmaps=!t):(w.minFilter=THREE.LinearFilter,w.generateMipmaps=!1);g&&(w.anisotropy=g);v&&(w.format=h,a(b,w,k,m,l));q.insert(x,w);w.id=c.id;w.name=c.name;w.webFormats=c.webFormats;w.rawExt=c.rawExt;
w.stdExt=c.stdExt;return w}}})();(function(){WALK.MaterialLoader=function(a,b,c){function d(a,b,c){var d,e,f;for(d=0;d<b.length;d+=1)e=b[d],f=a[e],void 0!==f&&(c[e]=f)}function e(e){var f,h;f=new WALK.Material;d(e,"bumpScale doubleSided emissive emissionStrength envMapProject metallic name opacity parallaxCorrection parallaxMode parallaxScale parallaxMinLayers parallaxMaxLayers planarReflector roughness ssr".split(" "),f);e.baseColor&&f.color.fromArray(e.baseColor);if(h=e.baseColorTextureCorrection)f.mapColorCorrection=!0,void 0!==
h.contrast&&(f.mapContrast=h.contrast),f.mapHslOffset.h=h.hslOffset[0],f.mapHslOffset.s=h.hslOffset[1],f.mapHslOffset.l=h.hslOffset[2];if(h=e.baseColorTexture)f.mapName=h.name,h.atlasId?(f.setTexture("map",b[h.atlasId]),f.setMapUvOffsetAndScale(h.atlasOffset[0],h.atlasOffset[1],h.atlasScale[0],h.atlasScale[1])):f.setTexture("map",a.load(WALK.LOAD_PRIORITY.DIFFUSE,h,!0,!0,WALK.DEFAULT_ANISOTROPY));e.roughnessTexture&&c.cubeMaps&&f.setTexture("roughnessMap",a.load(WALK.LOAD_PRIORITY.SPECULARITY,e.roughnessTexture,
!0,!0,WALK.DEFAULT_ANISOTROPY));e.metallicTexture&&c.cubeMaps&&f.setTexture("metallicMap",a.load(WALK.LOAD_PRIORITY.SPECULARITY,e.metallicTexture,!0,!0,WALK.DEFAULT_ANISOTROPY));e.bumpTexture&&c.cubeMaps&&c.standardDerivatives&&f.setTexture("bumpMap",a.load(WALK.LOAD_PRIORITY.SPECULARITY,e.bumpTexture,!0,!0,WALK.DEFAULT_ANISOTROPY));e.doNotImport&&(h=["baseColor","baseColorTexture","opacity"],d(e.doNotImport,h,f.doNotImport));f.setUniforms();return f}this.load=function(a,b){var c;for(c=0;c<a.length;c+=
1)b.addMaterial(e(a[c]))}}})();(function(){WALK.SkyLoader=function(a){function b(a,b,c){var d;d=new THREE.SphereBufferGeometry(1,32,16);a=new WALK.SkyMesh(a,d,b);a.position.fromArray(c||[0,0,0]);return a}function c(a){var c;c=new WALK.ProceduralSkyMaterial;return b(a.name,c,a.center)}this.loadSkyTexture=function(b,c){b.material.map&&b.material.map.dispose();b.material.map=a.load(WALK.LOAD_PRIORITY.SKY,c,!1,!1,WALK.NO_ANISOTROPY);b.yawRotationDeg=0};this.loadSingleSky=function(d,e){var f;"procedural"===d.type||void 0===d.type?f=
c(d):"equirect"===d.type?(f=new WALK.EquirectSkyMaterial,f.map=a.load(WALK.LOAD_PRIORITY.SKY,d.texture,!1,!1,WALK.NO_ANISOTROPY),f=b(d.name,f,d.center),f.geometry.applyMatrix((new THREE.Matrix4).makeScale(1,1,-1)),f.rotation.x=Math.PI/2,f.yawRotationDeg=d.yawRotation||0):(console.warn("Unknown sky type: ",d.type),f=c(d));e.addSkyMesh(f)};this.load=function(a,b){var c;this.loadSingleSky({name:WALK.DEFAULT_SKY_NAME,type:"procedural"},b);for(c=0;c<a.length;c+=1)this.loadSingleSky(a[c],b)}}})();(function(){WALK.LightmapLoader=function(a,b){function c(){--e;if(0===e)d.onComplete()}var d=this,e=b;this.lightmaps=[];this.onComplete=null;this.load=function(){var d,e,h={id:null,name:null,stdExt:"png",webFormats:["large/std"],alpha:!0};for(d=0;d<b;d+=1)h.id=h.name="lightmap-rgbm"+d,e=a.load(WALK.LOAD_PRIORITY.LIGHTMAP,h,!1,!1,WALK.NO_ANISOTROPY),e.addLoadedListener(c),this.lightmaps.push(e)}}})();(function(){WALK.TextureAtlasLoader=function(a){this.atlases={};this.load=function(b){var c,d;for(c=0;c<b.length;c+=1)d=a.load(WALK.LOAD_PRIORITY.DIFFUSE,b[c],!1,!0,WALK.DEFAULT_ANISOTROPY),d.flipY=!1,this.atlases[b[c].id]=d}}})();(function(){WALK.BufferLoader=function(a,b){var c={};this.onHaveBuffer=this.onFailure=this.onProgress=null;this._buffersDone={};this.buffers={meshes:null,transforms:null,bounds:null,faces16:null,faces:null,vertices:null,normals:null,uvs0:null,uvs1:null};this.haveAllBuffers=function(){for(var a in this.buffers)if(this.buffers.hasOwnProperty(a)&&null===this.buffers[a])return!1;return!0};this.haveCoreBuffers=function(){var a=this.buffers;return a.faces16&&a.faces&&a.vertices&&a.normals&&a.transforms};
this.releaseCoreBuffers=function(){var a=this.buffers;a.faces16=a.faces=a.vertices=a.normals=null};this.load=function(){function d(a){return function(b){f.buffers[a]=b;f.onHaveBuffer()}}function e(a){return function(b){c[a]=b.loaded;f.onProgress()}}var f=this,g=WALK.LOAD_PRIORITY.CORE_RESOURCE,h={meshes:g,transforms:g,bounds:g,faces16:g,faces:g,vertices:g,normals:g,uvs0:b?g:WALK.LOAD_PRIORITY.UV0,uvs1:b?g:WALK.LOAD_PRIORITY.LIGHTMAP};(function(){var b,c;for(b in f.buffers)f.buffers.hasOwnProperty(b)&&
(c=h[b],console.assert(void 0!==c),WALK.queueAjaxGet(c,a+b+".buf",!0,d(b),f.onFailure,e(b)))})()};this.totalDone=function(){var a=0,b;for(b in c)c.hasOwnProperty(b)&&(a+=c[b]);return a}}})();(function(){var a=new THREE.Box3;WALK.MeshMaker=function(b,c,d,e){var f=this,g,h={},k={},m;g=c.byteLength;m=new Float32Array(d);this.mergedMeshes=[];this.logicalMeshes=[];this.sharedBuffers={};this.lightmapCount=this.indexedGeometryGpuSize=this.geometryDownloadSize=this.coreGeometryDownloadSize=0;this.lightmaps=null;(function(){var a,b,d=2,e,g=0,h,m,v;a=new Int32Array(c);b=new Float32Array(c);e=a[0];1==e&&(g=2);for(h=a[1];d<a.length;){m=a[d];v={materialIdx:a[d+1],useFaces16:1===a[d+2],faceByteOffset:a[d+
3],faceCnt:a[d+4],vertexByteOffset:a[d+5],vertexCnt:a[d+6],normalByteOffset:a[d+7],uv0ByteOffset:a[d+8],uv1ByteOffset:a[d+9],lightMapIdx:a[d+10],uv1CoordUScale:1,uv1CoordVScale:1,uv1CoordUOffset:a[d+g+11],uv1CoordVOffset:a[d+g+12],transformByteOffset:a[d+g+13],boundsByteOffset:a[d+g+14],quantVertexRange:b[d+g+15],quantVertexMax:a[d+g+16],quantUv0Range:b[d+g+17],quantUv0Max:a[d+g+18]};1==e&&(v.uv1CoordUScale=b[d+11],v.uv1CoordVScale=b[d+12]);f.lightmapCount=Math.max(f.lightmapCount,v.lightMapIdx+1);
var x=f.indexedGeometryGpuSize,w=v,E,C;E=3*w.faceCnt*(w.useFaces16?2:4);C=3*WALK.Math.minBytesToHold(w.quantVertexMax);C+=2;-1!==w.uv0ByteOffset&&(C+=8);-1!==w.uv1ByteOffset&&(C+=4);f.indexedGeometryGpuSize=x+(E+C*w.vertexCnt);k[m]=v;d+=h}c=null})();(function(){var a,b,c,d=0,e=0,h=0,m=0,v=0,x=0,w=0;for(a in k)b=k[a],c=b.vertexCnt,d=Math.max(d,b.faceByteOffset+3*b.faceCnt*(b.useFaces16?2:4)),e=Math.max(e,b.vertexByteOffset+3*c*WALK.Math.minBytesToHold(b.quantVertexMax)+3&-4),h=Math.max(h,b.normalByteOffset+
2*c),m=Math.max(m,b.transformByteOffset+64),v=Math.max(v,b.boundsByteOffset+28),-1!==b.uv0ByteOffset&&(x=Math.max(x,b.uv0ByteOffset+2*c*WALK.Math.minBytesToHold(b.quantVertexMax)+3&-4)),-1!==b.uv1ByteOffset&&(w=Math.max(w,b.uv1ByteOffset+4*c));f.coreGeometryDownloadSize=g+d+e+h+m+v;f.geometryDownloadSize+=f.coreGeometryDownloadSize+x+w})();this.createMesh=function(c){var d,g,l,u,r,t,v,x,w,E;w=k[c.id];E=new THREE.Box3;t=new THREE.Sphere;g=w.boundsByteOffset/4;E.max.x=m[g];E.max.y=m[g+1];E.max.z=m[g+
2];E.min.x=m[g+3];E.min.y=m[g+4];E.min.z=m[g+5];E.center(t.center);t.radius=m[g+6];d=b.materials[w.materialIdx];g=null!==c.initialLightProbeId&&void 0!==c.initialLightProbeId?b.findLightProbe(c.initialLightProbeId):null;l=-1===w.lightMapIdx?null:this.lightmaps[w.lightMapIdx];a:{u=(u=c.hideInViews)||[];u=u.sort();r=h[d.name]||[];for(v=0;v<r.length;v+=1){x=r[v];var C;if(C=x.lightProbe===g&&(null===x.lightMap||null===l||x.lightMap===l))b:{C=x.hideInViews;var y;if(C.length!==u.length)C=!1;else{for(y=
0;y<C.length;y+=1)if(C[y]!==u[y]){C=!1;break b}C=!0}}C&&!(C=!d.transparent)&&(C=x,a.copy(E),a.expandByScalar(.3),a.intersect(C.geometry.boundingBox),C=!a.empty());if(C){null!==l&&(x.lightMap=l);u=x;break a}}v=new WALK.MergedMesh(new WALK.MergedGeometry,d);v.lightProbe=g;null!==l&&(v.lightMap=l);v.hideInViews=u;h[d.name]=r.concat(v);f.mergedMeshes.push(v);u=v}u.anyLogicalMeshHasUvs=u.anyLogicalMeshHasUvs||-1!==w.uv0ByteOffset;r=u.geometry;e?(v=3*w.faceCnt,x=w.vertexCnt):(v=0,x=3*w.faceCnt);t=new WALK.SubGeometry(v,
x,r,r.indexCnt,r.vertexCnt,E,t);r.boundingBox.union(E);r.indexCnt+=v;r.vertexCnt+=x;c=new WALK.Mesh(c,t,d);c.lightMap=l;c.lightProbe=g;c.useFaces16=w.useFaces16;c.faceByteOffset=w.faceByteOffset;c.faceCnt=w.faceCnt;c.vertexByteOffset=w.vertexByteOffset;c.vertexCnt=w.vertexCnt;c.normalByteOffset=w.normalByteOffset;c.uv0ByteOffset=w.uv0ByteOffset;c.uv1ByteOffset=w.uv1ByteOffset;c.lightMapIdx=w.lightMapIdx;c.uv1CoordUScale=w.uv1CoordUScale;c.uv1CoordVScale=w.uv1CoordVScale;c.uv1CoordUOffset=w.uv1CoordUOffset;
c.uv1CoordVOffset=w.uv1CoordVOffset;c.transformByteOffset=w.transformByteOffset;c.quantVertexRange=w.quantVertexRange;c.quantVertexMax=w.quantVertexMax;c.quantUv0Range=w.quantUv0Range;c.quantUv0Max=w.quantUv0Max;f.sharedBuffers[w.vertexByteOffset]?(c.sharedBuffersDebug=2,f.sharedBuffers[w.vertexByteOffset].sharedBuffersDebug=1):f.sharedBuffers[w.vertexByteOffset]=c;f.logicalMeshes.push(c);u.logicalMeshes.push(c);return c}}})();(function(){function a(a,b,c,d,e,f,g){var h,k,l,m;h=0;for(c*=3;h<c;h+=3)k=a[h+b]*e,l=a[h+b+1]*e,m=a[h+b+2]*e,f[g+h]=d[0]*k+d[1]*l+d[2]*m+d[3],f[g+h+1]=d[4]*k+d[5]*l+d[6]*m+d[7],f[g+h+2]=d[8]*k+d[9]*l+d[10]*m+d[11]}function b(a,b,c,d,e,f){var g,h,k,l,m,n;g=0;for(c*=2;g<c;g+=2)h=(a[g+b]/254+.5)*Math.PI,k=Math.PI/127*a[g+b+1],l=Math.sin(h),m=l*Math.cos(k),n=l*Math.sin(k),h=Math.cos(h),k=d[0]*m+d[1]*n+d[2]*h,l=d[4]*m+d[5]*n+d[6]*h,m=d[8]*m+d[9]*n+d[10]*h,h=2*(Math.acos(m)/Math.PI-.5),k=Math.atan2(l,k)/
Math.PI,e[f+g]=WALK.Math.toSnorm8(h),e[f+g+1]=WALK.Math.toSnorm8(k)}function c(a,b,c,d,e,f,g,h,t){var k,l,m;k=0;for(c*=2;k<c;k+=2)l=a[k+b],m=a[k+b+1],0!==l||0!==m?(h[t+k]=Math.round(l*d)+f,h[t+k+1]=Math.round(m*e)+g):(h[t+k]=0,h[t+k+1]=0)}function d(a,b,c,d,e){function f(){for(var h,m;g<a.length;)if(h=a[g],0!==k||b(h)){for(;k<h.logicalMeshes.length;)if(m=h.logicalMeshes[k],c(m),k+=1,l.shouldInterrupt(m.vertexCnt)){setTimeout(f,0);return}d(h);g+=1;k=0}else g+=1;e()}var g=0,k=0,l=new h(1E4);f()}function e(a,
b){b.geometry.allocateCoreBuffers(a);return!0}function f(a,b){var c;c=b.material;return(a?b.anyLogicalMeshHasUvs:b.anyLogicalMeshHasUvs&&(c.map||c.bumpMap||c.roughnessMap||c.metallicMap))?(b.geometry.allocateUv0(),!0):!1}function g(a){return a.lightMap?(a.geometry.allocateUv1(),!0):!1}var h;h=function(a){this.minVerticesUntilTimeCall=a;this.verticesCount=0;this.timer=new WALK.Timer};h.prototype.shouldInterrupt=function(a){this.verticesCount+=a;return this.verticesCount>this.minVerticesUntilTimeCall&&
10<this.timer.elapsedMSec()?(this.verticesCount=0,this.timer.reset(),!0):!1};WALK.asyncFillIndexedUv0=function(a,b,c,e,g){var h=new Uint16Array(a),k=new Float32Array(a);d(b,f.bind(null,c),function(a){var b=a.geometry,c=b.parent,d=b.vertexOffset;if(a.uv0InBuffers())if(a.quantUv0Disabled()){var b=a.uv0ByteOffset/4,e=c.uvs0,d=2*d,c=0;for(a=2*a.vertexCnt;c<a;c+=1)e[d+c]=k[c+b]}else{var b=a.uv0ByteOffset/2,e=a.quantUv0Factor(),c=c.uvs0,d=2*d,f;f=0;for(a=2*a.vertexCnt;f<a;f+=1)c[d+f]=h[f+b]*e}},e,g)};WALK.asyncFillIndexedUv1=
function(a,b,e,f){var h=new Uint16Array(a);d(b,g,function(a){var b=a.geometry,d=b.parent,b=b.vertexOffset;a.uv1InBuffers()&&c(h,a.uv1ByteOffset/2,a.vertexCnt,a.uv1CoordUScale,a.uv1CoordVScale,a.uv1CoordUOffset,a.uv1CoordVOffset,d.uvs1,2*b)},e,f)};WALK.asyncFillIndexedCoreGeometry=function(c,f,g,h){var k=c.faces16?new Uint16Array(c.faces16):null,l=c.faces?new Uint32Array(c.faces):null,m=new Int8Array(c.vertices),n=new Int16Array(c.vertices),t=new Int32Array(c.vertices),v=new Int8Array(c.normals);d(f,
e.bind(null,!0),function(d){var e,f,g,h,q,p;e=d.geometry;f=e.parent;q=e.vertexOffset;p=new Float32Array(c.transforms,d.transformByteOffset,16);switch(WALK.Math.minBytesToHold(d.quantVertexMax)){case 1:g=m;h=d.vertexByteOffset;break;case 2:g=n;h=d.vertexByteOffset/2;break;case 4:g=t,h=d.vertexByteOffset/4}a(g,h,d.vertexCnt,p,d.quantVertexFactor(),f.vertices,3*q);b(v,d.normalByteOffset,d.vertexCnt,p,f.normals,2*q);f=f.index;g=e.indexOffset;d.useFaces16?(h=d.faceByteOffset/2,e=k):(h=d.faceByteOffset/
4,e=l);for(d=h+3*d.faceCnt;h<d;h+=1,g+=1)f[g]=e[h]+q},g,h)};WALK.asyncFillNotIndexedGeometry=function(h,m,l,n,p){var k=h.faces16?new Uint16Array(h.faces16):null,u=h.faces?new Uint32Array(h.faces):null,r=new Int8Array(h.vertices),t=new Int16Array(h.vertices),v=new Int32Array(h.vertices),x=new Int8Array(h.normals),w=new Uint16Array(h.uvs0),E=new Float32Array(h.uvs0),C=h.uvs1?new Uint16Array(h.uvs1):null;d(m,function(a){e(!1,a);f(l,a);g(a);return!0},function(d){var e,f,g,l,m,n,q,p,y,P,F,H,I,A,K=null,
X=null,Q,S,Z,Y,V,W,aa,T;n=d.geometry.parent;I=n.vertices;A=n.normals;d.useFaces16?(e=d.faceByteOffset/2,m=k):(e=d.faceByteOffset/4,m=u);q=e+3*d.faceCnt;y=d.normalByteOffset;F=d.uv1ByteOffset/2;switch(WALK.Math.minBytesToHold(d.quantVertexMax)){case 1:H=r;p=d.vertexByteOffset;break;case 2:H=t;p=d.vertexByteOffset/2;break;case 4:H=v,p=d.vertexByteOffset/4}d.uv0InBuffers()&&n.uvs0&&(K=n.uvs0);d.uv1InBuffers()&&n.uvs1&&(X=n.uvs1);Q=3*d.geometry.vertexOffset;S=2*d.geometry.vertexOffset;n=new Float32Array(h.transforms,
d.transformByteOffset,16);Z=d.quantVertexFactor();(Y=d.quantUv0Disabled())?P=d.uv0ByteOffset/4:(V=d.quantUv0Factor(),P=d.uv0ByteOffset/2);W=d.uv1CoordUScale;aa=d.uv1CoordVScale;T=d.uv1CoordUOffset;for(d=d.uv1CoordVOffset;e<q;e+=1,Q+=3,S+=2){f=m[e];g=p+3*f;a(H,g,1,n,Z,I,Q);g=y+2*f;b(x,g,1,n,A,S);if(K)if(l=P+2*f,Y){g=E;var U=K,R=S,ba;for(ba=0;2>ba;ba+=1)U[R+ba]=g[ba+l]}else{g=w;U=V;R=K;ba=S;var ca;for(ca=0;2>ca;ca+=1)R[ba+ca]=g[ca+l]*U}X&&(f=F+2*f,c(C,f,1,W,aa,T,d,X,S))}},n,p)}})();(function(){function a(a,b){a.forEach(function(a){b.addView(new WALK.View(a))})}function b(a,b){a.forEach(function(a){b.addNodeConfig(new WALK.NodeConfig(a))})}function c(a,b){a.forEach(function(a){var c=new WALK.Light(a);a=a.instances;var d,e;for(d=0;d<a.length;d+=1)e=a[d],c.addInstance(e.position,e.rotation);b.addLight(c)})}function d(a,b){a.forEach(function(a){b.addLightProbe(new WALK.LightProbe(a))})}function e(a,b,c){a&&(c.camera.fov=a.fov,a.exposure&&(c.cameraExposure=a.exposure),a.gamma&&(c.cameraGamma=
a.gamma),a.lutTexture&&(b=b.load(WALK.LOAD_PRIORITY.COLORMAP,a.lutTexture,!1,!1,WALK.NO_ANISOTROPY),b.flipY=!1,c.colorMap=b),!0===a.autoClimb&&(c.camera.autoClimb=!0),a.moveMaxSpeed&&(c.camera.moveMaxSpeed=a.moveMaxSpeed),c.camera.updateProjectionMatrix())}function f(a,b,c){function d(a,e){var f,g;f=c.findNodeConfig(e.config);g=new WALK.Node(a,f,e);!0===e.mesh&&(g.mesh=b.createMesh(g));void 0!==e.children&&(g.children=e.children.map(function(a){return d(g,a)}));return g}a.forEach(function(a){c.addNode(d(null,
a))});WALK.log("Have "+b.logicalMeshes.length+" meshes and "+b.mergedMeshes.length+" merged meshes.")}function g(){WALK.USER_MSG.error("Scene failed to load. Reload the page to retry.")}WALK.SceneLoader=function(h,k,m){var l=!m&&k.indexUint,n=!m&&!k.debugSharedBuffers,p=new WALK.Timer;this.onComplete=this.onReadyToDisplay=this.onTextureLoaded=this.onMeshBuffersLoaded=this.onProgress=null;this.load=function(){function q(){if(void 0!==S.total)D.onProgress(S)}function u(){P||(P=!0,D.onReadyToDisplay(Q))}
function r(a){0===a.name.indexOf("lightmap-rgbm")?S.texturesDone+=12582912:S.texturesDone+=524288;q();D.onTextureLoaded(a);A()}function t(){0===J.texturesToLoad&&H&&(J.clearCache(),J=z=B=null,u(),D.onComplete(Q))}function v(){I&&F&&O&&(A=t,X&&Q.gpuMeshes.forEach(function(a){var b=a.material;null===a.lightMap&&(a.lightMap=B.lightmaps[0]);b.lightMapped||(b.lightMapped=!0,b.setUniforms())}),A())}function x(a){a.geometry.addUv1Attribute();D.onMeshBuffersLoaded(a)}function w(){z.buffers.uvs1&&(A=v,WALK.asyncFillIndexedUv1(z.buffers.uvs1,
B.mergedMeshes,x,function(){z.buffers.uvs1=null;I=!0;A()}))}function E(a){a.geometry.addUv0Attribute();D.onMeshBuffersLoaded(a)}function C(){z.buffers.uvs0&&(A=w,WALK.asyncFillIndexedUv0(z.buffers.uvs0,B.mergedMeshes,m,E,function(){z.buffers.uvs0=null;H=!0;A()}))}function y(a){Q.addGpuMesh(a)}function G(){O=!0;if(0===Q.views.length){var a=Q,b=[0,0,0];a.boundingBox.empty()||(b=a.boundingBox.center().toArray());a.addView(new WALK.View({id:0,name:"Start place",hideFromMenu:!0,position:b,rotation:[0,
0],internal:!0,sky:WALK.EDITOR_CONTROLLED_SKY_NAME}))}m||Q.disableProgressiveLoader||(a=1E3*WALK.PROGRESSIVE_LOADER_AFTER_SEC-p.elapsedMSec(),0>=a?u():setTimeout(u,a));A()}function L(a){a.geometry.addCoreAttributes();n?(a.geometry.computeBoundingSphere(),y(a)):a.logicalMeshes.forEach(y);D.onMeshBuffersLoaded(a)}function M(a){a.geometry.uvs0&&a.geometry.addUv0Attribute();a.geometry.uvs1&&a.geometry.addUv1Attribute();L(a)}function N(){if(l){if(!z.haveCoreBuffers())return;WALK.log("Using indexed geometry");
A=C;WALK.asyncFillIndexedCoreGeometry(z.buffers,B.mergedMeshes,L,G)}else{if(!z.haveAllBuffers())return;A=v;WALK.asyncFillNotIndexedGeometry(z.buffers,B.mergedMeshes,m,M,function(){I=H=!0;G()})}z.releaseCoreBuffers()}var D=this,J=null,z=null,B=null,O=!1,P=!1,F=!1,H=!1,I=!1,A,K=null,X=!1,Q=null,S={total:void 0,texturesDone:0,totalDone:function(){return this.texturesDone+z.totalDone()}};p.reset();A=function(){var m;K&&z.buffers.meshes&&z.buffers.bounds&&(A=N,Q=new WALK.Scene,Q.disableProgressiveLoader=
K.disableProgressiveLoader||!1,void 0!==K.autoTour&&(Q.autoTour.disabled=K.autoTour.disabled||!1,Q.autoTour.startOnLoad=K.autoTour.startOnLoad||!1),c(K.lights,Q),d(K.lightProbes||[],Q),J=new WALK.TextureLoader(h+"img/",k,r,g,!1),e(K.camera,J,Q),m=new WALK.TextureAtlasLoader(J),m.load(K.atlases||[]),(new WALK.MaterialLoader(J,m.atlases,k)).load(K.materials||[],Q),(new WALK.SkyLoader(J)).load(K.skies||[],Q),null===Q.findSkyMesh(WALK.EDITOR_CONTROLLED_SKY_NAME)&&console.error("A sky with name "+WALK.EDITOR_CONTROLLED_SKY_NAME+
" is missing."),a(K.views||[],Q),K.hideViewsMenu&&(Q.hideViewsMenu=!0),K.triggers&&(Q.triggers=K.triggers),B=new WALK.MeshMaker(Q,z.buffers.meshes,z.buffers.bounds,l),0!==B.lightmapCount?(X=!0,m=new WALK.LightmapLoader(J,B.lightmapCount),m.onComplete=function(){F=!0;A()},m.load(),B.lightmaps=m.lightmaps,m=null):F=!0,Q.gpuIndexedBuffersSize=B.indexedGeometryGpuSize,S.total=B.geometryDownloadSize+524288*(J.texturesToLoad-B.lightmapCount)+12582912*B.lightmapCount,b(K.nodeConfigs,Q),f(K.nodes,B,Q),K=
null,A())};WALK.queueAjaxGet(WALK.LOAD_PRIORITY.CORE_RESOURCE,"scene.json",!1,function(a){K=a;A()},g);z=new WALK.BufferLoader(h,!l);z.onProgress=q;z.onFailure=g;z.onHaveBuffer=function(){A()};z.load()};this.elapsedLoadTimeSec=function(){return p.elapsedSec()}}})();(function(){function a(a){return a?{id:a.id,name:a.name,rawExt:a.rawExt,stdExt:a.stdExt,webFormats:a.webFormats,alpha:a.hasAlpha}:null}function b(b){return{fov:b.camera.fov,exposure:b.cameraExposure,gamma:b.cameraGamma,lutTexture:a(b.colorMap),autoClimb:b.camera.autoClimb,moveMaxSpeed:b.camera.moveMaxSpeed}}function c(a){return!a||a.fromEditor}function d(b){var d=null;b.mapColorCorrection&&(d={contrast:b.mapContrast,hslOffset:[b.mapHslOffset.h,b.mapHslOffset.s,b.mapHslOffset.l]});d={name:b.name,baseColor:b.color.toArray(),
baseColorTextureCorrection:d,opacity:b.opacity,emissive:b.emissive,emissionStrength:b.emissionStrength,roughness:b.roughness,metallic:b.metallic,envMapProject:b.envMapProject,bumpScale:b.bumpScale,doubleSided:b.doubleSided,doNotImport:b.doNotImport};c(b.map)&&(d.baseColorTexture=a(b.map));c(b.roughnessMap)&&(d.roughnessTexture=a(b.roughnessMap));c(b.metallicMap)&&(d.metallicTexture=a(b.metallicMap));c(b.bumpMap)&&(d.bumpTexture=a(b.bumpMap));return d}function e(a,b,c){b.forEach(function(b){void 0!==
a[b]&&(c[b]=a[b])})}function f(a){var b={name:a.name,disableCollisions:a.setsDisableCollisions?a.disableCollisions:null,hideInViews:a.setsHideInViews?a.hideInViews:null,triggers:a.setsTriggers?a.triggers:null,lightmapResolution:a.setsLightmapResolution?a.lightmapResolution:null};null!==a.ground&&(b.ground=a.ground);return b}function g(a){var b;b={id:a.id,children:a.children.map(g)};if(a=a.mesh)b.lightProbeId=a.lightProbe?a.lightProbe.id:null,b.mesh=!0;return b}function h(a){var b=a.name,c=a.type,
d=a.angle,e=a.strength,f=a.size,g=a.color.toArray(),h=a.doNotImport;a=a.instances;var k=[],l,m;for(l=0;l<a.length;l+=1)m=a[l],k.push({position:m.position.toArray(),rotation:m.rotation.toDegTriple()});return{name:b,type:c,angle:d,strength:e,size:f,color:g,doNotImport:h,instances:k}}function k(a){var b={id:a.id,position:a.position.toArray()};a.hasBoundingBox()&&(b.box={min:a.boxMin.toArray(),max:a.boxMax.toArray()});return b}function m(a){var b;b={id:a.id,name:a.name,mode:a.mode,rotation:a.rotation.toDegTriple().slice(0,
2),hideFromMenu:a.hideFromMenu||!1,sky:a.sky};a.position&&(b.position=a.position.toArray());a.target&&(b.target=a.target.toArray());e(a,"distance minDistance maxDistance panPrimary noRotate noPitchRotate".split(" "),b);return b}function l(a){return{id:a.id,viewId:a.viewId}}function n(b){var c={name:b.name,center:b.position.toArray()},d;d=b.material;b.isEquirect?(c.type="equirect",c.yawRotation=b.yawRotationDeg,c.texture=a(d.map)):c.type="procedural";return c}function p(a){return{disableProgressiveLoader:a.disableProgressiveLoader,
autoTour:a.autoTour,camera:b(a),materials:a.materials.map(d),nodeConfigs:a.nodeConfigs.map(f),nodes:a.nodes.map(g),lights:a.lights.map(h),lightProbes:a.lightProbes.map(k),views:a.views.filter(function(a){return!a.internal}).map(m),skies:a.skyMeshes.filter(function(a){return a.name!==WALK.DEFAULT_SKY_NAME}).map(n),triggers:a.triggers.map(l)}}WALK.sceneToJson=function(a){return p(a)}})();(function(){function a(a,d,e,f){var c,h=[],k;for(k=0;6>k;k+=1)c=f?new THREE.OrthographicCamera(-1,1,1,-1,a,d):new THREE.PerspectiveCamera(90,1,a,d),e.add(c),h.push(c);h[0].up.set(0,-1,0);b.set(1,0,0);h[0].lookAt(b);h[1].up.set(0,-1,0);b.set(-1,0,0);h[1].lookAt(b);h[2].up.set(0,0,1);b.set(0,1,0);h[2].lookAt(b);h[3].up.set(0,0,-1);b.set(0,-1,0);h[3].lookAt(b);h[4].up.set(0,-1,0);b.set(0,0,1);h[4].lookAt(b);h[5].up.set(0,-1,0);b.set(0,0,-1);h[5].lookAt(b);return h}var b=new THREE.Vector3;WALK.CubeCamera=
function(b,d){THREE.Object3D.call(this);this.sideCameras=a(b,d,this,!1)};WALK.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);WALK.CubeCamera.prototype.constructor=WALK.CubeCamera;WALK.OrthoCubeCamera=function(b,d){THREE.Object3D.call(this);this.sideCameras=a(b,d,this,!0)};WALK.OrthoCubeCamera.prototype=Object.create(THREE.Object3D.prototype);WALK.OrthoCubeCamera.prototype.constructor=WALK.OrthoCubeCamera})();(function(){WALK.CubeMapFilterShader={uniforms:{gloss:{type:"f",value:.9},face:{type:"f",value:0},mipSize:{type:"f",value:128},envMap:{type:"t",value:null}},vertexShader:WALK.getShader("cubemap_filter_vertex.glsl"),fragmentShader:WALK.getShader("cubemap_filter_fragment.glsl")}})();(function(){function a(a,b){var c=b.target;a.deleteTexture(c.image.__webglTextureCube);delete c.image.__webglTextureCube;c.image=null}function b(a,b,c){for(var d=!0,e;d;){a.readPixels(0,0,b,b,a.RGBA,a.UNSIGNED_BYTE,c);for(e=0;e<b*b*4;e+=4)if(0!==c[e]||0!==c[e+1]||0!==c[e+2]){d=!1;break}if(d){console.warn("Cube face has all pixels black.");break}}}function c(a){a.traverse(function(a){if(a instanceof THREE.Mesh){if(a.userData.hideFromLightProbes||a.material instanceof WALK.MirrorMaterial||a.material.transparent)a.userData.__visibilityToRestore=
a.visible,a.visible=!1;void 0!==a.material.hdrOutput&&(a.material.hdrOutput=!0);void 0!==a.material.specularOff&&(a.material.specularOff=!0)}})}function d(a){a.traverse(function(a){a instanceof THREE.Mesh&&(void 0!==a.userData.__visibilityToRestore&&(a.visible=a.userData.__visibilityToRestore),void 0!==a.material.hdrOutput&&(a.material.hdrOutput=!1),void 0!==a.material.specularOff&&(a.material.specularOff=!1))})}function e(a,b){var c,d;d={format:THREE.RGBAFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter,
stencilBuffer:!1};this.renderer=a;this.scene=b;this.threeScene=b.threeScene;this.aabbQueryMaterial=new WALK.AabbQueryMaterial;this.filterPass=new THREE.ShaderPass(WALK.CubeMapFilterShader,"envMap");c=WALK.LIGHT_PROBE_MAX_MIP_SIZE;this.pixelBuf=new Uint8Array(c*c*4);this.targetCubeRaw=new THREE.WebGLRenderTargetCube(c,c,d);this.targetCubeRaw.generateMipmaps=!1;this.targetFiltered=new THREE.WebGLRenderTarget(c,c,d);this.targetFiltered.generateMipmaps=!1;this.targetFiltered.depthBuffer=!1;this.autoClearAlter=
new WALK.AutoClearAlter(a);this.dispose=function(){this.targetCubeRaw.dispose();this.targetFiltered.dispose();this.aabbQueryMaterial.dispose();this.filterPass.material.dispose();this.pixelBuf=null}}function f(a,b){var c=b.geometry.boundingSphere.center;if(null===b.lightProbe||c.distanceTo(a.position)<c.distanceTo(b.lightProbe.position))b.lightProbe=a}function g(a,b){var c;for(c=0;c<b.length;c+=1)f(a,b[c])}function h(a,b){var c,d;WALK.log("No visible light probe found for "+b.length+" objects. Assigning the closest ones.");
for(c=0;c<b.length;c+=1)for(d=0;d<a.length;d+=1)f(a[d],b[c])}var k,m;k=function(){var a=null;return function(b,c){var d,e,f,g=null,h=0;console.assert(c*c<Math.pow(2,16));null===a&&(a=new Uint16Array(65536));for(d=0;d<c*c*4;d+=4)if(e=b[d],f=b[d+1],0!==e||0!==f)a[256*e+f]+=1;for(d=0;d<a.length;d+=1)a[d]>h&&(h=a[d],g=Math.floor(d/256)+d%256/255),a[d]=0;return g}}();m=function(){var a=null;return function(c,d,e,f){var g,h,m,l,n,p,u=null;m=c.renderer;l=c.aabbQueryMaterial;n=c.pixelBuf;p=c.targetCubeRaw;
if(e&&f.hasBoundingBox()){u=c.scene;h=[];for(e=0;e<u.gpuMeshes.length;e+=1)g=u.gpuMeshes[e],g.material.transparent||h.push(g);u=h;null===a&&(a=new WALK.OrthoCubeCamera(d.sideCameras[0].near,255));a.position.copy(d.position);a.updateMatrixWorld()}for(e=0;6>e;e+=1){p.activeCubeFace=e;g=d.sideCameras[e];if(null!==u){l.axis=Math.floor(e/2);m.renderMeshesWithMaterial(u,l,a.sideCameras[e],p);b(m.context,p.width,n);h=k(n,p.width);if(null===h){console.warn("failed to find light probe bound");f.boxMin=f.boxMax=
null;break}switch(e){case 0:f.boxMax.x=d.position.x+h;break;case 1:f.boxMin.x=d.position.x-h;break;case 2:f.boxMax.y=d.position.y+h;break;case 3:f.boxMin.y=d.position.y-h;break;case 4:f.boxMax.z=d.position.z+h;break;case 5:f.boxMin.z=d.position.z-h}}m.render(c.threeScene,g,p)}f.hasBoundingBox()&&WALK.log("Light probe bounds: X["+f.boxMin.x.toFixed(2)+":"+f.boxMax.x.toFixed(2)+"] Y["+f.boxMin.y.toFixed(2)+":"+f.boxMax.y.toFixed(2)+"] Z["+f.boxMin.z.toFixed(2)+":"+f.boxMax.z.toFixed(2)+"]")}}();e.prototype.constructor=
e;WALK.LightProbeMaker=function(f,k,p,q){function l(c,d){var e;x.position.copy(c.position);x.updateMatrixWorld();var g;if((g=p)&&!(g=q))a:{g=f.gpuMeshes;var h,k;for(h=0;h<g.length;h+=1)if(k=g[h],k.lightProbe===c&&k.material.envMapMirror){g=!0;break a}g=!1}(e=g)&&WALK.log("Mirror texture needed for the light probe.");v.reset();g=n;k=x;var l,u;h=g.renderer;g.autoClearAlter.set(!0,!0,!1);if(e){var t;u=g.renderer;e=WALK.LIGHT_PROBE_MIRROR_SIZE;e=new THREE.WebGLRenderTargetCube(e,e,{format:THREE.RGBAFormat,
magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter,stencilBuffer:!1});for(t=0;6>t;t+=1)e.activeCubeFace=t,u.render(g.threeScene,k.sideCameras[t],e);u=u.context;var r;t=new WALK.CubeTexture;t.minFilter=THREE.LinearFilter;t.generateMipmaps=!1;t.needsUpdate=!1;t.addEventListener("dispose",a.bind(void 0,u));t.image=Array(6);t.image.__webglTextureCube=e.__webglTexture;delete e.__webglTexture;for(r=0;6>r;r+=1)u.deleteFramebuffer(e.__webglFramebuffer[r]),u.deleteRenderbuffer(e.__webglRenderbuffer[r]);
delete e.__webglFramebuffer;delete e.__webglRenderbuffer;e.dispose();c.setMirrorTexture(t)}m(g,k,d,c);g.autoClearAlter.restore();u=[.95,.9,.85,.7,.4,.25];h.enableScissorTest(!0);g.autoClearAlter.set(!1,!1,!1);e=h.createCubeTextureWithMips(g.targetFiltered.width);for(k=0;k<c.filteredMipsCount;k+=1){t=k;l=Math.pow(2,WALK.log2(g.targetFiltered.width)-t);h.setScissor(0,0,l,l);g.filterPass.uniforms.mipSize.value=l;g.filterPass.uniforms.gloss.value=u[k];t=h;r=g.filterPass;var w=g.targetCubeRaw,E=g.targetFiltered,
C=g.pixelBuf,F=k,H=e,I,A=t.context;if(WALK.DEBUG_LIGHT_PROBE_MIPS){I=l;var K=C,X,Q;Q=255*F/WALK.mipsCount(WALK.LIGHT_PROBE_MIN_MIP_SIZE,WALK.LIGHT_PROBE_MAX_MIP_SIZE);for(X=0;X<4*I*I;X+=4)K[X]=Q,K[X+1]=Q,K[X+2]=Q,K[X+3]=31.875}for(I=0;6>I;I+=1)WALK.DEBUG_LIGHT_PROBE_MIPS||(r.uniforms.face.value=I,r.render(t,E,w),b(A,l,C)),t.copyBufferToCubeFaceMip(F,l,I,C,H)}c.setFilteredTexture(e);h.enableScissorTest(!1);g.autoClearAlter.restore();WALK.log("Cube generation time "+v.elapsedSec())}var n,t,v,x,w;w=
f.threeScene;n=new e(k,f);v=new WALK.Timer;x=new WALK.CubeCamera(.15,f.camera.far);this.assignLightProbesToObjects=function(){var a,b,c;v.reset();void 0===t&&(t=new WALK.ObjectDistanceQuery(k,f.gpuMeshes,f.camera.far));for(a=0;a<f.gpuMeshes.length;a+=1)f.gpuMeshes[a].lightProbe=null;for(a=0;a<f.lightProbes.length;a+=1)b=f.lightProbes[a],c=t.updateCubeMapAndFindVisibleObjects(b.position),WALK.log("Have visible objects "+c.length),g(b,c);WALK.log("Light probe assigment time "+v.elapsedSec());h(f.lightProbes,
WALK.filter(f.gpuMeshes,function(a){return null===a.lightProbe}))};this.createLightProbeTexture=function(a,b){c(w);l(a,b);d(w)};this.createAllLightProbeTextures=function(){var a;c(w);for(a=0;a<f.lightProbes.length;a+=1)l(f.lightProbes[a],!1);d(w)};this.dispose=function(){n.dispose();t&&t.dispose()}}})();(function(){WALK.DebugUI=function(a,b,c,d){function e(a,b){var c;for(c=0;c<a.gpuMeshes.length;c+=1)b(a.gpuMeshes[c])}function f(a,b,c){e(a,function(a){a.material===b&&c(a)})}function g(b,c){n.reflectivity=b.reflectivity;c.add(n,"reflectivity",0,1).step(.01).onFinishChange(function(c){f(a,b,function(a){a.userData.glossMaterial.setReflectivity(c)})})}function h(a,b){var c;n.bumpScale=a.bumpScale+.5;c=b.add(n,"bumpScale",0,1).step(1E-4);c.name("bumpScale +0.5");c.onFinishChange(function(b){a.bumpScale=
b-.5;a.setUniforms()})}function k(a,b){var c;n.mode=a.parallaxMode;n.scale=a.parallaxScale+.5;n.minLayers=a.parallaxMinLayers;n.maxLayers=a.parallaxMaxLayers;n.reliefSearches=a.parallaxReliefSearches;c=b.add(n,"mode",Object.keys(WALK.ParallaxModes));c.onFinishChange(function(b){a.parallaxMode=b;a.setUniforms()});c=b.add(n,"scale",0,1).step(.001);c.name("scale +0.5");c.onFinishChange(function(b){a.parallaxScale=b-.5;a.setUniforms()});c=b.add(n,"minLayers",0,200);c.onFinishChange(function(b){a.parallaxMinLayers=
b;a.setUniforms()});c=b.add(n,"maxLayers",0,200);c.onFinishChange(function(b){a.parallaxMaxLayers=b;a.setUniforms()})}function m(a,b){n.opacity=a.opacity;b.add(n,"opacity",0,1).step(.01).onFinishChange(function(b){a.opacity=b;a.transparent=1>b?!0:!1;a.setUniforms()})}function l(a,b){var c=b.addFolder(a.name);m(a,c);a.bumpMap&&(h(a,c),a.parallaxCorrection&&k(a,c));a.ssr&&g(a,c)}var n,p,q;n={showGeometries:!1};this.animate=function(){p.update()};(function(){var c,d,e;c=new dat.GUI;d=c.addFolder("controls");
n.mousePressLook=b.mousePressLook;n.moveModel=b.reverseLook;d.open();c.add(n,"showGeometries").name("show geometries").onChange(function(b){b?a.threeScene.add(q):a.threeScene.remove(q)});e=a.materials.slice(0).sort(function(a,b){return a.name.localeCompare(b.name)});for(d=0;d<e.length;d+=1)l(e[d],c)})();a.threeScene.autoUpdate=!0;p=new Stats;p.visible=!0;p.domElement.style.position="absolute";p.domElement.style.top="0px";document.body.appendChild(p.domElement);q=function(){var b,c,d=new THREE.Object3D;
for(b=0;b<a.gpuMeshes.length;b+=1)if(c=a.gpuMeshes[b],c instanceof THREE.Mesh){c=c.geometry;c.boundingBox||c.computeBoundingBox();c=c.boundingBox;var e=new WALK.WireframeMaterial(new THREE.Color(16777215*Math.random())),f;f=new THREE.BoxBufferGeometry(c.max.x-c.min.x,c.max.y-c.min.y,c.max.z-c.min.z);f.addTriangleOrderAttribute();e=new THREE.Mesh(f,e);c.center(e.position);c=e;d.add(c)}return d}()}})();(function(){WALK.Timer=function(){this.clock=performance||Date;this.reset()};WALK.Timer.prototype={constructor:WALK.Timer,reset:function(){this.startMS=this.clock.now()},elapsedMSec:function(){return this.clock.now()-this.startMS},elapsedSec:function(){return.001*this.elapsedMSec()}};WALK.Perf=function(){var a,b=[];a=new WALK.Timer;this.begin=function(){a.reset()};this.end=function(){b.push(a.elapsedSec());0===b.length%100&&(b.sort(),console.log("Best "+b[0]+" Median "+b[Math.floor(.5*b.length)]+
" 95 "+b[Math.floor(.95*b.length)]))}}})();(function(){WALK.AnimationController=function(a,b){function c(){g||(e||f.getDelta(),g=!0,d.vrManager.vrEnabled()?d.vrManager.vrDisplay.requestAnimationFrame(m):requestAnimationFrame(m))}var d=this,e=!1,f,g=!1,h=!1,k=0,m;f=new THREE.Clock;this.vrManager=null;m=function(){g=!1;h?b(k)?(k+=1,c()):h=!1:(e=!0,a(f.getDelta()),e=!1,g||(h=!0,k=0,c()))};this.requestFrame=function(){h=!1;c()}}})();(function(){function a(){var a;a={uniforms:{inputBuffer:{type:"t",value:null},weight:{type:"f",value:1}},vertexShader:WALK.getShader("accumulate_vertex.glsl"),fragmentShader:WALK.getShader("accumulate_fragment.glsl")};a=new THREE.ShaderPass(a,"inputBuffer");a.material.depthTest=!1;a.material.depthWrite=!1;a.material.transparent=!0;a.material.blending=THREE.CustomBlending;a.material.blendEquation=THREE.AddEquation;a.material.blendDst=THREE.OneMinusSrcAlphaFactor;a.material.blendSrc=THREE.SrcAlphaFactor;
return a}WALK.SsaaRenderer=function(b,c){var d,e,f,g,h,k,m,l=0;m=[[.375,.4375],[.625,.0625],[.875,.1875],[.125,.0625],[.375,.6875],[.875,.4375],[.625,.5625],[.375,.9375],[.625,.3125],[.125,.5625],[.125,.8125],[.375,.1875],[.875,.9375],[.875,.6875],[.125,.3125],[.625,.8125]];e=new THREE.RenderPass(c.threeScene,c.camera);g=a();h=new THREE.ShaderPass(THREE.CopyShader);h.renderToScreen=!0;k=new WALK.AutoClearAlter(b);this.reset=function(){l=0};this.renderSample=function(){console.assert(l<m.length);k.set(!0,
!0,!1);var a=f.width,h=f.height,q=m[l][0],u=m[l][1],r=c.camera,t,v,x,w;v=a/h;t=Math.tan(.5*THREE.Math.degToRad(r.fov));t=r.near*t/r.zoom;x=-t;w=x*v;v*=t;a=(v-w)/a;h=(t-x)/h;r.projectionMatrix.makeFrustum(w-q*a,v-q*a,x-u*h,t-u*h,r.near,r.far);e.render(b,d);k.restore();k.set(!1,!1,!1);g.uniforms.weight.value=1/(l+1);g.render(b,f,d);k.restore();c.camera.updateProjectionMatrix();l+=1};this.renderedSamplesCount=function(){return l};this.allSamplesRendered=function(){return l===m.length};this.renderAccumulatedSamplesToScreen=
function(){k.set(!0,!0,!1);h.render(b,void 0,f);k.restore()};this.copyAccumulatedSamplesToBuffer=function(){var a,c,d,e;a=b.context;d=f.width;e=f.height;c=new Uint8Array(d*e*4);a.readPixels(0,0,d,e,a.RGBA,a.UNSIGNED_BYTE,c);return c};this.setTargets=function(a,b){console.assert(a.width===b.width&&a.height===b.height);d=a;f=b};this.dispose=function(){g.material.dispose()}}})();WALK.WebGLShader=function(){var a=function(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+": "+a[b];return a.join("\n")};return function(b,c,d){c=b.createShader(c);b.shaderSource(c,d);b.compileShader(c);!1===b.getShaderParameter(c,b.COMPILE_STATUS)&&THREE.error("WALK.WebGLShader: Shader couldn't compile.");""!==b.getShaderInfoLog(c)&&THREE.warn("WALK.WebGLShader: gl.getShaderInfoLog()",b.getShaderInfoLog(c),a(d));return c}}();(function(){WALK.WebGLState=function(a,b){var c=new Uint8Array(16),d=new Uint8Array(16),e=null,f=null,g=null,h=null,k=null,m=null,l=null,n=null,p=null,q=null,u=null,r=null;this.initAttributes=function(){for(var a=0,b=c.length;a<b;a++)c[a]=0};this.enableAttribute=function(b){c[b]=1;0===d[b]&&(a.enableVertexAttribArray(b),d[b]=1)};this.disableUnusedAttributes=function(){for(var b=0,e=d.length;b<e;b++)d[b]!==c[b]&&(a.disableVertexAttribArray(b),d[b]=0)};this.setBlending=function(c,d,n,p,q,u,r){c!==e&&
(c===THREE.NoBlending?a.disable(a.BLEND):c===THREE.AdditiveBlending?(a.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE)):c===THREE.SubtractiveBlending?(a.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.ONE_MINUS_SRC_COLOR)):c===THREE.MultiplyBlending?(a.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.ZERO,a.SRC_COLOR)):c===THREE.CustomBlending?a.enable(a.BLEND):(a.enable(a.BLEND),a.blendEquationSeparate(a.FUNC_ADD,a.FUNC_ADD),a.blendFuncSeparate(a.SRC_ALPHA,
a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA)),e=c);if(c===THREE.CustomBlending){q=q||d;u=u||n;r=r||p;if(d!==f||q!==k)a.blendEquationSeparate(b(d),b(q)),f=d,k=q;if(n!==g||p!==h||u!==m||r!==l)a.blendFuncSeparate(b(n),b(p),b(u),b(r)),g=n,h=p,m=u,l=r}else l=m=k=h=g=f=null};this.setDepthTest=function(b){n!==b&&(b?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),n=b)};this.setDepthWrite=function(b){p!==b&&(a.depthMask(b),p=b)};this.setColorWrite=function(b){q!==b&&(a.colorMask(b,b,b,b),q=b)};this.setDoubleSided=
function(b){u!==b&&(b?a.disable(a.CULL_FACE):a.enable(a.CULL_FACE),u=b)};this.setFlipSided=function(b){r!==b&&(b?a.frontFace(a.CW):a.frontFace(a.CCW),r=b)};this.reset=function(){for(var a=0;a<d.length;a++)d[a]=0;r=u=q=p=n=e=null}}})();(function(){var a=0,b="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition".split(" ");WALK.WebGLProgram=function(c,d,e,f){c=c.context;var g=d.index0AttributeName,h=c.createProgram(),k=new WALK.WebGLShader(c,c.VERTEX_SHADER,e),m=new WALK.WebGLShader(c,c.FRAGMENT_SHADER,f);c.attachShader(h,k);c.attachShader(h,m);void 0!==g&&c.bindAttribLocation(h,0,g);c.linkProgram(h);g=c.getProgramInfoLog(h);!1===c.getProgramParameter(h,c.LINK_STATUS)&&THREE.error("WebGLProgram: shader error: "+
c.getError(),"gl.VALIDATE_STATUS",c.getProgramParameter(h,c.VALIDATE_STATUS),"gl.getPRogramInfoLog",g);""!==g&&"\x00"!==g&&THREE.warn("WebGLProgram: gl.getProgramInfoLog()"+g);c.deleteShader(k);c.deleteShader(m);var k={},l,g=0;for(l=b.length;g<l;g++)m=b[g],k[m]=c.getUniformLocation(h,m);this.transformUniformCache=k;var k=d.uniforms,n,p,g={i:[],f:[],v2:[],v3:[],c:[],v4:[],m4:[],t:[]};for(n in k)k.hasOwnProperty(n)&&(m=c.getUniformLocation(h,n))&&(l=k[n],l=l.type,console.assert(g.hasOwnProperty(l)),
"i"===l||"f"===l||"t"===l?p=null:"v2"===l?p=[null,null]:"v3"===l||"c"===l?p=[null,null,null]:"v4"===l?p=[null,null,null,null]:"m4"===l?p=null:console.assert(!1),g[l].push({id:n,value:p,location:m}));this.materialUniformCache=g;n=["position","sphericalNormal","uv","uv2"];for(var q in d.attributes)n.push(q);d={};p=0;for(k=n.length;p<k;p++)q=n[p],d[q]=c.getAttribLocation(h,q);this.attributes=d;this.attributesKeys=Object.keys(this.attributes);this.id=a++;this.usedTimes=1;this.program=h;this.vertexShader=
e;this.fragmentShader=f;return this}})();(function(){function a(){this.texture=null;this.locked=!1;this.usedCount=0}function b(b){var c=[],e;for(e=0;e<b;e+=1)c[e]=new a;return c}WALK.WebGLTextureSlotter=function(a){var c,e;c=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS);e=b(c);this.setSlot=function(a,b){var d=a.slot,f,g=Infinity,l;void 0===d&&(d=null);if(null!==d)return f=e[d],f.usedCount+=1,f.locked|=b,!1;for(l=0;l<c;l+=1)f=e[l],!f.locked&&f.usedCount<g&&(g=f.usedCount,d=l);null===d&&(console.warn("Not enough texture units"),d=0);f=e[d];f.texture&&
(f.texture.slot=null);f.texture=a;f.usedCount=1;f.locked=b;a.slot=d;return!0};this.unlockAllSlots=function(){var a;for(a=0;a<c;a+=1)e[a].locked=!1};this.freeSlot=function(a){var b;void 0!==a.slot&&null!==a.slot&&(b=e[a.slot],a.slot=null,b.texture=null,b.locked=!1,b.usedCount=0)}}})();(function(){WALK.WebGLRenderer=function(a,b,c){function d(a,c,d,e){d=d.attributes;var f=c.attributes;c=c.attributesKeys;for(var g=0,h=c.length;g<h;g++){var k=c[g],m=f[k];if(0<=m){var l=d[k];if(void 0!==l){var n=l.itemSize;b.bindBuffer(b.ARRAY_BUFFER,l.buffer);F.enableAttribute(m);"uv2"===k?b.vertexAttribPointer(m,n,b.UNSIGNED_SHORT,!0,0,e*n*2):"sphericalNormal"===k?b.vertexAttribPointer(m,n,b.BYTE,!1,0,e*n):b.vertexAttribPointer(m,n,b.FLOAT,!1,0,e*n*4)}else void 0!==a.defaultAttributeValues&&(2===
a.defaultAttributeValues[k].length?b.vertexAttrib2fv(m,a.defaultAttributeValues[k]):3===a.defaultAttributeValues[k].length&&b.vertexAttrib3fv(m,a.defaultAttributeValues[k]))}}F.disableUnusedAttributes()}function e(a,b){return a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.material.program&&b.material.program&&a.material.program.id!==b.material.program.id?a.material.program.id-b.material.program.id:a.material.id!==b.material.id?a.material.id-b.material.id:a.id-b.id}function f(a,b){return a.renderOrder!==
b.renderOrder?a.renderOrder-b.renderOrder:a.cameraDistance!==b.cameraDistance?b.cameraDistance-a.cameraDistance:a.id-b.id}function g(a){if(!1!==a.visible){a instanceof THREE.Mesh&&(!1===a.frustumCulled||!0===B.intersectsObject(a))&&(a.material.transparent?(!0===w.sortObjects&&(a.cameraDistance=B.nearPlaneDistanceTo(a)),x.push(a)):v.push(a));for(var b=0,c=a.children.length;b<c;b++)g(a.children[b])}}function h(a,e,f){for(var g,h=0,l=a.length;h<l;h+=1){var n=a[h],p=n.geometry;f?g=f:(g=n.material,console.assert(g),
k(g));var T=g;F.setDoubleSided(T.side===THREE.DoubleSide);F.setFlipSided(T.side===THREE.BackSide);console.assert(p instanceof THREE.BufferGeometry);if(!1!==g.visible){var q=e,r=g,T=n;if(r.programNeedsUpdate){r.program&&V(r);var t,v;r.addEventListener("dispose",Y);console.assert(r instanceof WALK.BaseMaterial);r.fragmentPrecision=c.fragmentPrecision;var x=void 0;t=r.generateFragmentShader();v=r.generateVertexShader();for(var R=0,U=E.length;R<U;R++){var A=E[R];if(A.vertexShader===v&&A.fragmentShader===
t){x=A;x.usedTimes++;break}}void 0===x&&(x=new WALK.WebGLProgram(w,r,v,t),E.push(x));r.program=x;r.programNeedsUpdate=!1}console.assert(!r.morphTargets);U=R=!1;t=r.program;v=t.transformUniformCache;x=r.uniforms;t.id!==C&&(b.useProgram(t.program),C=t.id,U=R=!0);r.id!==G&&(G=r.id,U=!0);if(R||q!==M)b.uniformMatrix4fv(v.projectionMatrix,!1,q.projectionMatrix.elements),q!==M&&(M=q),console.assert(r instanceof WALK.BaseMaterial),null!==v.cameraPosition&&(P.setFromMatrixPosition(q.matrixWorld),b.uniform3f(v.cameraPosition,
P.x,P.y,P.z)),null!==v.viewMatrix&&b.uniformMatrix4fv(v.viewMatrix,!1,q.matrixWorldInverse.elements);r.refreshPerObjectUniforms&&r.refreshPerObjectUniforms(T,x)&&(U=!0);if(U){for(var z,y,B,D,r=t.materialUniformCache.i,R=0,U=r.length;R<U;R+=1)A=r[R],z=A.id,y=x[z].value,A.value!==y&&(b.uniform1i(A.location,y),A.value=y);r=t.materialUniformCache.f;R=0;for(U=r.length;R<U;R+=1)A=r[R],z=A.id,y=x[z].value,A.value!==y&&(b.uniform1f(A.location,y),A.value=y);r=t.materialUniformCache.v2;R=0;for(U=r.length;R<
U;R+=1)if(A=r[R],z=A.id,y=x[z].value,z=y.x,B=y.y,A.value[0]!==z||A.value[1]!==B)b.uniform2f(A.location,z,B),A.value[0]=z,A.value[1]=B;r=t.materialUniformCache.v3;R=0;for(U=r.length;R<U;R+=1)if(A=r[R],z=A.id,y=x[z].value,z=y.x,B=y.y,D=y.z,A.value[0]!==z||A.value[1]!==B||A.value[2]!==D)b.uniform3f(A.location,z,B,D),A.value[0]=z,A.value[1]=B,A.value[2]=D;r=t.materialUniformCache.c;R=0;for(U=r.length;R<U;R+=1)if(A=r[R],z=A.id,y=x[z].value,z=y.r,B=y.g,D=y.b,A.value[0]!==z||A.value[1]!==B||A.value[2]!==
D)b.uniform3f(A.location,z,B,D),A.value[0]=z,A.value[1]=B,A.value[2]=D;r=t.materialUniformCache.v4;R=0;for(U=r.length;R<U;R+=1)if(A=r[R],z=A.id,y=x[z].value,z=y.x,B=y.y,D=y.z,y=y.w,A.value[0]!==z||A.value[1]!==B||A.value[2]!==D||A.value[3]!==y)b.uniform4f(A.location,z,B,D,y),A.value[0]=z,A.value[1]=B,A.value[2]=D,A.value[3]=y;r=t.materialUniformCache.m4;R=0;for(U=r.length;R<U;R+=1)A=r[R],z=A.id,b.uniformMatrix4fv(location,!1,x[z].value.elements);r=t.materialUniformCache.t;R=0;for(U=r.length;R<U;R+=
1)if(A=r[R],z=A.id,B=x[z].value,D=K.setSlot(B,!0),z=B.slot,A.vale!==z&&(b.uniform1i(A.location,z),A.vale=z),D||B.needsUpdate)if(B instanceof WALK.CubeTexture||B.image instanceof Array&&6===B.image.length){if(A=B,6===A.image.length)if(A.needsUpdate){A.image.__webglTextureCube||(A.addEventListener("dispose",S),A.image.__webglTextureCube=b.createTexture());b.activeTexture(b.TEXTURE0+z);b.bindTexture(b.TEXTURE_CUBE_MAP,A.image.__webglTextureCube);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,A.flipY);z=A instanceof
WALK.CompressedTexture;B=A.image[0]instanceof WALK.DataTexture;D=[];for(y=0;6>y;y++)D[y]=B?A.image[y].image:A.image[y];y=D[0];var H=THREE.Math.isPowerOfTwo(y.width)&&THREE.Math.isPowerOfTwo(y.height),I=u(A.format),Q=u(A.type);m(b.TEXTURE_CUBE_MAP,A,H);for(y=0;6>y;y++)if(z)for(var J,N=D[y].mipmaps,O=0,Z=N.length;O<Z;O++)J=N[O],A.format!==THREE.RGBAFormat&&A.format!==THREE.RGBFormat?b.compressedTexImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+y,O,I,J.width,J.height,0,J.data):b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+
y,O,I,J.width,J.height,0,I,Q,J.data),J.data=null;else B?(b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,I,D[y].width,D[y].height,0,I,Q,D[y].data),D[y].data=null):(b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+y,0,I,I,Q,D[y]),D[y]=null);A.generateMipmaps&&H&&b.generateMipmap(b.TEXTURE_CUBE_MAP);A.needsUpdate=!1;if(A.onUpdate)A.onUpdate()}else b.activeTexture(b.TEXTURE0+z),b.bindTexture(b.TEXTURE_CUBE_MAP,A.image.__webglTextureCube)}else B instanceof THREE.WebGLRenderTargetCube?(A=B,b.activeTexture(b.TEXTURE0+
z),b.bindTexture(b.TEXTURE_CUBE_MAP,A.__webglTexture)):w.setTexture(B,z);K.unlockAllSlots()}T.matrixWorld?(W.multiplyMatrices(q.matrixWorldInverse,T.matrixWorld),q=W):q=q.matrixWorldInverse;b.uniformMatrix4fv(v.modelViewMatrix,!1,q.elements);v.normalMatrix&&(aa.getNormalMatrix(q),b.uniformMatrix3fv(v.normalMatrix,!1,aa.elements));null!==v.modelMatrix&&(T.matrixWorld?b.uniformMatrix4fv(v.modelMatrix,!1,T.matrixWorld.elements):b.uniformMatrix4fv(v.modelMatrix,!1,X));T=t;q=!1;if(p.id!==L||T.id!==C)L=
p.id,q=!0;q&&F.initAttributes();console.assert(n instanceof THREE.Mesh);n=b.TRIANGLES;(t=p.attributes.index)?(p.indexUint?(v=b.UNSIGNED_INT,x=4):(v=b.UNSIGNED_SHORT,x=2),q&&(d(g,T,p,0),b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,t.buffer)),void 0!==p.indexOffset?b.drawElements(n,p.indexCnt,v,x*(p.indexOffset||0)):b.drawElements(n,t.array.length,v,0)):(q&&d(g,T,p,0),g=p.attributes.position,void 0!==p.vertexOffset?b.drawArrays(n,p.vertexOffset,p.vertexCnt):b.drawArrays(n,0,g.array.length/g.itemSize))}}}function k(a){!0===
a.transparent?F.setBlending(a.blending,a.blendEquation,a.blendSrc,a.blendDst,a.blendEquationAlpha,a.blendSrcAlpha,a.blendDstAlpha):F.setBlending(THREE.NoBlending);F.setDepthTest(a.depthTest);F.setDepthWrite(a.depthWrite);F.setColorWrite(a.colorWrite)}function m(a,d,e){e?(b.texParameteri(a,b.TEXTURE_WRAP_S,u(d.wrapS)),b.texParameteri(a,b.TEXTURE_WRAP_T,u(d.wrapT)),b.texParameteri(a,b.TEXTURE_MAG_FILTER,u(d.magFilter)),b.texParameteri(a,b.TEXTURE_MIN_FILTER,u(d.minFilter))):(b.texParameteri(a,b.TEXTURE_WRAP_S,
b.CLAMP_TO_EDGE),b.texParameteri(a,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),d.wrapS===THREE.ClampToEdgeWrapping&&d.wrapT===THREE.ClampToEdgeWrapping||THREE.warn("WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),b.texParameteri(a,b.TEXTURE_MAG_FILTER,q(d.magFilter)),b.texParameteri(a,b.TEXTURE_MIN_FILTER,q(d.minFilter)),d.minFilter!==THREE.NearestFilter&&d.minFilter!==THREE.LinearFilter&&THREE.warn("WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));
(e=c.extension("EXT_texture_filter_anisotropic"))&&d.type!==THREE.FloatType&&d.type!==THREE.HalfFloatType&&(1<d.anisotropy||d.__currentAnisotropy)&&(b.texParameterf(a,e.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(d.anisotropy,c.maxAnisotropy)),d.__currentAnisotropy=d.anisotropy)}function l(a){void 0===a.__webglInit&&(a.__webglInit=!0,a.addEventListener("dispose",S),a.__webglTexture=b.createTexture());b.activeTexture(b.TEXTURE0+a.slot);b.bindTexture(b.TEXTURE_2D,a.__webglTexture);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,
a.flipY);b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);b.pixelStorei(b.UNPACK_ALIGNMENT,a.unpackAlignment);var c=a.image,d=THREE.Math.isPowerOfTwo(c.width)&&THREE.Math.isPowerOfTwo(c.height),e=u(a.format),f=u(a.type);m(b.TEXTURE_2D,a,d);var g=a.mipmaps;if(a instanceof WALK.DataTexture)if(0<g.length&&d){for(var h=0,k=g.length;h<k;h++)c=g[h],b.texImage2D(b.TEXTURE_2D,h,e,c.width,c.height,0,e,f,c.data),c.data=null;a.generateMipmaps=!1}else b.texImage2D(b.TEXTURE_2D,0,e,c.width,c.height,
0,e,f,c.data),c.data=null;else if(a instanceof WALK.CompressedTexture)for(h=0,k=g.length;h<k;h++)c=g[h],a.format!==THREE.RGBAFormat&&a.format!==THREE.RGBFormat?b.compressedTexImage2D(b.TEXTURE_2D,h,e,c.width,c.height,0,c.data):b.texImage2D(b.TEXTURE_2D,h,e,c.width,c.height,0,e,f,c.data),c.data=null;else if(0<g.length&&d){h=0;for(k=g.length;h<k;h++)c=g[h],b.texImage2D(b.TEXTURE_2D,h,e,e,f,c);a.mipmaps=null;a.generateMipmaps=!1}else b.texImage2D(b.TEXTURE_2D,0,e,e,f,a.image),a.image=null;a.generateMipmaps&&
d&&b.generateMipmap(b.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()}function n(a,c){b.bindRenderbuffer(b.RENDERBUFFER,a);c.depthBuffer&&!c.stencilBuffer?(b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,c.width,c.height),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,a)):c.depthBuffer&&c.stencilBuffer?(b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_STENCIL,c.width,c.height),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,
a)):b.renderbufferStorage(b.RENDERBUFFER,b.RGBA4,c.width,c.height)}function p(a){var c=K.setSlot(a,!1);b.activeTexture(b.TEXTURE0+a.slot);a instanceof THREE.WebGLRenderTargetCube?(c&&b.bindTexture(b.TEXTURE_CUBE_MAP,a.__webglTexture),b.generateMipmap(b.TEXTURE_CUBE_MAP)):(c&&b.bindTexture(b.TEXTURE_2D,a.__webglTexture),b.generateMipmap(b.TEXTURE_2D))}function q(a){return a===THREE.NearestFilter||a===THREE.NearestMipMapNearestFilter||a===THREE.NearestMipMapLinearFilter?b.NEAREST:b.LINEAR}function u(a){var d;
if(a===THREE.RepeatWrapping)return b.REPEAT;if(a===THREE.ClampToEdgeWrapping)return b.CLAMP_TO_EDGE;if(a===THREE.MirroredRepeatWrapping)return b.MIRRORED_REPEAT;if(a===THREE.NearestFilter)return b.NEAREST;if(a===THREE.NearestMipMapNearestFilter)return b.NEAREST_MIPMAP_NEAREST;if(a===THREE.NearestMipMapLinearFilter)return b.NEAREST_MIPMAP_LINEAR;if(a===THREE.LinearFilter)return b.LINEAR;if(a===THREE.LinearMipMapNearestFilter)return b.LINEAR_MIPMAP_NEAREST;if(a===THREE.LinearMipMapLinearFilter)return b.LINEAR_MIPMAP_LINEAR;
if(a===THREE.UnsignedByteType)return b.UNSIGNED_BYTE;if(a===THREE.UnsignedShort4444Type)return b.UNSIGNED_SHORT_4_4_4_4;if(a===THREE.UnsignedShort5551Type)return b.UNSIGNED_SHORT_5_5_5_1;if(a===THREE.UnsignedShort565Type)return b.UNSIGNED_SHORT_5_6_5;if(a===THREE.ByteType)return b.BYTE;if(a===THREE.ShortType)return b.SHORT;if(a===THREE.UnsignedShortType)return b.UNSIGNED_SHORT;if(a===THREE.IntType)return b.INT;if(a===THREE.UnsignedIntType)return b.UNSIGNED_INT;if(a===THREE.FloatType)return b.FLOAT;
d=c.extension("OES_texture_half_float");if(null!==d&&a===THREE.HalfFloatType)return d.HALF_FLOAT_OES;if(a===THREE.AlphaFormat)return b.ALPHA;if(a===THREE.RGBFormat)return b.RGB;if(a===THREE.RGBAFormat)return b.RGBA;if(a===THREE.LuminanceFormat)return b.LUMINANCE;if(a===THREE.LuminanceAlphaFormat)return b.LUMINANCE_ALPHA;if(a===THREE.AddEquation)return b.FUNC_ADD;if(a===THREE.SubtractEquation)return b.FUNC_SUBTRACT;if(a===THREE.ReverseSubtractEquation)return b.FUNC_REVERSE_SUBTRACT;if(a===THREE.ZeroFactor)return b.ZERO;
if(a===THREE.OneFactor)return b.ONE;if(a===THREE.SrcColorFactor)return b.SRC_COLOR;if(a===THREE.OneMinusSrcColorFactor)return b.ONE_MINUS_SRC_COLOR;if(a===THREE.SrcAlphaFactor)return b.SRC_ALPHA;if(a===THREE.OneMinusSrcAlphaFactor)return b.ONE_MINUS_SRC_ALPHA;if(a===THREE.DstAlphaFactor)return b.DST_ALPHA;if(a===THREE.OneMinusDstAlphaFactor)return b.ONE_MINUS_DST_ALPHA;if(a===THREE.DstColorFactor)return b.DST_COLOR;if(a===THREE.OneMinusDstColorFactor)return b.ONE_MINUS_DST_COLOR;if(a===THREE.SrcAlphaSaturateFactor)return b.SRC_ALPHA_SATURATE;
d=c.extension("WEBGL_compressed_texture_s3tc");if(null!==d){if(a===THREE.RGB_S3TC_DXT1_Format)return d.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT1_Format)return d.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===THREE.RGBA_S3TC_DXT3_Format)return d.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===THREE.RGBA_S3TC_DXT5_Format)return d.COMPRESSED_RGBA_S3TC_DXT5_EXT}d=c.extension("WEBGL_compressed_texture_pvrtc");if(null!==d){if(a===THREE.RGB_PVRTC_4BPPV1_Format)return d.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===THREE.RGB_PVRTC_2BPPV1_Format)return d.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;
if(a===THREE.RGBA_PVRTC_4BPPV1_Format)return d.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===THREE.RGBA_PVRTC_2BPPV1_Format)return d.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}d=c.extension("WEBGL_compressed_texture_etc1");return null!==d&&a===THREE.RGB_ETC1_Format?d.COMPRESSED_RGB_ETC1_WEBGL:0}var r=new THREE.Color(0),t=0,v=[],x=[];this.domElement=a;this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;var w=this,E=[],C=null,y=null,G=-1,L=null,M=null,N=0,D=0,J=a.width,
z=a.height,B=new WALK.Frustum,O=new THREE.Matrix4,P=new THREE.Vector3;a.addEventListener("webglcontextlost",function(a){a.preventDefault();A();I()},!1);var F=new WALK.WebGLState(b,u),H=function(a,c,d,e){b.clearColor(a*e,c*e,d*e,e)},I=function(){b.clearColor(0,0,0,1);b.clearDepth(1);b.clearStencil(0);b.enable(b.DEPTH_TEST);b.depthFunc(b.LEQUAL);b.frontFace(b.CCW);b.cullFace(b.BACK);b.enable(b.CULL_FACE);b.enable(b.BLEND);b.blendEquation(b.FUNC_ADD);b.blendFunc(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA);b.viewport(N,
D,J,z);H(r.r,r.g,r.b,t)},A=function(){L=M=C=null;G=-1;F.reset()};I();this.context=b;this.detector=c;this.state=F;var K=new WALK.WebGLTextureSlotter(b);b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS);var X=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);this.forceContextLoss=function(){c.extension("WEBGL_lose_context").loseContext()};this.setSize=function(b,c,d){a.width=b;a.height=c;!1!==d&&(a.style.width=b+"px",a.style.height=c+"px");this.setViewport(0,0,b,c)};this.setViewport=function(a,c,d,
e){N=a;D=c;J=d;z=e;b.viewport(N,D,J,z)};this.setScissor=function(a,c,d,e){b.scissor(a,c,d,e)};this.enableScissorTest=function(a){a?b.enable(b.SCISSOR_TEST):b.disable(b.SCISSOR_TEST)};this.getClearColor=function(){return r};this.setClearColor=function(a,b){r.set(a);t=void 0!==b?b:1;H(r.r,r.g,r.b,t)};this.getClearAlpha=function(){return t};this.setClearAlpha=function(a){t=a;H(r.r,r.g,r.b,t)};this.clear=function(a,c,d){var e=0;if(void 0===a||a)e|=b.COLOR_BUFFER_BIT;if(void 0===c||c)e|=b.DEPTH_BUFFER_BIT;
if(void 0===d||d)e|=b.STENCIL_BUFFER_BIT;b.clear(e)};this.clearColor=function(){b.clear(b.COLOR_BUFFER_BIT)};this.clearDepth=function(){b.clear(b.DEPTH_BUFFER_BIT)};this.clearStencil=function(){b.clear(b.STENCIL_BUFFER_BIT)};this.clearTarget=function(a,b,c,d){this.setRenderTarget(a);this.clear(b,c,d)};this.resetGLState=A;var Q=function(a){a=a.target;a.removeEventListener("dispose",Q);delete a.__webglInit;if(a instanceof THREE.BufferGeometry)for(var c in a.attributes){var d=a.attributes[c];void 0!==
d.buffer&&(b.deleteBuffer(d.buffer),delete d.buffer)}else console.assert(!1);L=null},S=function(a){a=a.target;a.removeEventListener("dispose",S);K.freeSlot(a);a.image&&a.image.__webglTextureCube?(b.deleteTexture(a.image.__webglTextureCube),delete a.image.__webglTextureCube):void 0!==a.__webglInit&&(b.deleteTexture(a.__webglTexture),delete a.__webglTexture,delete a.__webglInit)},Z=function(a){a=a.target;a.removeEventListener("dispose",Z);if(a&&void 0!==a.__webglTexture){K.freeSlot(a);b.deleteTexture(a.__webglTexture);
delete a.__webglTexture;if(a instanceof THREE.WebGLRenderTargetCube)for(var c=0;6>c;c++)b.deleteFramebuffer(a.__webglFramebuffer[c]),b.deleteRenderbuffer(a.__webglRenderbuffer[c]);else b.deleteFramebuffer(a.__webglFramebuffer),b.deleteRenderbuffer(a.__webglRenderbuffer);delete a.__webglFramebuffer;delete a.__webglRenderbuffer}},Y=function(a){a=a.target;a.removeEventListener("dispose",Y);V(a)},V=function(a){var c=a.program.program;if(void 0!==c){a.program=void 0;var d,e,f=!1;a=0;for(d=E.length;a<d;a++)if(e=
E[a],e.program===c){e.usedTimes--;0===e.usedTimes&&(f=!0);break}if(!0===f){f=[];a=0;for(d=E.length;a<d;a++)e=E[a],e.program!==c&&f.push(e);E=f;b.deleteProgram(c)}}};this.render=function(a,b,c,d){L=null;G=-1;M=null;!0===a.autoUpdate&&a.updateMatrixWorld();void 0===b.parent&&b.updateMatrixWorld();b.matrixWorldInverse.getInverse(b.matrixWorld);O.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);B.setFromMatrix(O);v.length=0;x.length=0;g(a);!0===w.sortObjects&&(v.sort(e),x.sort(f));this.setRenderTarget(c);
(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);a.overrideMaterial?(a=a.overrideMaterial,k(a),h(v,b,a),h(x,b,a)):(F.setBlending(THREE.NoBlending),h(v,b,null),h(x,b,null));c&&c.generateMipmaps&&c.minFilter!==THREE.NearestFilter&&c.minFilter!==THREE.LinearFilter&&p(c);F.setDepthTest(!0);F.setDepthWrite(!0);F.setColorWrite(!0)};this.renderMeshesWithMaterial=function(a,b,c,d,m){var l;L=null;G=-1;M=null;void 0===c.parent&&c.updateMatrixWorld();c.matrixWorldInverse.getInverse(c.matrixWorld);
O.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);B.setFromMatrix(O);v.length=0;for(l=x.length=0;l<a.length;l+=1)g(a[l]);!0===w.sortObjects&&(v.sort(e),x.sort(f));this.setRenderTarget(d);(this.autoClear||m)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);k(b);h(v,c,b);h(x,c,b);d&&d.generateMipmaps&&d.minFilter!==THREE.NearestFilter&&d.minFilter!==THREE.LinearFilter&&p(d);F.setDepthTest(!0);F.setDepthWrite(!0);F.setColorWrite(!0)};var W=new THREE.Matrix4,aa=new THREE.Matrix3;
this.uploadNewBuffers=function(a){a=a.geometry;var c=a.attributes,d=a.attributesKeys,e=!1,f,g,h,k;void 0===a.__webglInit&&(a.__webglInit=!0,a.addEventListener("dispose",Q));console.assert(a instanceof THREE.BufferGeometry);f=0;for(g=d.length;f<g;f+=1)h=d[f],k=c[h],h="index"===h?b.ELEMENT_ARRAY_BUFFER:b.ARRAY_BUFFER,void 0===k.buffer?(k.buffer=b.createBuffer(),b.bindBuffer(h,k.buffer),b.bufferData(h,k.array,b.STATIC_DRAW),e=!0,k.needsUpdate=!1):!0===k.needsUpdate&&console.assert(!1);if(e&&a.onLoadedToGpu)a.onLoadedToGpu()};
this.uploadTexture=function(a){K.setSlot(a,!1);l(a)};this.setTexture=function(a,c){a.needsUpdate?l(a):(b.activeTexture(b.TEXTURE0+c),b.bindTexture(b.TEXTURE_2D,a.__webglTexture))};this.copyBufferToCubeFaceMip=function(a,c,d,e,f){K.setSlot(f,!1);b.activeTexture(b.TEXTURE0+f.slot);b.bindTexture(b.TEXTURE_CUBE_MAP,f.image.__webglTextureCube);b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+d,a,b.RGBA,c,c,0,b.RGBA,b.UNSIGNED_BYTE,e)};this.createCubeTextureWithMips=function(a){var c,d;c=new WALK.CubeTexture;
c.minFilter=THREE.LinearMipMapNearestFilter;c.generateMipmaps=!1;c.needsUpdate=!1;c.addEventListener("dispose",S);c.image=Array(6);c.image.__webglTextureCube=b.createTexture();K.setSlot(c,!1);b.activeTexture(b.TEXTURE0+c.slot);b.bindTexture(b.TEXTURE_CUBE_MAP,c.image.__webglTextureCube);b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,!1);b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);b.texParameteri(b.TEXTURE_CUBE_MAP,
b.TEXTURE_MAG_FILTER,b.LINEAR);b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MIN_FILTER,b.LINEAR_MIPMAP_NEAREST);for(d=0;6>d;d+=1)b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+d,0,b.RGBA,a,a,0,b.RGBA,b.UNSIGNED_BYTE,null);b.generateMipmap(b.TEXTURE_CUBE_MAP);return c};this.setRenderTarget=function(a){var c=a instanceof THREE.WebGLRenderTargetCube;if(a&&void 0===a.__webglFramebuffer){void 0===a.depthBuffer&&(a.depthBuffer=!0);void 0===a.stencilBuffer&&(a.stencilBuffer=!0);a.addEventListener("dispose",
Z);console.assert(!a.__webglTexture);a.__webglTexture=b.createTexture();var d=THREE.Math.isPowerOfTwo(a.width)&&THREE.Math.isPowerOfTwo(a.height),e=u(a.format),f=u(a.type);K.setSlot(a,!1);b.activeTexture(b.TEXTURE0+a.slot);if(c){a.__webglFramebuffer=[];a.__webglRenderbuffer=[];b.bindTexture(b.TEXTURE_CUBE_MAP,a.__webglTexture);m(b.TEXTURE_CUBE_MAP,a,d);for(var g=0;6>g;g++){a.__webglFramebuffer[g]=b.createFramebuffer();a.__webglRenderbuffer[g]=b.createRenderbuffer();b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+
g,0,e,a.width,a.height,0,e,f,null);var h=a,k=b.TEXTURE_CUBE_MAP_POSITIVE_X+g;b.bindFramebuffer(b.FRAMEBUFFER,a.__webglFramebuffer[g]);b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,k,h.__webglTexture,0);n(a.__webglRenderbuffer[g],a)}d&&a.generateMipmaps&&b.generateMipmap(b.TEXTURE_CUBE_MAP)}else a.__webglFramebuffer=b.createFramebuffer(),a.__webglRenderbuffer=a.shareDepthFrom?a.shareDepthFrom.__webglRenderbuffer:b.createRenderbuffer(),b.bindTexture(b.TEXTURE_2D,a.__webglTexture),m(b.TEXTURE_2D,
a,d),b.texImage2D(b.TEXTURE_2D,0,e,a.width,a.height,0,e,f,null),e=b.TEXTURE_2D,b.bindFramebuffer(b.FRAMEBUFFER,a.__webglFramebuffer),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,e,a.__webglTexture,0),a.shareDepthFrom?a.depthBuffer&&!a.stencilBuffer?b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,a.__webglRenderbuffer):a.depthBuffer&&a.stencilBuffer&&b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,a.__webglRenderbuffer):n(a.__webglRenderbuffer,
a),d&&a.generateMipmaps&&b.generateMipmap(b.TEXTURE_2D);b.bindRenderbuffer(b.RENDERBUFFER,null);b.bindFramebuffer(b.FRAMEBUFFER,null)}a?(c=c?a.__webglFramebuffer[a.activeCubeFace]:a.__webglFramebuffer,d=a.width,a=a.height,f=e=0):(c=null,d=J,a=z,e=N,f=D);c!==y&&(b.bindFramebuffer(b.FRAMEBUFFER,c),b.viewport(e,f,d,a),y=c)};this.readRenderTargetPixels=function(a,c,d,e,f,g){if(!(a instanceof THREE.WebGLRenderTarget))console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");
else if(a.__webglFramebuffer)if(a.format!==THREE.RGBAFormat)console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA format. readPixels can read only RGBA format.");else{var h=!1;a.__webglFramebuffer!==y&&(b.bindFramebuffer(b.FRAMEBUFFER,a.__webglFramebuffer),h=!0);b.checkFramebufferStatus(b.FRAMEBUFFER)===b.FRAMEBUFFER_COMPLETE?b.readPixels(c,d,e,f,b.RGBA,b.UNSIGNED_BYTE,g):console.error("WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.");
h&&b.bindFramebuffer(b.FRAMEBUFFER,y)}}}})();(function(){var a={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,stencilBuffer:!1};WALK.createRenderer=function(a,c){var b,e;void 0===c.alpha&&(c.alpha=!1);void 0===c.depth&&(c.depth=!0);void 0===c.stencil&&(c.stencil=!1);void 0===c.premultipliedAlpha&&(c.premultipliedAlpha=!0);void 0===c.antialias&&(c.antialias=!0);void 0===c.preserveDrawingBuffer&&(c.preserveDrawingBuffer=!1);try{b=a.getContext("webgl",c)||a.getContext("experimental-webgl",c)}catch(f){b=null}if(!b)return null;
e=new WALK.Detector(b);return new WALK.WebGLRenderer(a,b,e)};WALK.createWebwalkRenderer=function(a){if(a=WALK.createRenderer(a,{antialias:!WALK.FORCE_FXAA}))a.autoClear=!0,a.autoClearColor=!1,a.autoClearDepth=!0,a.autoClearStencil=!1,a.autoUpdateObjects=!1,a.sortObjects=!0;return a};WALK.Renderer=function(b,c,d){var e=null,f,g,h,k,m,l;m=d.camera;l=d.threeScene;k=function(){var a=new WALK.Frustum,c=new THREE.Matrix4;return function(e){var f,g;e.matrixWorldInverse.getInverse(e.matrixWorld);c.multiplyMatrices(e.projectionMatrix,
e.matrixWorldInverse);a.setFromMatrix(c);for(f=0;f<d.mirrors.length;f+=1)g=d.mirrors[f],g.updateCameraPosition(e,a),g.inFrustum()&&g.render(b)}}();this.resize=function(c){var k,l,n,r;c?(k=n=f.renderTargetWidth(),l=r=f.renderTargetHeight()):(k=window.innerWidth,l=window.innerHeight,n=k*window.devicePixelRatio,r=l*window.devicePixelRatio,m.aspect=n/r,m.updateProjectionMatrix());b.setSize(n,r,!1);c||(b.domElement.style.width=k+"px",b.domElement.style.height=l+"px",g&&(g.configureTarget(n,r,a),h.setTargets(g.renderTarget1,
g.renderTarget2)),e&&e.uniforms.resolution.value.set(1/n,1/r));k=r;c?(n/=2,l=70):l=m.fov;r=n/k;for(c=0;c<d.mirrors.length;c+=1)d.mirrors[c].configure(n,k,r,l)};this.rawRenderer=function(){return b};this.vrRenderer=function(){return f};this.renderIdle=function(a){if(!h)return!1;0===a&&h.reset();console.assert(h.renderedSamplesCount()===a);h.renderSample();4<=h.renderedSamplesCount()&&h.renderAccumulatedSamplesToScreen();return!h.allSamplesRendered()};this.renderToScreen=function(a,c){c?f.render(l,
m):(d.mirrors.length&&k(m),e?g.render(a):b.render(l,m))};(function(){var a;c.antialiasPostprocess&&(g=new THREE.EffectComposer(b),c.antialiasNative||(WALK.log("using FXAA"),b.autoClear=!1,e=new THREE.ShaderPass(THREE.FXAAShader),e.clear=!1,e.renderToScreen=!0,e.material.depthTest=!1,e.material.depthWrite=!1,e.uniforms.resolution.value.set(1/window.innerWidth,1/window.innerHeight),a=new THREE.RenderPass(l,m),g.addPass(a),g.addPass(e)),h=new WALK.SsaaRenderer(b,d));f=new WALK.VREffect(b,d.camera.far);
f.preLeftRender=k;f.preRightRender=k})()}})();(function(){function a(a,b){var c,d;d=document.getElementsByClassName(a);for(c=0;c<d.length;c+=1)b(d[c])}function b(b){var c,d=[];a(b,function(a){d.push(a)});for(c=0;c<d.length;c+=1)d[c].classList.remove(b)}function c(a,b){a.style.display=b?"":"none"}function d(a,b){c($(a),b)}function e(b,d){a(b,function(a){c(a,d)})}function f(a){c(a,!0);a.style.opacity=0;WALK.defer(function(){a.style.opacity=1})}function g(a){var b,d;a.style.opacity=0;(b=window.getComputedStyle(a).transitionDuration)?(d=parseFloat(b),
-1===b.indexOf("ms")&&(d*=1E3),setTimeout(function(){c(a,!1)},d)):c(a,!1)}WALK.Menu=function(h,k,m,l){function n(a){return function(b){b.stopPropagation();a();h.ios||$("walk-canvas").focus()}}function p(a,b){a.addEventListener("click",n(b))}function q(){var a,b;b=$("view-list").children;for(a=0;a<b.length;a+=1)b[a].classList.remove("tour-active-view")}function u(){$("tour-button").classList.add("tour-on")}function r(){$("tour-button").classList.remove("tour-on");q()}function t(){D.isRunning()?D.stop():
D.start()}function v(a){D.isRunning()&&(a=$("view-list").children,D.viewIdx<a.length&&(a[D.viewIdx].classList.add("tour-active-view"),setTimeout(q,WALK.AUTO_TOUR_IN_VIEW_STILL_TIME_MS)))}function x(a){return n(function(){var b=!1;D.isRunning()&&(b=!0,D.stop());N.switchToView(a,b)})}function w(){var a=P&&!(O&&h.mobile),b=null!==M;d("info-bar",a);d("menu-bar",a);d("view-list",a);if(a){if(null!==L.cover){var e=L.cover.title,f=L.cover.author,g=L.cover.authorLogoUrl,k=L.cover.authorHref,l=L.cover.engineLogoOn,
a=L.cover.engineLogoText,m,n=null===M||null!==I;m=$("author-logo");c(m,g);g&&(k&&(m.href=k),m.firstElementChild.src=g);d("info-text",n&&(e||f));n&&(WALK.setTextContent($("info-title"),e),WALK.setTextContent($("info-author"),f),k&&($("info-author").href=k));e=e?e:"Architectural visualization";f&&(e+=" by "+f);document.title=e;d("engine-logo",l);l&&a&&(f=$("engine-logo-text"),c(f,!0),WALK.setTextContent(f,a))}d("menu-buttons",b&&!B);b=null===M?[]:M.visibleViews();a=$("view-list");c(a,0<b.length&&!B);
if(0<b.length){for(l=a.children[0];1!==a.children.length;)a.removeChild(a.children[a.children.length-1]);for(f=0;f<b.length;f+=1)e=b[f],e.hideFromMenu||(WALK.setTextContent(l,e.name),l.onclick=x(e),a.appendChild(l),l=l.cloneNode(!0))}M&&M.canStartAutoTour()&&!O?d("tour-button",!0):(D&&D.isRunning()&&D.stop(),d("tour-button",!1))}b=F&&!(O&&h.mobile)&&!B;h.mobile?d("mobile-help",b):(d("desktop-help",b),F&&(b=$("desktop-help-switch"),a=$("desktop-help-content"),f=H?1:0,b.children[f].classList.add("selected"),
c(a.children[f],!0),b.children[1-f].classList.remove("selected"),c(a.children[1-f],!1)))}function E(){F=!F;w()}function C(){H=!1;w()}function y(){H=!0;w()}function G(a){var b=a.keyCode-48;switch(a.keyCode){case 27:D.isRunning()&&D.stop();break;case 70:z&&l();break;case 72:E();break;case 77:P=!P;w();break;case 86:J&&m()}if(1<=b&&9>=b){var b=b-1,c=null===M?[]:M.visibleViews(),b=c.length>b?c[b]:null;null!==b&&x(b)(a)}}var L=this,M=null,N=null,D,J=!1,z=!1,B=!1,O=!1,P=!0,F=!1,H=!1,I=null;this.cover=null;
this.defaultCover={author:null,title:null,authorHref:null,engineLogoOn:!0,engineLogoText:null};this.updateCover=function(a){this.cover=a;null!==I&&clearTimeout(I);I=setTimeout(function(){I=null;w()},5E3);w()};this.refresh=function(){w()};this.onFullScreenChange=function(a){};this.onPointerLockChange=function(a){B=a;w()};this.onVrChange=function(a){O=a;w()};this.enablePlayButton=function(a){var b=$("play-button");b.addEventListener("click",a);c(b,!0)};this.setVrSupported=function(){J=!0;e("vr-specific",
!0)};this.setFullScreenSupported=function(){(z=!k)&&e("fullscreen-specific",!0)};this.sceneLoadStarted=function(){d("play-button",!1);d("primary-progress",!0)};this.loadProgress=function(a){var b;a=a.totalDone()/a.total;null===M&&(b=Math.max(314.159*(1-a),0),$("primary-progress-done").style.strokeDashoffset=b);a=Math.floor(100*a);$("secondary-progress-done").style.width=a+"%"};this.sceneReadyToDisplay=function(a,b,c){M=a;N=b;N.addEventListener("teleportDone",v);D=c;D.addEventListener("tourStarted",
u);D.addEventListener("tourStopped",r);g($("cover-image"));g($("primary-progress"));f($("secondary-progress"));M.addEventListener("viewAdded",w);M.addEventListener("viewRemoved",w);M.addEventListener("viewShifted",w);document.addEventListener("keydown",G,!1);p($("help-button"),E);p($("fullscreen-button"),l);p($("vr-button"),m);p($("tour-button"),t);p($("basic-desktop-help-option"),C);p($("advanced-desktop-help-option"),y);p($("close-desktop-help-button"),E);p($("close-mobile-help-button"),E);document.body.style.backgroundImage=
"none";document.body.style.backgroundColor="#000";w()};this.sceneLoadComplete=function(){d("secondary-progress",!1)};(function(){k&&(e("viewer-specific",!1),e("editor-specific",!0));a("ui-panel",function(a){p(a,function(){})});h.mobile&&b("ui-hoverable");w()})()}})();(function(){WALK.InteractionDispatcher=function(a,b,c,d,e){function f(a){console.assert(m);l.pointerDown(a)}function g(a){console.assert(m);l.pointerMove(a);0!==e.length&&c.requestFrame()}function h(a){if(l.pointerUp(a)&&(a=l.clipX,p=b.findIntersectionAtPosition(a,l.clipY)))for(a=0;a<d.length&&!d[a](p.object,p.point,p.distance);a+=1);}function k(a,b){var c;for(c=0;c<e.length&&!e[c](a,b);c+=1);}var m=!1,l,n=null,p=null;l=new WALK.PointerEventHelper;console.assert(0!==e.length||0!==d.length);this.handleHover=
function(){var a;m&&0!==e.length&&(a=b.findObstacleMeshAtPosition(l.clipX,l.clipY),null===a?n&&(k(n,!1),n=null):a!==n&&(n&&k(n,!1),k(a,!0),n=a))};this.enable=function(){m=!0;a.addEventListener("mousemove",g,!1);a.addEventListener("touchmove",g,!1);0!==d.length&&(a.addEventListener("touchstart",f,!1),a.addEventListener("mousedown",f,!1),a.addEventListener("mouseup",h,!1),a.addEventListener("touchend",h,!1));console.assert(null===n)};this.disable=function(){m=!1;null!==n&&(k(n,!1),n=null);a.removeEventListener("mousemove",
g,!1);a.removeEventListener("touchmove",g,!1);0!==d.length&&(a.removeEventListener("mousedown",f,!1),a.removeEventListener("touchstart",f,!1),a.removeEventListener("mouseup",h,!1),a.removeEventListener("touchend",h,!1))};this.enable()}})();(function(){function a(a){return D.renderIdle(a)}function b(a){var b=J.vrEnabled();A.update(a);B&&!b&&z.handleCollisions(a);F&&F.handleHover();I.update(a);O&&O.updateCameraHeight(a);P&&P.handleTriggers();b&&!A.teleportingToPoint&&(J.update(),K&&K.update(a),V.requestFrame());D.renderToScreen(a,b);b&&J.vrDisplay.submitFrame();Q&&Q.update(a);aa&&aa.animate()}function c(a){a.view&&(O&&O.disable(),P&&P.disable(),F&&F.disable())}function d(a){a.view&&(O&&O.enable(),P&&P.enable(),F&&F.enable());J.vrEnabled()&&
(J.resetPose(),I.resetPitchAngle())}function e(){D.resize(J.vrEnabled());V.requestFrame()}function f(){return document.pointerLockElement===H||document.mozPointerLockElement===H||document.webkitPointerLockElement===H}function g(){return document.fullscreenElement||document.mozFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}function h(){g()&&(document.exitFullScreen=document.exitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen||
document.webkitExitFullscreen,document.exitFullScreen&&document.exitFullScreen())}function k(){f()?(I.mousePressLook=!1,W.onPointerLockChange(!0)):(I.mousePressLook=!0,W.onPointerLockChange(!1),h());aa&&dat.GUI.toggleHide()}function m(){if(g())W.onFullScreenChange(!0),T.mobile||T.opera||void 0===document.pointerLockElement&&void 0===document.mozPointerLockElement&&void 0===document.webkitPointerLockElement||f()||(WALK.log("requesting pointer lock"),H.requestPointerLock=H.requestPointerLock||H.mozRequestPointerLock||
H.webkitRequestPointerLock,H.requestPointerLock(),document.addEventListener("pointerlockchange",k,!1),document.addEventListener("mozpointerlockchange",k,!1),document.addEventListener("webkitpointerlockchange",k,!1));else W.onFullScreenChange(!1)}function l(a){N.uploadNewBuffers(a);V&&V.requestFrame()}function n(a){N.uploadTexture(a);V&&V.requestFrame()}function p(){if(g())f()&&(document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock&&
document.exitPointerLock()),h();else{var a;a=document.body;(a.mozRequestFullScreen||a.webkitRequestFullscreen||a.msRequestFullscreen||a.requestFullscreen).call(a);document.addEventListener("fullscreenchange",m,!1);document.addEventListener("mozfullscreenchange",m,!1);document.addEventListener("webkitfullscreenchange",m,!1);document.addEventListener("MSFullscreenChange",m,!1)}}function q(a){(a.display||a.detail.display).isPresenting?(I.mouseControlsPitch=!1,I.resetPitchAngle(),A.instant=!0,W.onVrChange(!0),
F.disable(),e()):(I.resetRollAngle(),I.resetPitchAngle(),I.mouseControlsPitch=!0,console.assert(!J.vrEnabled()),A.instant=!1,W.onVrChange(!1),F.enable(),e(),setTimeout(e,1E3))}function u(){S.editMode||T.ios&&T.inCrossOriginIframe&&!WALK.urlHashContains("devicemotionproxy")||W.setVrSupported()}function r(){J.vrEnabled()?J.disableVr():(X.isRunning()&&X.stop(),J.enableVr(H))}function t(a,b){var c;a&&I.cameraWorldPosition().set(a[0],a[1],a[2]);b&&(c=new WALK.Euler,c.setFromDegTriple(b),I.setYawAngle(c.yaw),
I.setPitchAngle(c.pitch))}function v(a){var b;for(b=0;b<a.length;b+=1)if(!a[b].lightProbe)return!1;return!0}function x(a,b,c){var d=[];b.visitAllNodes(function(a){a.mesh&&d.push(a.mesh)});z=new WALK.Collider(a,b,c);z.addObstacles(d);d=null}function w(){var a=THREE.Scene.prototype.add;THREE.Object3D.prototype.add=function(b){b instanceof THREE.Mesh&&N.uploadNewBuffers(b);a.call(this,b)}}function E(f){f.setSkyRadiusAndCameraFarToSpanWholeScene();f.headLight=WALK.HEAD_LIGHT;V=new WALK.AnimationController(b,
a);f.disableLightProbesForMaterials();I=new WALK.Controls(f.camera,H,V);I.autoRotate=!1;I.mousePressLook=!0;T.mobile&&(I.reverseLook=!0);f.threeScene.updateMatrixWorld(!0);D=new WALK.Renderer(N,T,f);J=new WALK.VRManager(I,D.vrRenderer(),u);V.vrManager=J;window.addEventListener("vrdisplaypresentchange",q,!1);A=new WALK.Teleport(f,I,V);A.addEventListener("teleportStarted",c);A.addEventListener("teleportDone",d);X=new WALK.AutoTour(f,A);((B=S.enableCollisions)||S.editMode)&&x(N,f,I);B&&!WALK.urlHashContains("nogazeteleport")&&
(K=new WALK.GazeTeleport(f,A,I,z));B&&f.camera.autoClimb&&(O=new WALK.StepsClimber(z,I,V));B&&0<f.triggers.length&&(P=new WALK.TriggersHandler(f,z,A));if(B){var g=S,h,k;h=g._meshClickListeners.slice(0);k=g._meshHoverListeners;g.editMode||(g=new WALK.ClickNavigator(z,I,A),h.push(g.onMeshClicked));if(0<h.length||0<k.length)F=new WALK.InteractionDispatcher(H,z,V,h,k)}A.switchToView(f.views[0],!0);window.addEventListener("resize",e,!1);h=document.body;h=void 0!==document.fullscreenEnabled||void 0!==document.webkitFullscreenEnabled||
void 0!==document.mozFullScreenEnabled||void 0!==document.msFullscreenEnabled?!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled):void 0!==h.mozRequestFullScreen||void 0!==h.webkitRequestFullscreen||void 0!==h.msRequestFullscreen||void 0!==h.requestFullscreen;h&&W.setFullScreenSupported();W.sceneReadyToDisplay(f,A,X);e();T.debugEnabled&&WALK.DebugUI&&(aa=new WALK.DebugUI(f,I,e,V));T.ios||H.focus();T.debugSharedBuffers&&(f.threeScene.overrideMaterial=
new WALK.DebugMaterial);f.startAutoTourOnLoad()&&X.start();V.requestFrame();U=Y.elapsedLoadTimeSec()}function C(a){S.editMode||WALK.urlHashContains("nostats")||window.location.hostname.match(/\.shapespark\.com$/)&&WALK.ajaxPost("./stats/"+a,null,null)}function y(a,b){C("loaded?readyToDisplayTime="+a.toFixed(1)+"&loadTime="+b.toFixed(1))}function G(a){function b(a){g.assignLightProbesToObjects();g.createLightProbeTexture(a.lightProbe,!1)}function c(a){a=a.lightProbe;var b,c;b=a.boxMin;c=a.boxMax;g.createLightProbeTexture(a,
!0);a.hasBoundingBox()||(b.copy(a.position).addScalar(-1),c.copy(a.position).addScalar(1),a.boxMin=b,a.boxMax=c)}function d(b){for(b=0;b<a.materials.length;b+=1)a.materials[b].forceObjectUniformsRefresh()}function e(a){a=a.lightProbe;g.assignLightProbesToObjects();g.createLightProbeTexture(a,!0);a.addEventListener("lightProbeBoundsInit",c);a.addEventListener("lightProbePositionUpdated",b);a.addEventListener("lightProbeBoundsUpdated",d)}function f(){g.assignLightProbesToObjects()}var g,h,k;if(T.cubeMaps&&
(0<a.lightProbes.length||S.editMode)&&(g=new WALK.LightProbeMaker(a,N,T.mirrorCubeMaps,S.editMode),0<a.lightProbes.length)){v(a.gpuMeshes)||(console.warn("Some objects do not have light probes assigned, this is not optimal."),g.assignLightProbesToObjects());for(h=0;h<a.views.length&&"orbit"===a.views[h].mode;h+=1);h===a.views.length&&(h=0);A.updateHiddenMeshes(a.views[h]);g.createAllLightProbeTextures();A.updateHiddenMeshes(A.lastDestinationView);a.enableLightProbesForMaterials()}if(S.editMode){g||
console.warn("Cube maps support is required in the edit mode");a.addEventListener("lightProbeAdded",e);a.addEventListener("lightProbeRemoved",f);for(h=0;h<a.lightProbes.length;h+=1)a.lightProbes[h].addEventListener("lightProbePositionUpdated",b),a.lightProbes[h].addEventListener("lightProbeBoundsInit",c),a.lightProbes[h].addEventListener("lightProbeBoundsUpdated",d);h=new WALK.LightControls(a,V);k=new WALK.LightProbeControls(a,V);Q=new WALK.EditorSelector(a,D.rawRenderer(),z,h,k,V);h=new WALK.ScreenshotTaker(D.rawRenderer(),
a);h.screenToServer();window.parent&&!window.parent.SPARK_IS_ELECTRON&&h.registerKeyHandler();h=null;t(S.forcedInitialCameraPosition,S.forcedInitialCameraRotation)}else g&&(g.dispose(),g=null);0<a.lights.length&&T.dynamicLights&&WALK.DYNAMIC_LIGHTS&&(h=new WALK.LightAssigner(N,a.camera.far,a.lights,a.materials,a.logicalMeshes),h.assignLightLookupMaps(),h.dispose(),h=null);if(S.onSceneLoaded)S.onSceneLoaded(new WALK.EditorHooks(T,a,W,I,A,Q,V));W.sceneLoadComplete();V.requestFrame();y(U,Y.elapsedLoadTimeSec())}
function L(){if(T.mobile)try{WALK.urlHashContains("vrlo")?WebVRConfig.BUFFER_SCALE*=.5:WALK.urlHashContains("vrhi")&&(WebVRConfig.BUFFER_SCALE*=1.5),InitializeWebVRPolyfill()}catch(R){WALK.log("Failed to initialize WebVR")}Z&&(Z=!1,Y.load(),W.sceneLoadStarted(),C("play"))}function M(a){w();S=a;(N=WALK.createWebwalkRenderer(H))?(T=N.detector,T.reportToConsole(),T.missingCapabilities?WALK.USER_MSG.error(T.missingCapabilities):(W=new WALK.Menu(T,S.editMode,r,p),WALK.ajaxGet("./cover.json",!1,W.updateCover.bind(W),
W.updateCover.bind(W,W.defaultCover)),Z=!0,Y=new WALK.SceneLoader(S.assetsUrl,T,S.editMode),Y.onProgress=W.loadProgress,Y.onTextureLoaded=n,Y.onMeshBuffersLoaded=l,Y.onReadyToDisplay=E,Y.onComplete=G,WALK.urlHashContains("autoplay")?L():WALK.urlHashContains("hideplay")||W.enablePlayButton(L))):WALK.USER_MSG.error(window.WebGLRenderingContext?'Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" target="_blank">WebGL</a> or your browser has WebGL disabled.<br/><a href="http://get.webgl.org/" target="_blank">Find out how to get it.</a>':
'Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" target="_blank">WebGL</a>.<br/><a href="http://get.webgl.org/" target="_blank">Find out how to get it.</a>')}var N,D,J,z,B,O,P,F,H=$("walk-canvas"),I,A,K,X,Q,S,Z=!1,Y=null,V,W,aa=null,T,U;WALK.initEditMode=function(a){M(a)};WALK.init=function(a){WALK.urlHashContains("editor")||M(a)};WALK.play=function(){L()}})();
